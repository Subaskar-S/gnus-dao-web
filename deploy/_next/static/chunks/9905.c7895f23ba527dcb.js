(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9905],{54003:function(e,t,r){"use strict";r.d(t,{Jx:function(){return P},cv:function(){return p}});let i=new TextEncoder;function n(e,t,r){let i=t,n=i+r,s=[],o="";for(;i<n;){let t=e[i++];if((128&t)==0)s.push(t);else if((224&t)==192){let r=63&e[i++];s.push((31&t)<<6|r)}else if((240&t)==224){let r=63&e[i++],n=63&e[i++];s.push((31&t)<<12|r<<6|n)}else if((248&t)==240){let r=(7&t)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}let s=new TextDecoder;class o{constructor(e,t){this.type=e,this.data=t}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Object.create(a.prototype)),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:a.name})}}function c(e,t,r){e.setUint32(t,Math.floor(r/4294967296)),e.setUint32(t+4,r)}function l(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}let u={type:-1,encode:function(e){return e instanceof Date?function({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=17179869183){if(0===t&&e<=4294967295){let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{let r=e/4294967296,i=new Uint8Array(8),n=new DataView(i.buffer);return n.setUint32(0,t<<2|3&r),n.setUint32(4,4294967295&e),i}}{let r=new Uint8Array(12),i=new DataView(r.buffer);return i.setUint32(0,t),c(i,4,e),r}}(function(e){let t=e.getTime(),r=Math.floor(t/1e3),i=(t-1e3*r)*1e6,n=Math.floor(i/1e9);return{sec:r+n,nsec:i-1e9*n}}(e)):null},decode:function(e){let t=function(e){let t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{let e=t.getUint32(0);return{sec:(3&e)*4294967296+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:l(t,4),nsec:t.getUint32(0)};default:throw new a(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}};class h{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(u)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{let i=-1-e;this.builtInEncoders[i]=t,this.builtInDecoders[i]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){let i=this.builtInEncoders[r];if(null!=i){let n=i(e,t);if(null!=n)return new o(-1-r,n)}}for(let r=0;r<this.encoders.length;r++){let i=this.encoders[r];if(null!=i){let n=i(e,t);if(null!=n)return new o(r,n)}}return e instanceof o?e:null}decode(e,t,r){let i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,r):new o(t,e)}}function f(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}h.defaultCodec=new h;class d{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??h.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new d({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){let t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){let t=new ArrayBuffer(e),r=new Uint8Array(t),i=new DataView(t);r.set(this.bytes),this.view=i,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){var t,r,n;let s=function(e){let t=e.length,r=0,i=0;for(;i<t;){let n=e.charCodeAt(i++);if((4294967168&n)==0){r++;continue}if((4294965248&n)==0)r+=2;else{if(n>=55296&&n<=56319&&i<t){let t=e.charCodeAt(i);(64512&t)==56320&&(++i,n=((1023&n)<<10)+(1023&t)+65536)}(4294901760&n)==0?r+=3:r+=4}}return r}(e);this.ensureBufferSizeToWrite(5+s),this.writeStringHeader(s),t=e,r=this.bytes,n=this.pos,t.length>50?i.encodeInto(t,r.subarray(n)):function(e,t,r){let i=e.length,n=r,s=0;for(;s<i;){let r=e.charCodeAt(s++);if((4294967168&r)==0){t[n++]=r;continue}if((4294965248&r)==0)t[n++]=r>>6&31|192;else{if(r>=55296&&r<=56319&&s<i){let t=e.charCodeAt(s);(64512&t)==56320&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}(4294901760&r)==0?t[n++]=r>>12&15|224:(t[n++]=r>>18&7|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128}t[n++]=63&r|128}}(t,r,n),this.pos+=s}encodeObject(e,t){let r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if("object"==typeof e)this.encodeMap(e,t);else throw Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){let t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<4294967296)this.writeU8(198),this.writeU32(t);else throw Error(`Too large binary: ${t}`);let r=f(e);this.writeU8a(r)}encodeArray(e,t){let r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw Error(`Too large array: ${r}`);for(let r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(let i of t)void 0!==e[i]&&r++;return r}encodeMap(e,t){let r=Object.keys(e);this.sortKeys&&r.sort();let i=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<4294967296)this.writeU8(223),this.writeU32(i);else throw Error(`Too large map object: ${i}`);for(let i of r){let r=e[i];this.ignoreUndefined&&void 0===r||(this.encodeString(i),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){let t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw Error(`Too large extension object: ${r}`);this.writeU8(201),this.writeU32(r),this.writeI8(e.type),this.writeU8a(t);return}let t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<4294967296)this.writeU8(201),this.writeU32(t);else throw Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){let t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){var t,r;this.ensureBufferSizeToWrite(8),t=this.view,r=this.pos,t.setUint32(r,e/4294967296),t.setUint32(r+4,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),c(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function p(e,t){return new d(t).encodeSharedRef(e)}function g(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}class y{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){let i=this.caches[r-1];e:for(let n of i){let i=n.bytes;for(let n=0;n<r;n++)if(i[n]!==e[t+n])continue e;return n.str}return null}store(e,t){let r=this.caches[e.length-1],i={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,t,r){let i=this.find(e,t,r);if(null!=i)return this.hit++,i;this.miss++;let s=n(e,t,r),o=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(o,s),s}}let b="array",m="map_key",w="map_value",v=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new a("The type of key must be string or number but "+typeof e)};class E{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){let t=this.getUninitializedStateFromPool();t.type=b,t.position=0,t.size=e,t.array=Array(e)}pushMapState(e){let t=this.getUninitializedStateFromPool();t.type=m,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){return this.stackHeadPosition++,this.stackHeadPosition===this.stack.length&&this.stack.push({type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null}),this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw Error("Invalid stack state. Released state is not on top of the stack.");e.type===b&&(e.size=0,e.array=void 0,e.position=0,e.type=void 0),(e.type===m||e.type===w)&&(e.size=0,e.map=void 0,e.readCount=0,e.type=void 0),this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}let x=new DataView(new ArrayBuffer(0)),I=new Uint8Array(x.buffer);try{x.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}let S=RangeError("Insufficient data"),O=new y;class _{constructor(e){this.totalPos=0,this.pos=0,this.view=x,this.bytes=I,this.headByte=-1,this.stack=new E,this.entered=!1,this.extensionCodec=e?.extensionCodec??h.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??4294967295,this.maxBinLength=e?.maxBinLength??4294967295,this.maxArrayLength=e?.maxArrayLength??4294967295,this.maxMapLength=e?.maxMapLength??4294967295,this.maxExtLength=e?.maxExtLength??4294967295,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:O,this.mapKeyConverter=e?.mapKeyConverter??v}clone(){return new _({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){let t=f(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){let t=this.bytes.subarray(this.pos),r=f(e),i=new Uint8Array(t.length+r.length);i.set(t),i.set(r,t.length),this.setBuffer(i)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){let{view:t,pos:r}=this;return RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);let t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){let t=this.clone();yield*t.decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{let t;this.entered=!0;let r=!1;for await(let i of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(i);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}let{headByte:i,pos:n,totalPos:s}=this;throw RangeError(`Insufficient data in parsing ${g(i)} at ${s} (${n} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async *decodeMultiAsync(e,t){if(this.entered){let r=this.clone();yield*r.decodeMultiAsync(e,t);return}try{this.entered=!0;let r=t,i=-1;for await(let n of e){if(t&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(n),r&&(i=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!=--i;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){t:for(;;){let e;let t=this.readHeadByte();if(t>=224)e=t-256;else if(t<192){if(t<128)e=t;else if(t<144){let r=t-128;if(0!==r){this.pushMapState(r),this.complete();continue}e={}}else if(t<160){let r=t-144;if(0!==r){this.pushArrayState(r),this.complete();continue}e=[]}else{let r=t-160;e=this.decodeString(r,0)}}else if(192===t)e=null;else if(194===t)e=!1;else if(195===t)e=!0;else if(202===t)e=this.readF32();else if(203===t)e=this.readF64();else if(204===t)e=this.readU8();else if(205===t)e=this.readU16();else if(206===t)e=this.readU32();else if(207===t)e=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===t)e=this.readI8();else if(209===t)e=this.readI16();else if(210===t)e=this.readI32();else if(211===t)e=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===t){let t=this.lookU8();e=this.decodeString(t,1)}else if(218===t){let t=this.lookU16();e=this.decodeString(t,2)}else if(219===t){let t=this.lookU32();e=this.decodeString(t,4)}else if(220===t){let t=this.readU16();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(221===t){let t=this.readU32();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(222===t){let t=this.readU16();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(223===t){let t=this.readU32();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(196===t){let t=this.lookU8();e=this.decodeBinary(t,1)}else if(197===t){let t=this.lookU16();e=this.decodeBinary(t,2)}else if(198===t){let t=this.lookU32();e=this.decodeBinary(t,4)}else if(212===t)e=this.decodeExtension(1,0);else if(213===t)e=this.decodeExtension(2,0);else if(214===t)e=this.decodeExtension(4,0);else if(215===t)e=this.decodeExtension(8,0);else if(216===t)e=this.decodeExtension(16,0);else if(199===t){let t=this.lookU8();e=this.decodeExtension(t,1)}else if(200===t){let t=this.lookU16();e=this.decodeExtension(t,2)}else if(201===t){let t=this.lookU32();e=this.decodeExtension(t,4)}else throw new a(`Unrecognized type byte: ${g(t)}`);this.complete();let r=this.stack;for(;r.length>0;){let t=r.top();if(t.type===b){if(t.array[t.position]=e,t.position++,t.position===t.size)e=t.array,r.release(t);else continue t}else if(t.type===m){if("__proto__"===e)throw new a("The key __proto__ is not allowed");t.key=this.mapKeyConverter(e),t.type=w;continue t}else if(t.map[t.key]=e,t.readCount++,t.readCount===t.size)e=t.map,r.release(t);else{t.key=null,t.type=m;continue t}}return e}}readHeadByte(){return -1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){let e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new a(`Unrecognized array type byte: ${g(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new a(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new a(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){let r;if(e>this.maxStrLength)throw new a(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw S;let i=this.pos+t;if(this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e))r=this.keyDecoder.decode(this.bytes,i,e);else{var o;o=this.bytes,r=e>200?function(e,t,r){let i=e.subarray(t,t+r);return s.decode(i)}(o,i,e):n(o,i,e)}return this.pos+=t+e,r}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===m}decodeBinary(e,t){if(e>this.maxBinLength)throw new a(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw S;let r=this.pos+t,i=this.bytes.subarray(r,r+e);return this.pos+=t+e,i}decodeExtension(e,t){if(e>this.maxExtLength)throw new a(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);let r=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){let e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){let e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){let e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){let e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){var e,t;let r=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r}readI64(){let e=l(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){let e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){let e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){let e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){let e=this.view.getFloat64(this.pos);return this.pos+=8,e}}function P(e,t){return new _(t).decode(e)}},68568:function(e,t,r){"use strict";var i=r(88835);i.gk,i.k8,i.ci,i.Md,i.eV,i.nr,i._t,i.O6,i.iY},86363:function(e,t,r){"use strict";r.d(t,{VR:function(){return o},bc:function(){return n},iY:function(){return l},l3:function(){return s},pw:function(){return u},r$:function(){return a},u$:function(){return c}});var i=r(88835);function n(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}class o extends i.kb{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=(0,i.GL)(this.buffer)}update(e){(0,i.$h)(this),e=(0,i.O0)(e),(0,i.gk)(e);let{view:t,buffer:r,blockLen:n}=this,s=e.length;for(let o=0;o<s;){let a=Math.min(n-this.pos,s-o);if(a===n){let t=(0,i.GL)(e);for(;n<=s-o;o+=n)this.process(t,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,i.$h)(this),(0,i.eB)(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:n,isLE:s}=this,{pos:o}=this;t[o++]=128,(0,i.ru)(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let e=o;e<n;e++)t[e]=0;!function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)}(r,n-8,BigInt(8*this.length),s),this.process(r,0);let a=(0,i.GL)(e),c=this.outputLen;if(c%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,u=this.get();if(l>u.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)a.setUint32(4*e,u[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=n,e.length=i,e.pos=o,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}let a=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),l=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),u=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])},45860:function(e,t,r){"use strict";r.d(t,{$p:function(){return h},EP:function(){return f},FL:function(){return u},Fn:function(){return m},IH:function(){return y},Iq:function(){return a},NI:function(){return o},Ou:function(){return l},SD:function(){return p},Vl:function(){return s},Xb:function(){return w},ac:function(){return b},gm:function(){return d},m_:function(){return c},mk:function(){return g},pp:function(){return x},u8:function(){return v},zP:function(){return E}});let i=BigInt(4294967296-1),n=BigInt(32);function s(e,t=!1){let r=e.length,s=new Uint32Array(r),o=new Uint32Array(r);for(let a=0;a<r;a++){let{h:r,l:c}=function(e,t=!1){return t?{h:Number(e&i),l:Number(e>>n&i)}:{h:0|Number(e>>n&i),l:0|Number(e&i)}}(e[a],t);[s[a],o[a]]=[r,c]}return[s,o]}let o=(e,t,r)=>e>>>r,a=(e,t,r)=>e<<32-r|t>>>r,c=(e,t,r)=>e>>>r|t<<32-r,l=(e,t,r)=>e<<32-r|t>>>r,u=(e,t,r)=>e<<64-r|t>>>r-32,h=(e,t,r)=>e>>>r-32|t<<64-r,f=(e,t,r)=>e<<r|t>>>32-r,d=(e,t,r)=>t<<r|e>>>32-r,p=(e,t,r)=>t<<r-32|e>>>64-r,g=(e,t,r)=>e<<r-32|t>>>64-r;function y(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/4294967296|0)|0,l:0|n}}let b=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),m=(e,t,r,i)=>t+r+i+(e/4294967296|0)|0,w=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),v=(e,t,r,i,n)=>t+r+i+n+(e/4294967296|0)|0,E=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),x=(e,t,r,i,n,s)=>t+r+i+n+s+(e/4294967296|0)|0},35979:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var i=r(88835);class n extends i.kb{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,i.z3)(e);let r=(0,i.O0)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,s=new Uint8Array(n);s.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,i.ru)(s)}update(e){return(0,i.$h)(this),this.iHash.update(e),this}digestInto(e){(0,i.$h)(this),(0,i.gk)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:s,outputLen:o}=this;return e.finished=i,e.destroyed=n,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let s=(e,t,r)=>new n(e,t).update(r).digest();s.create=(e,t)=>new n(e,t)},17373:function(e,t,r){"use strict";var i=r(86363);r(88835),i.VR,i.VR;let n=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),s=Uint8Array.from(Array(16).fill(0).map((e,t)=>t)),o=s.map(e=>(9*e+5)%16),a=(()=>{let e=[[s],[o]];for(let t=0;t<4;t++)for(let r of e)r.push(r[t].map(e=>n[e]));return e})(),c=(a[0],a[1],[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)));i.VR},95423:function(e,t,r){"use strict";r.d(t,{JQ:function(){return u}});var i=r(86363),n=r(45860),s=r(88835);let o=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),a=new Uint32Array(64);class c extends i.VR{constructor(e=32){super(64,e,8,!1),this.A=0|i.r$[0],this.B=0|i.r$[1],this.C=0|i.r$[2],this.D=0|i.r$[3],this.E=0|i.r$[4],this.F=0|i.r$[5],this.G=0|i.r$[6],this.H=0|i.r$[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:s,G:o,H:a}=this;return[e,t,r,i,n,s,o,a]}set(e,t,r,i,n,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)a[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=a[e-15],r=a[e-2],i=(0,s.np)(t,7)^(0,s.np)(t,18)^t>>>3,n=(0,s.np)(r,17)^(0,s.np)(r,19)^r>>>10;a[e]=n+a[e-7]+i+a[e-16]|0}let{A:r,B:n,C:c,D:l,E:u,F:h,G:f,H:d}=this;for(let e=0;e<64;e++){let t=d+((0,s.np)(u,6)^(0,s.np)(u,11)^(0,s.np)(u,25))+(0,i.bc)(u,h,f)+o[e]+a[e]|0,p=((0,s.np)(r,2)^(0,s.np)(r,13)^(0,s.np)(r,22))+(0,i.l3)(r,n,c)|0;d=f,f=h,h=u,u=l+t|0,l=c,c=n,n=r,r=t+p|0}r=r+this.A|0,n=n+this.B|0,c=c+this.C|0,l=l+this.D|0,u=u+this.E|0,h=h+this.F|0,f=f+this.G|0,d=d+this.H|0,this.set(r,n,c,l,u,h,f,d)}roundClean(){(0,s.ru)(a)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,s.ru)(this.buffer)}}let l=n.Vl(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e)));l[0],l[1],i.VR;let u=(0,s.V1)(()=>new c)},12426:function(e,t,r){"use strict";r.d(t,{JQ:function(){return i}});let i=r(95423).JQ},76087:function(e,t,r){"use strict";r.d(t,{fr:function(){return v}});var i=r(45860),n=r(88835);let s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(7),l=BigInt(256),u=BigInt(113),h=[],f=[],d=[];for(let e=0,t=o,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],h.push(2*(5*i+r)),f.push((e+1)*(e+2)/2%64);let n=s;for(let e=0;e<7;e++)(t=(t<<o^(t>>c)*u)%l)&a&&(n^=o<<(o<<BigInt(e))-o);d.push(n)}let p=(0,i.Vl)(d,!0),g=p[0],y=p[1],b=(e,t,r)=>r>32?(0,i.SD)(e,t,r):(0,i.EP)(e,t,r),m=(e,t,r)=>r>32?(0,i.mk)(e,t,r):(0,i.gm)(e,t,r);class w extends n.kb{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,(0,n.k8)(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,n.Jq)(this.state)}clone(){return this._cloneInto()}keccak(){(0,n.Ux)(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,s=r[n],o=r[n+1],a=b(s,o,1)^r[i],c=m(s,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=f[r],s=b(t,n,i),o=m(t,n,i),a=h[r];t=e[a],n=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=g[i],e[1]^=y[i]}(0,n.ru)(r)}(this.state32,this.rounds),(0,n.Ux)(this.state32),this.posOut=0,this.pos=0}update(e){(0,n.$h)(this),e=(0,n.O0)(e),(0,n.gk)(e);let{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(t-this.pos,i-n);for(let t=0;t<s;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,n.$h)(this,!1),(0,n.gk)(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let s=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,n.k8)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,n.eB)(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,n.ru)(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:s}=this;return e||(e=new w(t,r,i,s,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}let v=(0,n.V1)(()=>new w(136,1,32))},88835:function(e,t,r){"use strict";r.d(t,{kb:function(){return _},gk:function(){return o},$h:function(){return c},z3:function(){return a},k8:function(){return s},eB:function(){return l},ci:function(){return m},Md:function(){return I},ru:function(){return h},eV:function(){return O},V1:function(){return P},GL:function(){return f},nr:function(){return E},_t:function(){return n},O6:function(){return A},XG:function(){return p},np:function(){return d},Ux:function(){return g},O0:function(){return S},Jq:function(){return u},iY:function(){return x}});let i="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function n(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function o(e,...t){if(!n(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)}function c(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function l(e,t){o(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function u(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function h(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function f(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function d(e,t){return e<<32-t|e>>>t}function p(e,t){return e<<t|e>>>32-t>>>0}let g=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?e=>e:function(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}return e},y="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,b=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function m(e){if(o(e),y)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=b[e[r]];return t}let w={_0:48,_9:57,A:65,F:70,a:97,f:102};function v(e){return e>=w._0&&e<=w._9?e-w._0:e>=w.A&&e<=w.F?e-(w.A-10):e>=w.a&&e<=w.f?e-(w.a-10):void 0}function E(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(y)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=v(e.charCodeAt(n)),s=v(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i}function x(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function I(e){return new TextDecoder().decode(e)}function S(e){return"string"==typeof e&&(e=x(e)),o(e),e}function O(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];o(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}class _{}function P(e){let t=t=>e().update(S(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function A(e=32){if(i&&"function"==typeof i.getRandomValues)return i.getRandomValues(new Uint8Array(e));if(i&&"function"==typeof i.randomBytes)return Uint8Array.from(i.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}},46905:function(e,t,r){"use strict";function i(e,t){return!!Array.isArray(t)&&(0===t.length||(e?t.every(e=>"string"==typeof e):t.every(e=>Number.isSafeInteger(e))))}function n(e,t){if("string"!=typeof t)throw Error(`${e}: string expected`);return!0}function s(e){if(!Number.isSafeInteger(e))throw Error(`invalid integer: ${e}`)}function o(e){if(!Array.isArray(e))throw Error("array expected")}function a(e,t){if(!i(!0,t))throw Error(`${e}: array of strings expected`)}function c(...e){let t=e=>e,r=(e,t)=>r=>e(t(r));return{encode:e.map(e=>e.encode).reduceRight(r,t),decode:e.map(e=>e.decode).reduce(r,t)}}function l(e){let t="string"==typeof e?e.split(""):e,r=t.length;a("alphabet",t);let i=new Map(t.map((e,t)=>[e,t]));return{encode:i=>(o(i),i.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=r)throw Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:t=>(o(t),t.map(t=>{n("alphabet.decode",t);let r=i.get(t);if(void 0===r)throw Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}function u(e=""){return n("join",e),{encode:t=>(a("join.decode",t),t.join(e)),decode:t=>(n("join.decode",t),t.split(e))}}r.d(t,{pJ:function(){return g}});let h=(e,t)=>0===t?e:h(t,e%t),f=(e,t)=>e+(t-h(e,t)),d=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function p(e,t,r,i){if(o(e),t<=0||t>32)throw Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw Error(`convertRadix2: wrong to=${r}`);if(f(t,r)>32)throw Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${f(t,r)}`);let n=0,a=0,c=d[t],l=d[r]-1,u=[];for(let i of e){if(s(i),i>=c)throw Error(`convertRadix2: invalid data word=${i} from=${t}`);if(n=n<<t|i,a+t>32)throw Error(`convertRadix2: carry overflow pos=${a} from=${t}`);for(a+=t;a>=r;a-=r)u.push((n>>a-r&l)>>>0);let e=d[a];if(void 0===e)throw Error("invalid carry");n&=e-1}if(n=n<<r-a&l,!i&&a>=t)throw Error("Excess padding");if(!i&&n>0)throw Error(`Non-zero padding: ${n}`);return i&&a>0&&u.push(n>>>0),u}let g=c(function(e,t=!1){if(s(5),e>32)throw Error("radix2: bits should be in (0..32]");if(f(8,e)>32||f(e,8)>32)throw Error("radix2: carry overflow");return{encode:r=>{var i;if(!((i=r)instanceof Uint8Array||ArrayBuffer.isView(i)&&"Uint8Array"===i.constructor.name))throw Error("radix2.encode input should be Uint8Array");return p(Array.from(r),8,e,!t)},decode:r=>((function(e,t){if(!i(!1,t))throw Error(`${e}: array of numbers expected`)})("radix2.decode",r),Uint8Array.from(p(r,e,8,t)))}}(5),l("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),function(e,t="="){return s(5),n("padding",t),{encode(e){for(a("padding.encode",e);5*e.length%8;)e.push(t);return e},decode(r){a("padding.decode",r);let i=r.length;if(i*e%8)throw Error("padding: invalid, string should have whole number of bytes");for(;i>0&&r[i-1]===t;i--)if((i-1)*e%8==0)throw Error("padding: invalid, string has too much padding");return r.slice(0,i)}}}(5),u("")),y=("function"==typeof Uint8Array.from([]).toBase64&&Uint8Array.fromBase64,[996825010,642813549,513874426,1027748829,705979059]);"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex||function(e){if("function"!=typeof e)throw Error("function expected")}(e=>{if("string"!=typeof e||e.length%2!=0)throw TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})},12238:function(e,t,r){"use strict";function i(){return(null===r.g||void 0===r.g?void 0:r.g.crypto)||(null===r.g||void 0===r.g?void 0:r.g.msCrypto)||{}}function n(){let e=i();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=i,t.getSubtleCrypto=n,t.isBrowserCryptoAvailable=function(){return!!i()&&!!n()}},33531:function(e,t,r){"use strict";var i=r(25566);function n(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function s(){return void 0!==i&&void 0!==i.versions&&void 0!==i.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=n,t.isNode=s,t.isBrowser=function(){return!n()&&!s()}},13303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(45161);i.__exportStar(r(12238),t),i.__exportStar(r(33531),t)},45161:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return s},__asyncDelegator:function(){return v},__asyncGenerator:function(){return w},__asyncValues:function(){return E},__await:function(){return m},__awaiter:function(){return u},__classPrivateFieldGet:function(){return O},__classPrivateFieldSet:function(){return _},__createBinding:function(){return f},__decorate:function(){return a},__exportStar:function(){return d},__extends:function(){return n},__generator:function(){return h},__importDefault:function(){return S},__importStar:function(){return I},__makeTemplateObject:function(){return x},__metadata:function(){return l},__param:function(){return c},__read:function(){return g},__rest:function(){return o},__spread:function(){return y},__spreadArrays:function(){return b},__values:function(){return p}});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function a(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,i){t(r,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,i){return new(r||(r=Promise))(function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function h(e,t){var r,i,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function f(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}function d(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){n[e]&&(i[e]=function(t){return new Promise(function(r,i){s.push([e,t,r,i])>1||a(e,t)})})}function a(e,t){try{var r;(r=n[e](t)).value instanceof m?Promise.resolve(r.value.v).then(c,l):u(s[0][2],r)}catch(e){u(s[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function v(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:m(e[i](t)),done:"return"===i}:n?n(t):t}:n}}function E(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,n){!function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)}(i,n,(t=e[r](t)).done,t.value)})}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,r){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},49905:function(e,t,r){"use strict";let i;r.d(t,{Gn:function(){return hl}});var n=r(55445),s=r.n(n),o=r(65383),a=r(40537),c=r(76454),l=r(3897);r(67045),r(24530),r(440),r(722);var u=r(99807);r(65176),r(87405),r(64445),r(14931);var h=r(46819);r(42560),r(79251),r(54907),r(32252),r(65155);var f=r(92113),d=r(53936),p=r(38525),g=r(57583);async function y({hash:e,signature:t}){let i=(0,d.v)(e)?e:(0,h.NC)(e),{secp256k1:n}=await Promise.resolve().then(r.bind(r,85024)),s=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){let{r:e,s:r,v:i,yParity:s}=t,o=b(Number(s??i));return new n.Signature((0,g.y_)(e),(0,g.y_)(r)).addRecoveryBit(o)}let e=(0,d.v)(t)?t:(0,h.NC)(t);if(65!==(0,p.d)(e))throw Error("invalid signature length");let r=b((0,g.ly)(`0x${e.slice(130)}`));return n.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(r)})().recoverPublicKey(i.substring(2)).toHex(!1);return`0x${s}`}function b(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw Error("Invalid yParityOrV value")}async function m({hash:e,signature:t}){return function(e){let t=(0,u.w)(`0x${e.substring(4)}`).substring(26);return(0,f.x)(`0x${t}`)}(await y({hash:e,signature:t}))}r(67516),r(21217),r(84562),r(70097),r(84312),r(183),r(68576),r(51101),r(89890),r(12037),r(12187),r(55574),r(12426),r(56391),r(20758),r(3297),r(39857),r(59550),r(67991),r(34981),new(r(56315)).k(128),r(45175),r(34046),r(40308),(0,h.eC)(0,{size:32}),r(22109),r(74318),r(69604),r(98878),r(29415),r(85341),r(12497),r(95627),r(88059),r(49787),r(84552),r(7457),r(27172),r(50971),r(33410),r(81149),r(13320),r(46693),r(17373),r(27095),r(92972),r(71936),r(53521),r(19362),r(95907),r(69365),r(8374);var w=r(3567),v=r(76087),E=r(87034),x=r(9520);class I extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let S={checksum:new I(8192)}.checksum;r(60763);let O=/^0x[a-fA-F0-9]{40}$/;class _ extends w.G{constructor({address:e,cause:t}){super(`Address "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class P extends w.G{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class A extends w.G{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}let D=/^(.*)\[([0-9]*)\]$/,R=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,C=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function B(e,t){if(e.length!==t.length)throw new T({expectedLength:e.length,givenLength:t.length});let r=[];for(let i=0;i<e.length;i++){let n=e[i],s=t[i];r.push(B.encode(n,s))}return x.zo(...r)}new Uint8Array,new DataView(new ArrayBuffer(0)),w.G,w.G,w.G,(B||(B={})).encode=function e(t,r,i=!1){if("address"===t)return function e(t,r={}){let{strict:i=!0}=r;if(!O.test(t))throw new _({address:t,cause:new P});if(i){if(t.toLowerCase()===t)return;if(function(t){if(S.has(t))return S.get(t);e(t,{strict:!1});let r=t.substring(2).toLowerCase(),i=function(e,t={}){let{as:r="string"==typeof e?"Hex":"Bytes"}=t,i=(0,v.fr)(E.Dp(e));return"Bytes"===r?i:x.xv(i)}(E.mL(r),{as:"Bytes"}),n=r.split("");for(let e=0;e<40;e+=2)i[e>>1]>>4>=8&&n[e]&&(n[e]=n[e].toUpperCase()),(15&i[e>>1])>=8&&n[e+1]&&(n[e+1]=n[e+1].toUpperCase());let s=`0x${n.join("")}`;return S.set(t,s),s}(t)!==t)throw new _({address:t,cause:new A})}}(r),x.Q_(r.toLowerCase(),i?32:0);if("string"===t)return x.mL(r);if("bytes"===t)return r;if("bool"===t)return x.Q_(x.O3(r),i?32:1);let n=t.match(C);if(n){let[e,t,s="256"]=n,o=Number.parseInt(s,10)/8;return x.xS(r,{size:i?32:o,signed:"int"===t})}let s=t.match(R);if(s){let[e,t]=s;if(Number.parseInt(t,10)!==(r.length-2)/2)throw new U({expectedSize:Number.parseInt(t,10),value:r});return x.eh(r,i?32:0)}let o=t.match(D);if(o&&Array.isArray(r)){let[t,i]=o,n=[];for(let t=0;t<r.length;t++)n.push(e(i,r[t],!0));return 0===n.length?"0x":x.zo(...n)}throw new N(t)};class U extends w.G{constructor({expectedSize:e,value:t}){super(`Size of bytes "${t}" (bytes${x.dp(t)}) does not match expected size (bytes${e}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}}class T extends w.G{constructor({expectedLength:e,givenLength:t}){super(`ABI encoding parameters/values length mismatch.
Expected length (parameters): ${e}
Given length (values): ${t}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class N extends w.G{constructor(e){super(`Type \`${e}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}r(85024),r(30656),r(64996),r(79271);var k=r(54414),j=r(54003),L=r(46905),$=r(46633),M=r(47159),z=r(21086),q=r(84041),F=r(25566),V=r(82957).Buffer;function K(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function H(e,t=[]){let r=[];return Object.keys(e).forEach(i=>{if(t.length&&!t.includes(i))return;let n=e[i];r.push(...n.accounts)}),r}function G(e,t){return e.includes(":")?[e]:t.chains||[]}var W=Object.defineProperty,J=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,ee=(e,t,r)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,et=(e,t)=>{for(var r in t||(t={}))Q.call(t,r)&&ee(e,r,t[r]);if(Y)for(var r of Y(t))X.call(t,r)&&ee(e,r,t[r]);return e},er=(e,t)=>J(e,Z(t)),ei=(e,t,r)=>ee(e,"symbol"!=typeof t?t+"":t,r);let en={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function es(){return"u">typeof F&&"u">typeof F.versions&&"u">typeof F.versions.node}function eo(){return!(0,c.getDocument)()&&!!(0,c.getNavigator)()&&"ReactNative"===navigator.product}function ea(){return!es()&&!!(0,c.getNavigator)()&&!!(0,c.getDocument)()}function ec(){return eo()?en.reactNative:es()?en.node:ea()?en.browser:en.unknown}function el(){var e;try{return eo()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Application)?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function eu(){return(0,l.D)()||{name:"",description:"",url:"",icons:[""]}}function eh(e,t,i){let n=function(){if(ec()===en.reactNative&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)){let{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}let e=(0,o.qY)();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),s=function(){var e;let t=ec();return t===en.browser?[t,(null==(e=(0,c.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",i].join("-"),n,s].join("/")}function ef(e,t){return e.filter(e=>t.includes(e)).length===e.length}function ed(e){return Object.fromEntries(e.entries())}function ep(e){return new Map(Object.entries(e))}function eg(e=a.FIVE_MINUTES,t){let r,i,n,s;let o=(0,a.toMiliseconds)(e||a.FIVE_MINUTES);return{resolve:e=>{n&&r&&(clearTimeout(n),r(e),s=Promise.resolve(e))},reject:e=>{n&&i&&(clearTimeout(n),i(e))},done:()=>new Promise((e,a)=>{if(s)return e(s);n=setTimeout(()=>{let e=Error(t);s=Promise.reject(e),a(e)},o),r=e,i=a})}}function ey(e,t,r){return new Promise(async(i,n)=>{let s=setTimeout(()=>n(Error(r)),t);try{let t=await e;i(t)}catch(e){n(e)}clearTimeout(s)})}function eb(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function em(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function ew(e,t){return(0,a.fromMiliseconds)((t||Date.now())+(0,a.toMiliseconds)(e))}function ev(e){return Date.now()>=(0,a.toMiliseconds)(e)}function eE(e,t){return`${e}${t?`:${t}`:""}`}function ex(e=[],t=[]){return[...new Set([...e,...t])]}async function eI({id:e,topic:t,wcDeepLink:i}){var n;try{if(!i)return;let s="string"==typeof i?JSON.parse(i):i,o=s?.href;if("string"!=typeof o)return;let a=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let n=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";n=`${n}${t}${function(e,t=!1){let r=V.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else n=`${n}/wc?${i}`;return n}(o,e,t),l=ec();if(l===en.browser){let e;if(!(null!=(n=(0,c.getDocument)())&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}e="_self",function(){try{return window.self!==window.top}catch{return!1}}()?e="_top":("u">typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||a.startsWith("https://")||a.startsWith("http://"))&&(e="_blank"),window.open(a,e,"noreferrer noopener")}else l===en.reactNative&&"u">typeof(null==r.g?void 0:r.g.Linking)&&await r.g.Linking.openURL(a)}catch(e){console.error(e)}}async function eS(e,t){let r="";try{if(ea()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function eO(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function e_(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function eP(){return"u">typeof F&&"true"===F.env.IS_VITEST}function eA(e){return V.from(e,"base64").toString("utf-8")}class eD{constructor({limit:e}){ei(this,"limit"),ei(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){let e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}}let eR=BigInt(4294967296-1),eC=BigInt(32);function eB(e,t=!1){return t?{h:Number(e&eR),l:Number(e>>eC&eR)}:{h:0|Number(e>>eC&eR),l:0|Number(e&eR)}}function eU(e,t=!1){let r=e.length,i=new Uint32Array(r),n=new Uint32Array(r);for(let s=0;s<r;s++){let{h:r,l:o}=eB(e[s],t);[i[s],n[s]]=[r,o]}return[i,n]}let eT=(e,t,r)=>e>>>r,eN=(e,t,r)=>e<<32-r|t>>>r,ek=(e,t,r)=>e>>>r|t<<32-r,ej=(e,t,r)=>e<<32-r|t>>>r,eL=(e,t,r)=>e<<64-r|t>>>r-32,e$=(e,t,r)=>e>>>r-32|t<<64-r,eM=(e,t)=>t,ez=(e,t)=>e,eq=(e,t,r)=>e<<r|t>>>32-r,eF=(e,t,r)=>t<<r|e>>>32-r,eV=(e,t,r)=>t<<r-32|e>>>64-r,eK=(e,t,r)=>e<<r-32|t>>>64-r;function eH(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/4294967296|0)|0,l:0|n}}let eG=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),eW=(e,t,r,i)=>t+r+i+(e/4294967296|0)|0,eJ=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),eZ=(e,t,r,i,n)=>t+r+i+n+(e/4294967296|0)|0,eY=(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0),eQ=(e,t,r,i,n,s)=>t+r+i+n+s+(e/4294967296|0)|0,eX="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function e0(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function e1(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function e2(e,...t){if(!e0(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function e5(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");e1(e.outputLen),e1(e.blockLen)}function e6(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function e8(e,t){e2(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function e3(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function e4(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function e9(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function e7(e,t){return e<<32-t|e>>>t}let te=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function tt(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}let tr=te?e=>e:e=>tt(e),ti=te?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=tt(e[t]);return e},tn="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,ts=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function to(e){if(e2(e),tn)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=ts[e[r]];return t}let ta={_0:48,_9:57,A:65,F:70,a:97,f:102};function tc(e){return e>=ta._0&&e<=ta._9?e-ta._0:e>=ta.A&&e<=ta.F?e-(ta.A-10):e>=ta.a&&e<=ta.f?e-(ta.a-10):void 0}function tl(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(tn)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=tc(e.charCodeAt(n)),s=tc(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i}function tu(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function th(e){return"string"==typeof e&&(e=tu(e)),e2(e),e}function tf(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];e2(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}class td{}function tp(e){let t=t=>e().update(th(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function tg(e=32){if(eX&&"function"==typeof eX.getRandomValues)return eX.getRandomValues(new Uint8Array(e));if(eX&&"function"==typeof eX.randomBytes)return Uint8Array.from(eX.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}let ty=BigInt(0),tb=BigInt(1),tm=BigInt(2),tw=BigInt(7),tv=BigInt(256),tE=BigInt(113),tx=[],tI=[],tS=[];for(let e=0,t=tb,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],tx.push(2*(5*i+r)),tI.push((e+1)*(e+2)/2%64);let n=ty;for(let e=0;e<7;e++)(t=(t<<tb^(t>>tw)*tE)%tv)&tm&&(n^=tb<<(tb<<BigInt(e))-tb);tS.push(n)}let tO=eU(tS,!0),t_=tO[0],tP=tO[1],tA=(e,t,r)=>r>32?eV(e,t,r):eq(e,t,r),tD=(e,t,r)=>r>32?eK(e,t,r):eF(e,t,r);class tR extends td{constructor(e,t,r,i=!1,n=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,e1(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=e3(this.state)}clone(){return this._cloneInto()}keccak(){ti(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,s=r[n],o=r[n+1],a=tA(s,o,1)^r[i],c=tD(s,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=tI[r],s=tA(t,n,i),o=tD(t,n,i),a=tx[r];t=e[a],n=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=t_[i],e[1]^=tP[i]}e4(r)}(this.state32,this.rounds),ti(this.state32),this.posOut=0,this.pos=0}update(e){e6(this),e2(e=th(e));let{blockLen:t,state:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(t-this.pos,i-n);for(let t=0;t<s;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){e6(this,!1),e2(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let s=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+s),i),this.posOut+=s,i+=s}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return e1(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(e8(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,e4(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:s}=this;return e||(e=new tR(t,r,i,s,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=s,e.destroyed=this.destroyed,e}}let tC=tp(()=>new tR(136,1,32));class tB extends td{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=e9(this.buffer)}update(e){e6(this),e2(e=th(e));let{view:t,buffer:r,blockLen:i}=this,n=e.length;for(let s=0;s<n;){let o=Math.min(i-this.pos,n-s);if(o===i){let t=e9(e);for(;i<=n-s;s+=i)this.process(t,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){e6(this),e8(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:n}=this,{pos:s}=this;t[s++]=128,e4(this.buffer.subarray(s)),this.padOffset>i-s&&(this.process(r,0),s=0);for(let e=s;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)})(r,i-8,BigInt(8*this.length),n),this.process(r,0);let o=e9(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=a/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],n)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=n,e.length=i,e.pos=o,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}let tU=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tT=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),tN=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),tk=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tj=new Uint32Array(64);class tL extends tB{constructor(e=32){super(64,e,8,!1),this.A=0|tU[0],this.B=0|tU[1],this.C=0|tU[2],this.D=0|tU[3],this.E=0|tU[4],this.F=0|tU[5],this.G=0|tU[6],this.H=0|tU[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:s,G:o,H:a}=this;return[e,t,r,i,n,s,o,a]}set(e,t,r,i,n,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)tj[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=tj[e-15],r=tj[e-2],i=e7(t,7)^e7(t,18)^t>>>3,n=e7(r,17)^e7(r,19)^r>>>10;tj[e]=n+tj[e-7]+i+tj[e-16]|0}let{A:r,B:i,C:n,D:s,E:o,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){var u,h,f,d;let t=l+(e7(o,6)^e7(o,11)^e7(o,25))+((u=o)&a^~u&c)+tk[e]+tj[e]|0,p=(e7(r,2)^e7(r,13)^e7(r,22))+((h=r)&(f=i)^h&(d=n)^f&d)|0;l=c,c=a,a=o,o=s+t|0,s=n,n=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,i,n,s,o,a,c,l)}roundClean(){e4(tj)}destroy(){this.set(0,0,0,0,0,0,0,0),e4(this.buffer)}}let t$=eU(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),tM=t$[0],tz=t$[1],tq=new Uint32Array(80),tF=new Uint32Array(80);class tV extends tB{constructor(e=64){super(128,e,16,!1),this.Ah=0|tN[0],this.Al=0|tN[1],this.Bh=0|tN[2],this.Bl=0|tN[3],this.Ch=0|tN[4],this.Cl=0|tN[5],this.Dh=0|tN[6],this.Dl=0|tN[7],this.Eh=0|tN[8],this.El=0|tN[9],this.Fh=0|tN[10],this.Fl=0|tN[11],this.Gh=0|tN[12],this.Gl=0|tN[13],this.Hh=0|tN[14],this.Hl=0|tN[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g]}set(e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)tq[r]=e.getUint32(t),tF[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|tq[e-15],r=0|tF[e-15],i=ek(t,r,1)^ek(t,r,8)^eT(t,r,7),n=ej(t,r,1)^ej(t,r,8)^eN(t,r,7),s=0|tq[e-2],o=0|tF[e-2],a=ek(s,o,19)^eL(s,o,61)^eT(s,o,6),c=eJ(n,ej(s,o,19)^e$(s,o,61)^eN(s,o,6),tF[e-7],tF[e-16]),l=eZ(c,i,a,tq[e-7],tq[e-16]);tq[e]=0|l,tF[e]=0|c}let{Ah:r,Al:i,Bh:n,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:f,Fl:d,Gh:p,Gl:g,Hh:y,Hl:b}=this;for(let e=0;e<80;e++){let t=ek(u,h,14)^ek(u,h,18)^eL(u,h,41),m=ej(u,h,14)^ej(u,h,18)^e$(u,h,41),w=u&f^~u&p,v=eY(b,m,h&d^~h&g,tz[e],tF[e]),E=eQ(v,y,t,w,tM[e],tq[e]),x=0|v,I=ek(r,i,28)^eL(r,i,34)^eL(r,i,39),S=ej(r,i,28)^e$(r,i,34)^e$(r,i,39),O=r&n^r&o^n&o,_=i&s^i&a^s&a;y=0|p,b=0|g,p=0|f,g=0|d,f=0|u,d=0|h,({h:u,l:h}=eH(0|c,0|l,0|E,0|x)),c=0|o,l=0|a,o=0|n,a=0|s,n=0|r,s=0|i;let P=eG(x,S,_);r=eW(P,E,I,O),i=0|P}({h:r,l:i}=eH(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:s}=eH(0|this.Bh,0|this.Bl,0|n,0|s)),({h:o,l:a}=eH(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l:l}=eH(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=eH(0|this.Eh,0|this.El,0|u,0|h)),({h:f,l:d}=eH(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:g}=eH(0|this.Gh,0|this.Gl,0|p,0|g)),({h:y,l:b}=eH(0|this.Hh,0|this.Hl,0|y,0|b)),this.set(r,i,n,s,o,a,c,l,u,h,f,d,p,g,y,b)}roundClean(){e4(tq,tF)}destroy(){e4(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class tK extends tV{constructor(){super(48),this.Ah=0|tT[0],this.Al=0|tT[1],this.Bh=0|tT[2],this.Bl=0|tT[3],this.Ch=0|tT[4],this.Cl=0|tT[5],this.Dh=0|tT[6],this.Dl=0|tT[7],this.Eh=0|tT[8],this.El=0|tT[9],this.Fh=0|tT[10],this.Fl=0|tT[11],this.Gh=0|tT[12],this.Gl=0|tT[13],this.Hh=0|tT[14],this.Hl=0|tT[15]}}let tH=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class tG extends tV{constructor(){super(32),this.Ah=0|tH[0],this.Al=0|tH[1],this.Bh=0|tH[2],this.Bl=0|tH[3],this.Ch=0|tH[4],this.Cl=0|tH[5],this.Dh=0|tH[6],this.Dl=0|tH[7],this.Eh=0|tH[8],this.El=0|tH[9],this.Fh=0|tH[10],this.Fl=0|tH[11],this.Gh=0|tH[12],this.Gl=0|tH[13],this.Hh=0|tH[14],this.Hl=0|tH[15]}}let tW=tp(()=>new tL),tJ=tp(()=>new tV),tZ=tp(()=>new tK),tY=tp(()=>new tG),tQ=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),tX=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),t0=new Uint32Array(32);function t1(e,t,r,i,n,s){let o=n[s],a=n[s+1],c=t0[2*e],l=t0[2*e+1],u=t0[2*t],h=t0[2*t+1],f=t0[2*r],d=t0[2*r+1],p=t0[2*i],g=t0[2*i+1],y=eG(c,u,o);l=eW(y,l,h,a),c=0|y,({Dh:g,Dl:p}={Dh:g^l,Dl:p^c}),({Dh:g,Dl:p}={Dh:eM(g,p),Dl:ez(g)}),({h:d,l:f}=eH(d,f,g,p)),({Bh:h,Bl:u}={Bh:h^d,Bl:u^f}),({Bh:h,Bl:u}={Bh:ek(h,u,24),Bl:ej(h,u,24)}),t0[2*e]=c,t0[2*e+1]=l,t0[2*t]=u,t0[2*t+1]=h,t0[2*r]=f,t0[2*r+1]=d,t0[2*i]=p,t0[2*i+1]=g}function t2(e,t,r,i,n,s){let o=n[s],a=n[s+1],c=t0[2*e],l=t0[2*e+1],u=t0[2*t],h=t0[2*t+1],f=t0[2*r],d=t0[2*r+1],p=t0[2*i],g=t0[2*i+1],y=eG(c,u,o);l=eW(y,l,h,a),c=0|y,({Dh:g,Dl:p}={Dh:g^l,Dl:p^c}),({Dh:g,Dl:p}={Dh:ek(g,p,16),Dl:ej(g,p,16)}),({h:d,l:f}=eH(d,f,g,p)),({Bh:h,Bl:u}={Bh:h^d,Bl:u^f}),({Bh:h,Bl:u}={Bh:eL(h,u,63),Bl:e$(h,u,63)}),t0[2*e]=c,t0[2*e+1]=l,t0[2*t]=u,t0[2*t+1]=h,t0[2*r]=f,t0[2*r+1]=d,t0[2*i]=p,t0[2*i+1]=g}class t5 extends td{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,e1(e),e1(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=e3(this.buffer)}update(e){e6(this),e2(e=th(e));let{blockLen:t,buffer:r,buffer32:i}=this,n=e.length,s=e.byteOffset,o=e.buffer;for(let a=0;a<n;){this.pos===t&&(ti(i),this.compress(i,0,!1),ti(i),this.pos=0);let c=Math.min(t-this.pos,n-a),l=s+a;if(c===t&&!(l%4)&&a+c<n){let e=new Uint32Array(o,l,Math.floor((n-a)/4));ti(e);for(let r=0;a+t<n;r+=i.length,a+=t)this.length+=t,this.compress(e,r,!1);ti(e);continue}r.set(e.subarray(a,a+c),this.pos),this.pos+=c,this.length+=c,a+=c}return this}digestInto(e){e6(this),e8(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,e4(this.buffer.subarray(t)),ti(r),this.compress(r,0,!0),ti(r);let i=e3(e);this.get().forEach((e,t)=>i[t]=tr(e))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:n,outputLen:s,pos:o}=this;return e||(e=new this.constructor({dkLen:s})),e.set(...this.get()),e.buffer.set(t),e.destroyed=n,e.finished=i,e.length=r,e.pos=o,e.outputLen=s,e}clone(){return this._cloneInto()}}class t6 extends t5{constructor(e={}){let t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|tX[0],this.v0h=0|tX[1],this.v1l=0|tX[2],this.v1h=0|tX[3],this.v2l=0|tX[4],this.v2h=0|tX[5],this.v3l=0|tX[6],this.v3h=0|tX[7],this.v4l=0|tX[8],this.v4h=0|tX[9],this.v5l=0|tX[10],this.v5h=0|tX[11],this.v6l=0|tX[12],this.v6h=0|tX[13],this.v7l=0|tX[14],this.v7h=0|tX[15],function(e,t={},r,i,n){if(e1(64),e<0||e>64)throw Error("outputLen bigger than keyLen");let{key:s,salt:o,personalization:a}=t;if(void 0!==s&&(s.length<1||s.length>64))throw Error("key length must be undefined or 1.."+r);if(void 0!==o&&16!==o.length)throw Error("salt must be undefined or 16");if(void 0!==a&&16!==a.length)throw Error("personalization must be undefined or 16")}(t,e,64,0,0);let{key:r,personalization:i,salt:n}=e,s=0;if(void 0!==r&&(s=(r=th(r)).length),this.v0l^=this.outputLen|s<<8|16842752,void 0!==n){let e=e3(n=th(n));this.v4l^=tr(e[0]),this.v4h^=tr(e[1]),this.v5l^=tr(e[2]),this.v5h^=tr(e[3])}if(void 0!==i){let e=e3(i=th(i));this.v6l^=tr(e[0]),this.v6h^=tr(e[1]),this.v7l^=tr(e[2]),this.v7h^=tr(e[3])}if(void 0!==r){let e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:n,v2h:s,v3l:o,v3h:a,v4l:c,v4h:l,v5l:u,v5h:h,v6l:f,v6h:d,v7l:p,v7h:g}=this;return[e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g]}set(e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|i,this.v2l=0|n,this.v2h=0|s,this.v3l=0|o,this.v3h=0|a,this.v4l=0|c,this.v4h=0|l,this.v5l=0|u,this.v5h=0|h,this.v6l=0|f,this.v6h=0|d,this.v7l=0|p,this.v7h=0|g}compress(e,t,r){this.get().forEach((e,t)=>t0[t]=e),t0.set(tX,16);let{h:i,l:n}=eB(BigInt(this.length));t0[24]=tX[8]^n,t0[25]=tX[9]^i,r&&(t0[28]=~t0[28],t0[29]=~t0[29]);let s=0;for(let r=0;r<12;r++)t1(0,4,8,12,e,t+2*tQ[s++]),t2(0,4,8,12,e,t+2*tQ[s++]),t1(1,5,9,13,e,t+2*tQ[s++]),t2(1,5,9,13,e,t+2*tQ[s++]),t1(2,6,10,14,e,t+2*tQ[s++]),t2(2,6,10,14,e,t+2*tQ[s++]),t1(3,7,11,15,e,t+2*tQ[s++]),t2(3,7,11,15,e,t+2*tQ[s++]),t1(0,5,10,15,e,t+2*tQ[s++]),t2(0,5,10,15,e,t+2*tQ[s++]),t1(1,6,11,12,e,t+2*tQ[s++]),t2(1,6,11,12,e,t+2*tQ[s++]),t1(2,7,8,13,e,t+2*tQ[s++]),t2(2,7,8,13,e,t+2*tQ[s++]),t1(3,4,9,14,e,t+2*tQ[s++]),t2(3,4,9,14,e,t+2*tQ[s++]);this.v0l^=t0[0]^t0[16],this.v0h^=t0[1]^t0[17],this.v1l^=t0[2]^t0[18],this.v1h^=t0[3]^t0[19],this.v2l^=t0[4]^t0[20],this.v2h^=t0[5]^t0[21],this.v3l^=t0[6]^t0[22],this.v3h^=t0[7]^t0[23],this.v4l^=t0[8]^t0[24],this.v4h^=t0[9]^t0[25],this.v5l^=t0[10]^t0[26],this.v5h^=t0[11]^t0[27],this.v6l^=t0[12]^t0[28],this.v6h^=t0[13]^t0[29],this.v7l^=t0[14]^t0[30],this.v7h^=t0[15]^t0[31],e4(t0)}destroy(){this.destroyed=!0,e4(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let t8=function(e){let t=(t,r)=>e(r).update(th(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new t6(e));function t3(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+V.from(tC(r)).toString("hex")}async function t4(e,t,r,i,n,s){switch(r.t){case"eip191":return await t9(e,t,r.s);case"eip1271":return await t7(e,t,r.s,i,n,s);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function t9(e,t,r){return(await m({hash:t3(t),signature:r})).toLowerCase()===e.toLowerCase()}async function t7(e,t,r,i,n,s){let o=K(i);if(!o.namespace||!o.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let o="0x1626ba7e",a=r.substring(2),c=(a.length/2).toString(16).padStart(64,"0"),l=(t.startsWith("0x")?t:t3(t)).substring(2),u=await fetch(`${s||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${n}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:o+l+"0000000000000000000000000000000000000000000000000000000000000040"+c+a},"latest"]})}),{result:h}=await u.json();return!!h&&h.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}function re(e){let t=new Uint8Array(tW(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return k.Z.encode(t)}function rt(e){let t=V.from(e,"base64"),r=(0,j.Jx)(t).txn;if(!r)throw Error("Invalid signed transaction: missing 'txn' field");let i=(0,j.cv)(r),n=V.from("TX"),s=tY(V.concat([n,V.from(i)]));return L.pJ.encode(s).replace(/=+$/,"")}function rr(e){let t=[],r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),V.from(t)}var ri=Object.defineProperty,rn=Object.defineProperties,rs=Object.getOwnPropertyDescriptors,ro=Object.getOwnPropertySymbols,ra=Object.prototype.hasOwnProperty,rc=Object.prototype.propertyIsEnumerable,rl=(e,t,r)=>t in e?ri(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ru=(e,t)=>{for(var r in t||(t={}))ra.call(t,r)&&rl(e,r,t[r]);if(ro)for(var r of ro(t))rc.call(t,r)&&rl(e,r,t[r]);return e},rh=(e,t)=>rn(e,rs(t));let rf=e=>e?.split(":"),rd=e=>{let t=e&&rf(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},rp=e=>{let t=e&&rf(e);if(t)return t[2]+":"+t[3]},rg=e=>{let t=e&&rf(e);if(t)return t.pop()};async function ry(e){let{cacao:t,projectId:r}=e,{s:i,p:n}=t,s=rb(n,n.iss),o=rg(n.iss);return await t4(o,s,i,rp(n.iss),r)}let rb=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=rg(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let n=e.statement||void 0,s=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${rd(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,f=e.requestId?`Request ID: ${e.requestId}`:void 0,d=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,p=rI(e.resources);return p&&(n=function(e="",t){rm(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],n=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let s={};r.forEach(e=>{s[e.ability]||(s[e.ability]=[]),s[e.ability].push(e.action)});let o=Object.keys(s).map(t=>(n++,`(${n}) '${t}': '${s[t].join("', '")}' for '${e}'.`));i.push(o.join(", ").replace(".,","."))});let s=i.join(" "),o=`${r}${s}`;return`${e?e+" ":""}${o}`}(n,rv(p))),[r,i,"",n,"",s,o,a,c,l,u,h,f,d].filter(e=>null!=e).join(`
`)};function rm(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function rw(e){return rm(e),`urn:recap:${V.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function rv(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(V.from(t,"base64").toString("utf-8")));return rm(r),r}function rE(e){var t;let r=rv(e);rm(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function rx(e){let t=rv(e);rm(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function rI(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function rS(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function rO(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}function r_(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function rP(e,...t){if(!rS(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function rA(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function rD(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function rR(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let rC=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function rB(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(rS(e))e=rN(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function rU(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function rT(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)}function rN(e){return Uint8Array.from(e)}let rk=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),rj=rk("expand 16-byte k"),rL=rk("expand 32-byte k"),r$=rD(rj),rM=rD(rL);function rz(e,t){return e<<t|e>>>32-t}function rq(e){return e.byteOffset%4==0}let rF=4294967296-1,rV=new Uint32Array,rK=(e,t)=>255&e[t++]|(255&e[t++])<<8;class rH{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,rP(e=rB(e),32);let t=rK(e,0),r=rK(e,2),i=rK(e,4),n=rK(e,6),s=rK(e,8),o=rK(e,10),a=rK(e,12),c=rK(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|n<<9)&8191,this.r[4]=(n>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|o<<2)&8191,this.r[7]=(o>>>11|a<<5)&8065,this.r[8]=(a>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=rK(e,16+2*t)}process(e,t,r=!1){let{h:i,r:n}=this,s=n[0],o=n[1],a=n[2],c=n[3],l=n[4],u=n[5],h=n[6],f=n[7],d=n[8],p=n[9],g=rK(e,t+0),y=rK(e,t+2),b=rK(e,t+4),m=rK(e,t+6),w=rK(e,t+8),v=rK(e,t+10),E=rK(e,t+12),x=rK(e,t+14),I=i[0]+(8191&g),S=i[1]+((g>>>13|y<<3)&8191),O=i[2]+((y>>>10|b<<6)&8191),_=i[3]+((b>>>7|m<<9)&8191),P=i[4]+((m>>>4|w<<12)&8191),A=i[5]+(w>>>1&8191),D=i[6]+((w>>>14|v<<2)&8191),R=i[7]+((v>>>11|E<<5)&8191),C=i[8]+((E>>>8|x<<8)&8191),B=i[9]+(x>>>5|(r?0:2048)),U=0,T=0+I*s+5*p*S+5*d*O+5*f*_+5*h*P;U=T>>>13,T&=8191,T+=5*u*A+5*l*D+5*c*R+5*a*C+5*o*B,U+=T>>>13,T&=8191;let N=U+I*o+S*s+5*p*O+5*d*_+5*f*P;U=N>>>13,N&=8191,N+=5*h*A+5*u*D+5*l*R+5*c*C+5*a*B,U+=N>>>13,N&=8191;let k=U+I*a+S*o+O*s+5*p*_+5*d*P;U=k>>>13,k&=8191,k+=5*f*A+5*h*D+5*u*R+5*l*C+5*c*B,U+=k>>>13,k&=8191;let j=U+I*c+S*a+O*o+_*s+5*p*P;U=j>>>13,j&=8191,j+=5*d*A+5*f*D+5*h*R+5*u*C+5*l*B,U+=j>>>13,j&=8191;let L=U+I*l+S*c+O*a+_*o+P*s;U=L>>>13,L&=8191,L+=5*p*A+5*d*D+5*f*R+5*h*C+5*u*B,U+=L>>>13,L&=8191;let $=U+I*u+S*l+O*c+_*a+P*o;U=$>>>13,$&=8191,$+=A*s+5*p*D+5*d*R+5*f*C+5*h*B,U+=$>>>13,$&=8191;let M=U+I*h+S*u+O*l+_*c+P*a;U=M>>>13,M&=8191,M+=A*o+D*s+5*p*R+5*d*C+5*f*B,U+=M>>>13,M&=8191;let z=U+I*f+S*h+O*u+_*l+P*c;U=z>>>13,z&=8191,z+=A*a+D*o+R*s+5*p*C+5*d*B,U+=z>>>13,z&=8191;let q=U+I*d+S*f+O*h+_*u+P*l;U=q>>>13,q&=8191,q+=A*c+D*a+R*o+C*s+5*p*B,U+=q>>>13,q&=8191;let F=U+I*p+S*d+O*f+_*h+P*u;U=F>>>13,F&=8191,F+=A*l+D*c+R*a+C*o+B*s,U+=F>>>13,F&=8191,T=8191&(U=(U=(U<<2)+U|0)+T|0),U>>>=13,N+=U,i[0]=T,i[1]=N,i[2]=k,i[3]=j,i[4]=L,i[5]=$,i[6]=M,i[7]=z,i[8]=q,i[9]=F}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let n=(1^i)-1;for(let e=0;e<10;e++)r[e]&=n;n=~n;for(let t=0;t<10;t++)e[t]=e[t]&n|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+t[0];e[0]=65535&s;for(let r=1;r<8;r++)s=(e[r]+t[r]|0)+(s>>>16)|0,e[r]=65535&s;rR(r)}update(e){rA(this),rP(e=rB(e));let{buffer:t,blockLen:r}=this,i=e.length;for(let n=0;n<i;){let s=Math.min(r-this.pos,i-n);if(s===r){for(;r<=i-n;n+=r)this.process(e,n);continue}t.set(e.subarray(n,n+s),this.pos),this.pos+=s,n+=s,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){rR(this.h,this.r,this.buffer,this.pad)}digestInto(e){rA(this),function(e,t){rP(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let n=0;for(let t=0;t<8;t++)e[n++]=r[t]>>>0,e[n++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let rG=function(e){let t=(t,r)=>e(r).update(rB(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new rH(e)),rW=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return r_(n),r_(o),rO(s),rO(r),(t,a,c,l,u=0)=>{rP(t),rP(a),rP(c);let h=c.length;if(void 0===l&&(l=new Uint8Array(h)),rP(l),r_(u),u<0||u>=rF)throw Error("arx: counter overflow");if(l.length<h)throw Error(`arx: output (${l.length}) is shorter than data (${h})`);let f=[],d=t.length,p,g;if(32===d)f.push(p=rN(t)),g=rM;else if(16===d&&r)(p=new Uint8Array(32)).set(t),p.set(t,16),g=r$,f.push(p);else throw Error(`arx: invalid 32-byte key, got length=${d}`);rq(a)||f.push(a=rN(a));let y=rD(p);if(i){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");i(g,y,rD(a.subarray(0,16)),y),a=a.subarray(16)}let b=16-n;if(b!==a.length)throw Error(`arx: nonce must be ${b} or 16 bytes`);if(12!==b){let e=new Uint8Array(12);e.set(a,s?0:12-a.length),a=e,f.push(a)}return function(e,t,r,i,n,s,o,a){let c=n.length,l=new Uint8Array(64),u=rD(l),h=rq(n)&&rq(s),f=h?rD(n):rV,d=h?rD(s):rV;for(let p=0;p<c;o++){if(e(t,r,i,u,o,a),o>=rF)throw Error("arx: counter overflow");let g=Math.min(64,c-p);if(h&&64===g){let e=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)d[r=e+t]=f[r]^u[t];p+=64;continue}for(let e=0,t;e<g;e++)s[t=p+e]=n[t]^l[e];p+=g}}(e,g,y,rD(a),c,l,u,o),rR(...f),l}}(function(e,t,r,i,n,s=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],h=t[1],f=t[2],d=t[3],p=t[4],g=t[5],y=t[6],b=t[7],m=r[0],w=r[1],v=r[2],E=o,x=a,I=c,S=l,O=u,_=h,P=f,A=d,D=p,R=g,C=y,B=b,U=n,T=m,N=w,k=v;for(let e=0;e<s;e+=2)D=D+(U=rz(U^(E=E+O|0),16))|0,E=E+(O=rz(O^D,12))|0,D=D+(U=rz(U^E,8))|0,O=rz(O^D,7),R=R+(T=rz(T^(x=x+_|0),16))|0,x=x+(_=rz(_^R,12))|0,R=R+(T=rz(T^x,8))|0,_=rz(_^R,7),C=C+(N=rz(N^(I=I+P|0),16))|0,I=I+(P=rz(P^C,12))|0,C=C+(N=rz(N^I,8))|0,P=rz(P^C,7),B=B+(k=rz(k^(S=S+A|0),16))|0,S=S+(A=rz(A^B,12))|0,B=B+(k=rz(k^S,8))|0,A=rz(A^B,7),C=C+(k=rz(k^(E=E+_|0),16))|0,E=E+(_=rz(_^C,12))|0,C=C+(k=rz(k^E,8))|0,_=rz(_^C,7),B=B+(U=rz(U^(x=x+P|0),16))|0,x=x+(P=rz(P^B,12))|0,B=B+(U=rz(U^x,8))|0,P=rz(P^B,7),D=D+(T=rz(T^(I=I+A|0),16))|0,I=I+(A=rz(A^D,12))|0,D=D+(T=rz(T^I,8))|0,A=rz(A^D,7),R=R+(N=rz(N^(S=S+O|0),16))|0,S=S+(O=rz(O^R,12))|0,R=R+(N=rz(N^S,8))|0,O=rz(O^R,7);let j=0;i[j++]=o+E|0,i[j++]=a+x|0,i[j++]=c+I|0,i[j++]=l+S|0,i[j++]=u+O|0,i[j++]=h+_|0,i[j++]=f+P|0,i[j++]=d+A|0,i[j++]=p+D|0,i[j++]=g+R|0,i[j++]=y+C|0,i[j++]=b+B|0,i[j++]=n+U|0,i[j++]=m+T|0,i[j++]=w+N|0,i[j++]=v+k|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),rJ=new Uint8Array(16),rZ=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(rJ.subarray(r))},rY=new Uint8Array(32);function rQ(e,t,r,i,n){let s=e(t,r,rY),o=rG.create(s);n&&rZ(o,n),rZ(o,i);let a=function(e,t,r){rO(r);let i=new Uint8Array(16),n=new DataView(i.buffer,i.byteOffset,i.byteLength);return rT(n,0,BigInt(t),r),rT(n,8,BigInt(e),r),i}(i.length,n?n.length:0,!0);o.update(a);let c=o.digest();return rR(s,a),c}let rX=((e,t)=>{function r(i,...n){if(rP(i),!rC)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){let t=n[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?rP(t):rP(t,e.nonceLength)}let s=e.tagLength;s&&void 0!==n[1]&&rP(n[1]);let o=t(i,...n),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");rP(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,rP(e),a(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(rP(e),s&&e.length<s)throw Error("invalid ciphertext length: smaller than tagLength="+s);return a(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,n){let s=i.length;(n=rU(s+16,n,!1)).set(i);let o=n.subarray(0,-16);rW(e,t,o,o,1);let a=rQ(rW,e,t,o,r);return n.set(a,s),rR(a),n},decrypt(i,n){n=rU(i.length-16,n,!1);let s=i.subarray(0,-16),o=i.subarray(-16),a=rQ(rW,e,t,s,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(o,a))throw Error("invalid tag");return n.set(i.subarray(0,-16)),rW(e,t,n,n,1),rR(a),n}}));class r0 extends td{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,e5(e);let r=th(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),e4(n)}update(e){return e6(this),this.iHash.update(e),this}digestInto(e){e6(this),e2(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:s,outputLen:o}=this;return e.finished=i,e.destroyed=n,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let r1=(e,t,r)=>new r0(e,t).update(r).digest();r1.create=(e,t)=>new r0(e,t);let r2=Uint8Array.from([0]),r5=Uint8Array.of(),r6=(e,t,r,i,n)=>{var s;return function(e,t,r,i=32){e5(e),e1(i);let n=e.outputLen;if(i>255*n)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(i/n);void 0===r&&(r=r5);let o=new Uint8Array(s*n),a=r1.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let e=0;e<s;e++)r2[0]=e+1,c.update(0===e?r5:l).update(r).update(r2).digestInto(l),o.set(l,n*e),a._cloneInto(c);return a.destroy(),c.destroy(),e4(l,r2),o.slice(0,i)}(e,(s=r,e5(e),void 0===s&&(s=new Uint8Array(e.outputLen)),r1(e,th(s),th(t))),i,n)},r8=BigInt(0),r3=BigInt(1);function r4(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function r9(e,t,r=""){let i=e0(e),n=e?.length,s=void 0!==t;if(!i||s&&n!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?` of length ${t}`:"")+", got "+(i?`length=${n}`:`type=${typeof e}`));return e}function r7(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function ie(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?r8:BigInt("0x"+e)}function it(e){return e2(e),ie(to(Uint8Array.from(e).reverse()))}function ir(e,t){return tl(e.toString(16).padStart(2*t,"0"))}function ii(e,t){return ir(e,t).reverse()}function is(e,t,r){let i;if("string"==typeof t)try{i=tl(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(e0(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}let io=e=>"bigint"==typeof e&&r8<=e;function ia(e,t,r,i){if(!(io(t)&&io(r)&&io(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function ic(e){let t;for(t=0;e>r8;e>>=r3,t+=1);return t}let il=e=>(r3<<BigInt(e))-r3;function iu(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){let n=e[t];if(i&&void 0===n)return;let s=typeof n;if(s!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function ih(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let s=e(r,...i);return t.set(r,s),s}}let id=BigInt(0),ip=BigInt(1),ig=BigInt(2),iy=BigInt(3),ib=BigInt(4),im=BigInt(5),iw=BigInt(7),iv=BigInt(8),iE=BigInt(9),ix=BigInt(16);function iI(e,t){let r=e%t;return r>=id?r:t+r}function iS(e,t,r){let i=e;for(;t-- >id;)i*=i,i%=r;return i}function iO(e,t){if(e===id)throw Error("invert: expected non-zero number");if(t<=id)throw Error("invert: expected positive modulus, got "+t);let r=iI(e,t),i=t,n=id,s=ip;for(;r!==id;){let e=i/r,t=i%r,o=n-s*e;i=r,r=t,n=s,s=o}if(i!==ip)throw Error("invert: does not exist");return iI(n,t)}function i_(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function iP(e,t){let r=(e.ORDER+ip)/ib,i=e.pow(t,r);return i_(e,i,t),i}function iA(e,t){let r=(e.ORDER-im)/iv,i=e.mul(t,ig),n=e.pow(i,r),s=e.mul(t,n),o=e.mul(e.mul(s,ig),n),a=e.mul(s,e.sub(o,e.ONE));return i_(e,a,t),a}function iD(e){if(e<iy)throw Error("sqrt is not defined for small field");let t=e-ip,r=0;for(;t%ig===id;)t/=ig,r++;let i=ig,n=iT(e);for(;1===iB(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return iP;let s=n.pow(i,t),o=(t+ip)/ig;return function(e,i){if(e.is0(i))return i;if(1!==iB(e,i))throw Error("Cannot find square root");let n=r,a=e.mul(e.ONE,s),c=e.pow(i,t),l=e.pow(i,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");let i=ip<<BigInt(n-t-1),s=e.pow(a,i);n=t,a=e.sqr(s),c=e.mul(c,a),l=e.mul(l,s)}return l}}let iR=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function iC(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),s=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),s),i}function iB(e,t){let r=(e.ORDER-ip)/ig,i=e.pow(t,r),n=e.eql(i,e.ONE),s=e.eql(i,e.ZERO),o=e.eql(i,e.neg(e.ONE));if(!n&&!s&&!o)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function iU(e,t){void 0!==t&&e1(t);let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function iT(e,t,r=!1,i={}){let n;if(e<=id)throw Error("invalid field: expected ORDER > 0, got "+e);let s,o,a=!1,c;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(s=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(a=t.modFromBytes),c=t.allowedLengths}else"number"==typeof t&&(s=t),i.sqrt&&(o=i.sqrt);let{nBitLength:l,nByteLength:u}=iU(e,s);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:e,isLE:r,BITS:l,BYTES:u,MASK:il(l),ZERO:id,ONE:ip,allowedLengths:c,create:t=>iI(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return id<=t&&t<e},is0:e=>e===id,isValidNot0:e=>!h.is0(e)&&h.isValid(e),isOdd:e=>(e&ip)===ip,neg:t=>iI(-t,e),eql:(e,t)=>e===t,sqr:t=>iI(t*t,e),add:(t,r)=>iI(t+r,e),sub:(t,r)=>iI(t-r,e),mul:(t,r)=>iI(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<id)throw Error("invalid exponent, negatives unsupported");if(r===id)return e.ONE;if(r===ip)return t;let i=e.ONE,n=t;for(;r>id;)r&ip&&(i=e.mul(i,n)),n=e.sqr(n),r>>=ip;return i})(h,e,t),div:(t,r)=>iI(t*iO(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>iO(t,e),sqrt:o||(t=>(n||(n=e%ib===iy?iP:e%iv===im?iA:e%ix===iE?function(e){let t=iT(e),r=iD(e),i=r(t,t.neg(t.ONE)),n=r(t,i),s=r(t,t.neg(i)),o=(e+iw)/ix;return(e,t)=>{let r=e.pow(t,o),a=e.mul(r,i),c=e.mul(r,n),l=e.mul(r,s),u=e.eql(e.sqr(a),t),h=e.eql(e.sqr(c),t);r=e.cmov(r,a,u),a=e.cmov(l,c,h);let f=e.eql(e.sqr(a),t),d=e.cmov(r,a,f);return i_(e,d,t),d}}(e):iD(e)),n(h,t))),toBytes:e=>r?ii(e,u):ir(e,u),fromBytes:(t,i=!0)=>{if(c){if(!c.includes(t.length)||t.length>u)throw Error("Field.fromBytes: expected "+c+" bytes, got "+t.length);let e=new Uint8Array(u);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+t.length);let n=r?it(t):ie(to(t));if(a&&(n=iI(n,e)),!i&&!h.isValid(n))throw Error("invalid field element: outside of range 0..ORDER");return n},invertBatch:e=>iC(h,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(h)}function iN(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function ik(e){let t=iN(e);return t+Math.ceil(t/2)}let ij=BigInt(0),iL=BigInt(1);function i$(e,t){let r=t.negate();return e?r:t}function iM(e,t){let r=iC(e.Fp,t.map(e=>e.Z));return t.map((t,i)=>e.fromAffine(t.toAffine(r[i])))}function iz(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function iq(e,t){iz(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:il(e),maxNumber:n,shiftBy:BigInt(e)}}function iF(e,t,r){let{windowSize:i,mask:n,maxNumber:s,shiftBy:o}=r,a=Number(e&n),c=e>>o;a>i&&(a-=s,c+=iL);let l=t*i;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}let iV=new WeakMap,iK=new WeakMap;function iH(e){return iK.get(e)||1}function iG(e){if(e!==ij)throw Error("invalid wNAF")}class iW{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>ij;)t&iL&&(r=r.add(i)),i=i.double(),t>>=iL;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=iq(t,this.bits),n=[],s=e,o=s;for(let e=0;e<r;e++){o=s,n.push(o);for(let e=1;e<i;e++)o=o.add(s),n.push(o);s=o.double()}return n}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,n=this.BASE,s=iq(e,this.bits);for(let e=0;e<s.windows;e++){let{nextN:o,offset:a,isZero:c,isNeg:l,isNegF:u,offsetF:h}=iF(r,e,s);r=o,c?n=n.add(i$(u,t[h])):i=i.add(i$(l,t[a]))}return iG(r),{p:i,f:n}}wNAFUnsafe(e,t,r,i=this.ZERO){let n=iq(e,this.bits);for(let e=0;e<n.windows&&r!==ij;e++){let{nextN:s,offset:o,isZero:a,isNeg:c}=iF(r,e,n);if(r=s,!a){let e=t[o];i=i.add(c?e.negate():e)}}return iG(r),i}getPrecomputes(e,t,r){let i=iV.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),iV.set(t,i))),i}cached(e,t,r){let i=iH(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let n=iH(e);return 1===n?this._unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)}createCache(e,t){iz(t,this.bits),iK.set(e,t),iV.delete(e)}hasCache(e){return 1!==iH(e)}}function iJ(e,t,r){if(!t)return iT(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return iu(t,iR.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}BigInt(0),BigInt(1),BigInt(2),BigInt(8),tu("HashToScalar-");let iZ=BigInt(0),iY=BigInt(1),iQ=BigInt(2),iX=BigInt(1),i0=BigInt(2),i1=BigInt(3),i2=BigInt(5),i5=BigInt(8),i6=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed");function i8(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}let i3=iT({p:i6,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:i5,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}.p,{isLE:!0}),i4=(()=>{let e=i3.ORDER;return function(e){let{P:t,type:r,adjustScalarBytes:i,powPminus2:n,randomBytes:s}=(iu(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})),o="x25519"===r;if(!o&&"x448"!==r)throw Error("invalid type");let a=s||tg,c=o?255:448,l=o?32:56,u=BigInt(o?9:5),h=BigInt(o?121665:39081),f=o?iQ**BigInt(254):iQ**BigInt(447),d=f+(o?BigInt(8)*iQ**BigInt(251)-iY:BigInt(4)*iQ**BigInt(445)-iY)+iY,p=e=>iI(e,t),g=ii(p(u),l);function y(e,r){let s=function(e,r){ia("u",e,iZ,t),ia("scalar",r,f,d);let i=iY,s=iZ,o=e,a=iY,l=iZ;for(let t=BigInt(c-1);t>=iZ;t--){let n=r>>t&iY;l^=n,({x_2:i,x_3:o}=m(l,i,o)),({x_2:s,x_3:a}=m(l,s,a)),l=n;let c=i+s,u=p(c*c),f=i-s,d=p(f*f),g=u-d,y=o+a,b=p((o-a)*c),w=p(y*f),v=b+w,E=b-w;o=p(v*v),a=p(e*p(E*E)),i=p(u*d),s=p(g*(u+p(h*g)))}return{x_2:i,x_3:o}=m(l,i,o),{x_2:s,x_3:a}=m(l,s,a),p(i*n(s))}(function(e){let t=is("u coordinate",e,l);return o&&(t[31]&=127),p(it(t))}(r),it(i(is("scalar",e,l))));if(s===iZ)throw Error("invalid private or public key received");return ii(p(s),l)}function b(e){return y(e,g)}function m(e,t,r){let i=p(e*(t-r));return{x_2:t=p(t-i),x_3:r=p(r+i)}}let w={secretKey:l,publicKey:l,seed:l},v=(e=a(l))=>(e2(e,w.seed),e);return{keygen:function(e){let t=v(e);return{secretKey:t,publicKey:b(t)}},getSharedSecret:(e,t)=>y(e,t),getPublicKey:e=>b(e),scalarMult:y,scalarMultBase:b,utils:{randomSecretKey:v,randomPrivateKey:v},GuBytes:g.slice(),lengths:w}}({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:r,b2:i}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=e*e%i6*e%i6,o=iS(s,i0,i6)*s%i6,a=iS(o,iX,i6)*e%i6,c=iS(a,i2,i6)*a%i6,l=iS(c,t,i6)*c%i6,u=iS(l,r,i6)*l%i6,h=iS(u,i,i6)*u%i6,f=iS(h,n,i6)*h%i6,d=iS(f,n,i6)*h%i6,p=iS(d,t,i6)*c%i6;return{pow_p_5_8:iS(p,i0,i6)*e%i6,b2:s}}(t);return iI(iS(r,i1,e)*i,e)},adjustScalarBytes:i8})})(),i9=(e,t)=>(e+(e>=0?t:-t)/ns)/t;function i7(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function ne(e,t){let r={};for(let i of Object.keys(t))r[i]=void 0===e[i]?t[i]:e[i];return r4(r.lowS,"lowS"),r4(r.prehash,"prehash"),void 0!==r.format&&i7(r.format),r}class nt extends Error{constructor(e=""){super(e)}}let nr={Err:nt,_tlv:{encode:(e,t)=>{let{Err:r}=nr;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=r7(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let s=i>127?r7(n.length/2|128):"";return r7(e)+s+n+t},decode(e,t){let{Err:r}=nr,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],s=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let o=t.subarray(i,i+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of o)s=s<<8|e;if(i+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;let o=t.subarray(i,i+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(i+s)}}},_int:{encode(e){let{Err:t}=nr;if(e<ni)throw new t("integer: negative integers are not allowed");let r=r7(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=nr;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return ie(to(e))}},toSig(e){let{Err:t,_int:r,_tlv:i}=nr,n=is("signature",e),{v:s,l:o}=i.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=i.decode(2,s),{v:l,l:u}=i.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=nr,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},ni=BigInt(0),nn=BigInt(1),ns=BigInt(2),no=BigInt(3),na=BigInt(4);function nc(e,t){let r;let{BYTES:i}=e;if("bigint"==typeof t)r=t;else{let n=is("private key",t);try{r=e.fromBytes(n)}catch{throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function nl(e){return Uint8Array.of(e?2:3)}function nu(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function nh(e,t){let r=t=>(function(e){let{CURVE:t,curveOpts:r,hash:i,ecdsaOpts:n}=function(e){let{CURVE:t,curveOpts:r}=function(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,i=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,n={Fp:r,Fn:iT(t.n,{BITS:e.nBitLength,allowedLengths:i,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:n}}(e),i={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:i}}(e);return function(e,t){let r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,iU(r.Fn.ORDER,r.Fn.BITS))})}(e,function(e,t,r={}){e5(t),iu(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let i=r.randomBytes||tg,n=r.hmac||((e,...r)=>r1(t,e,tf(...r))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:c}=o,{keygen:l,getPublicKey:u,getSharedSecret:h,utils:f,lengths:d}=function(e,t={}){let{Fn:r}=e,i=t.randomBytes||tg,n=Object.assign(nu(e.Fp,r),{seed:ik(r.ORDER)});function s(e){try{return!!nc(r,e)}catch{return!1}}function o(e=i(n.seed)){return function(e,t,r=!1){let i=e.length,n=iN(t),s=ik(t);if(i<16||i<s||i>1024)throw Error("expected "+s+"-1024 bytes of input, got "+i);let o=iI(r?it(e):ie(to(e)),t-ip)+ip;return r?ii(o,n):ir(o,n)}(r9(e,n.seed,"seed"),r.ORDER)}function a(t,i=!0){return e.BASE.multiply(nc(r,t)).toBytes(i)}function c(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:i,publicKey:s,publicKeyUncompressed:o}=n;if(r.allowedLengths||i===s)return;let a=is("key",t).length;return a===s||a===o}return Object.freeze({getPublicKey:a,getSharedSecret:function(t,i,n=!0){if(!0===c(t))throw Error("first arg must be private key");if(!1===c(i))throw Error("second arg must be public key");let s=nc(r,t);return e.fromHex(i).multiply(s).toBytes(n)},keygen:function(e){let t=o(e);return{secretKey:t,publicKey:a(t)}},Point:e,utils:{isValidSecretKey:s,isValidPublicKey:function(t,r){let{publicKey:i,publicKeyUncompressed:s}=n;try{let n=t.length;return(!0!==r||n===i)&&(!1!==r||n===s)&&!!e.fromBytes(t)}catch{return!1}},randomSecretKey:o,isValidPrivateKey:s,randomPrivateKey:o,normPrivateKeyToScalar:e=>nc(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:n})}(e,r),p={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},g="compact";function y(e,t){if(!o.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class b{constructor(e,t,r){this.r=y("r",e),this.s=y("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=g){let r;if(!function(e,t){i7(t);let r=d.signature;r9(e,"compact"===t?r:"recovered"===t?r+1:void 0,`${t} signature`)}(e,t),"der"===t){let{r:t,s:r}=nr.toSig(r9(e));return new b(t,r)}"recovered"===t&&(r=e[0],t="compact",e=e.subarray(1));let i=o.BYTES,n=e.subarray(0,i),s=e.subarray(i,2*i);return new b(o.fromBytes(n),o.fromBytes(s),r)}static fromHex(e,t){return this.fromBytes(tl(e),t)}addRecoveryBit(e){return new b(this.r,this.s,e)}recoverPublicKey(t){let r=s.ORDER,{r:i,s:n,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");if(a*ns<r&&c>1)throw Error("recovery id is ambiguous for h>1 curve");let l=2===c||3===c?i+a:i;if(!s.isValid(l))throw Error("recovery id 2 or 3 invalid");let u=s.toBytes(l),h=e.fromBytes(tf(nl((1&c)==0),u)),f=o.inv(l),d=w(is("msgHash",t)),p=o.create(-d*f),g=o.create(n*f),y=e.BASE.multiplyUnsafe(p).add(h.multiplyUnsafe(g));if(y.is0())throw Error("point at infinify");return y.assertValidity(),y}hasHighS(){return this.s>a>>nn}toBytes(e=g){if(i7(e),"der"===e)return tl(nr.hexFromSig(this));let t=o.toBytes(this.r),r=o.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return tf(Uint8Array.of(this.recovery),t,r)}return tf(t,r)}toHex(e){return to(this.toBytes(e))}assertValidity(){}static fromCompact(e){return b.fromBytes(is("sig",e),"compact")}static fromDER(e){return b.fromBytes(is("sig",e),"der")}normalizeS(){return this.hasHighS()?new b(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return to(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return to(this.toBytes("compact"))}}let m=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=ie(to(e)),r=8*e.length-c;return r>0?t>>BigInt(r):t},w=r.bits2int_modN||function(e){return o.create(m(e))},v=il(c);function E(e){return ia("num < 2^"+c,e,ni,v),o.toBytes(e)}function x(e,r){return r9(e,void 0,"message"),r?r9(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:l,getPublicKey:u,getSharedSecret:h,utils:f,lengths:d,Point:e,sign:function(r,s,c={}){let{seed:l,k2sig:u}=function(t,r,n){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{lowS:s,prehash:c,extraEntropy:l}=ne(n,p),u=w(t=x(t,c)),h=nc(o,r),f=[E(h),E(u)];if(null!=l&&!1!==l){let e=!0===l?i(d.secretKey):l;f.push(is("extraEntropy",e))}return{seed:tf(...f),k2sig:function(t){let r=m(t);if(!o.isValidNot0(r))return;let i=o.inv(r),n=e.BASE.multiply(r).toAffine(),c=o.create(n.x);if(c===ni)return;let l=o.create(i*o.create(u+c*h));if(l===ni)return;let f=(n.x===c?0:2)|Number(n.y&nn),d=l;return s&&l>a>>nn&&(d=o.neg(l),f^=1),new b(c,d,f)}}}(r=is("message",r),s,c);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=e=>new Uint8Array(e),n=e=>Uint8Array.of(e),s=i(e),o=i(e),a=0,c=()=>{s.fill(1),o.fill(0),a=0},l=(...e)=>r(o,s,...e),u=(e=i(0))=>{o=l(n(0),e),s=l(),0!==e.length&&(o=l(n(1),e),s=l())},h=()=>{if(a++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(s=l()).slice();r.push(t),e+=s.length}return tf(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(h()));)u();return c(),r}})(t.outputLen,o.BYTES,n)(l,u)},verify:function(t,r,i,n={}){let{lowS:s,prehash:a,format:c}=ne(n,p);if(i=is("publicKey",i),r=x(is("message",r),a),"strict"in n)throw Error("options.strict was renamed to lowS");let l=void 0===c?function(e){let t;let r="string"==typeof e||e0(e),i=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!i)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(i)t=new b(e.r,e.s);else if(r){try{t=b.fromBytes(is("sig",e),"der")}catch(e){if(!(e instanceof nr.Err))throw e}if(!t)try{t=b.fromBytes(is("sig",e),"compact")}catch{return!1}}return t||!1}(t):b.fromBytes(is("sig",t),c);if(!1===l)return!1;try{let t=e.fromBytes(i);if(s&&l.hasHighS())return!1;let{r:n,s:a}=l,c=w(r),u=o.inv(a),h=o.create(c*u),f=o.create(n*u),d=e.BASE.multiplyUnsafe(h).add(t.multiplyUnsafe(f));return!d.is0()&&o.create(d.x)===n}catch{return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:i}=ne(r,p);return t=x(t,i),b.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:b,hash:t})}(function(e,t={}){let r=function(e,t,r={},i){if(void 0===i&&(i="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>ij))throw Error(`CURVE.${e} must be positive bigint`)}let n=iJ(t.p,r.Fp,i),s=iJ(t.n,r.Fn,i);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!n.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:n,Fn:s}}("weierstrass",e,t),{Fp:i,Fn:n}=r,s=r.CURVE,{h:o,n:a}=s;iu(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:c}=t;if(c&&(!i.is0(s.a)||"bigint"!=typeof c.beta||!Array.isArray(c.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let l=nu(i,n);function u(){if(!i.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let h=t.toBytes||function(e,t,r){let{x:n,y:s}=t.toAffine(),o=i.toBytes(n);return(r4(r,"isCompressed"),r)?(u(),tf(nl(!i.isOdd(s)),o)):tf(Uint8Array.of(4),o,i.toBytes(s))},f=t.fromBytes||function(e){r9(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=l,n=e.length,s=e[0],o=e.subarray(1);if(n===t&&(2===s||3===s)){let e;let t=i.fromBytes(o);if(!i.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=d(t);try{e=i.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return u(),(1&s)==1!==i.isOdd(e)&&(e=i.neg(e)),{x:t,y:e}}if(n===r&&4===s){let e=i.BYTES,t=i.fromBytes(o.subarray(0,e)),r=i.fromBytes(o.subarray(e,2*e));if(!p(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${n}, expected compressed=${t} or uncompressed=${r}`)};function d(e){let t=i.sqr(e),r=i.mul(t,e);return i.add(i.add(r,i.mul(e,s.a)),s.b)}function p(e,t){let r=i.sqr(t),n=d(e);return i.eql(r,n)}if(!p(s.Gx,s.Gy))throw Error("bad curve params: generator point");let g=i.mul(i.pow(s.a,no),na),y=i.mul(i.sqr(s.b),BigInt(27));if(i.is0(i.add(g,y)))throw Error("bad curve params: a or b");function b(e,t,r=!1){if(!i.isValid(t)||r&&i.is0(t))throw Error(`bad point coordinate ${e}`);return t}function m(e){if(!(e instanceof I))throw Error("ProjectivePoint expected")}function w(e){if(!c||!c.basises)throw Error("no endo");return function(e,t,r){let[[i,n],[s,o]]=t,a=i9(o*e,r),c=i9(-n*e,r),l=e-a*i-c*s,u=-a*n-c*o,h=l<ni,f=u<ni;h&&(l=-l),f&&(u=-u);let d=il(Math.ceil(ic(r)/2))+nn;if(l<ni||l>=d||u<ni||u>=d)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:h,k1:l,k2neg:f,k2:u}}(e,c.basises,n.ORDER)}let v=ih((e,t)=>{let{X:r,Y:n,Z:s}=e;if(i.eql(s,i.ONE))return{x:r,y:n};let o=e.is0();null==t&&(t=o?i.ONE:i.inv(s));let a=i.mul(r,t),c=i.mul(n,t),l=i.mul(s,t);if(o)return{x:i.ZERO,y:i.ZERO};if(!i.eql(l,i.ONE))throw Error("invZ was invalid");return{x:a,y:c}}),E=ih(e=>{if(e.is0()){if(t.allowInfinityPoint&&!i.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:n}=e.toAffine();if(!i.isValid(r)||!i.isValid(n))throw Error("bad point: x or y not field elements");if(!p(r,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function x(e,t,r,n,s){return r=new I(i.mul(r.X,e),r.Y,r.Z),t=i$(n,t),r=i$(s,r),t.add(r)}class I{constructor(e,t,r){this.X=b("x",e),this.Y=b("y",t,!0),this.Z=b("z",r),Object.freeze(this)}static CURVE(){return s}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof I)throw Error("projective point not allowed");return i.is0(t)&&i.is0(r)?I.ZERO:new I(t,r,i.ONE)}static fromBytes(e){let t=I.fromAffine(f(r9(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return I.fromBytes(is("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return O.createCache(this,e),t||this.multiply(no),this}assertValidity(){E(this)}hasEvenY(){let{y:e}=this.toAffine();if(!i.isOdd)throw Error("Field doesn't support isOdd");return!i.isOdd(e)}equals(e){m(e);let{X:t,Y:r,Z:n}=this,{X:s,Y:o,Z:a}=e,c=i.eql(i.mul(t,a),i.mul(s,n)),l=i.eql(i.mul(r,a),i.mul(o,n));return c&&l}negate(){return new I(this.X,i.neg(this.Y),this.Z)}double(){let{a:e,b:t}=s,r=i.mul(t,no),{X:n,Y:o,Z:a}=this,c=i.ZERO,l=i.ZERO,u=i.ZERO,h=i.mul(n,n),f=i.mul(o,o),d=i.mul(a,a),p=i.mul(n,o);return p=i.add(p,p),u=i.mul(n,a),u=i.add(u,u),c=i.mul(e,u),l=i.mul(r,d),l=i.add(c,l),c=i.sub(f,l),l=i.add(f,l),l=i.mul(c,l),c=i.mul(p,c),u=i.mul(r,u),d=i.mul(e,d),p=i.sub(h,d),p=i.mul(e,p),p=i.add(p,u),u=i.add(h,h),h=i.add(u,h),h=i.add(h,d),h=i.mul(h,p),l=i.add(l,h),d=i.mul(o,a),d=i.add(d,d),h=i.mul(d,p),c=i.sub(c,h),u=i.mul(d,f),u=i.add(u,u),new I(c,l,u=i.add(u,u))}add(e){m(e);let{X:t,Y:r,Z:n}=this,{X:o,Y:a,Z:c}=e,l=i.ZERO,u=i.ZERO,h=i.ZERO,f=s.a,d=i.mul(s.b,no),p=i.mul(t,o),g=i.mul(r,a),y=i.mul(n,c),b=i.add(t,r),w=i.add(o,a);b=i.mul(b,w),w=i.add(p,g),b=i.sub(b,w),w=i.add(t,n);let v=i.add(o,c);return w=i.mul(w,v),v=i.add(p,y),w=i.sub(w,v),v=i.add(r,n),l=i.add(a,c),v=i.mul(v,l),l=i.add(g,y),v=i.sub(v,l),h=i.mul(f,w),l=i.mul(d,y),h=i.add(l,h),l=i.sub(g,h),h=i.add(g,h),u=i.mul(l,h),g=i.add(p,p),g=i.add(g,p),y=i.mul(f,y),w=i.mul(d,w),g=i.add(g,y),y=i.sub(p,y),y=i.mul(f,y),w=i.add(w,y),p=i.mul(g,w),u=i.add(u,p),p=i.mul(v,w),l=i.mul(b,l),l=i.sub(l,p),p=i.mul(b,g),h=i.mul(v,h),new I(l,u,h=i.add(h,p))}subtract(e){return this.add(e.negate())}is0(){return this.equals(I.ZERO)}multiply(e){let r,i;let{endo:s}=t;if(!n.isValidNot0(e))throw Error("invalid scalar: out of range");let o=e=>O.cached(this,e,e=>iM(I,e));if(s){let{k1neg:t,k1:n,k2neg:a,k2:c}=w(e),{p:l,f:u}=o(n),{p:h,f:f}=o(c);i=u.add(f),r=x(s.beta,l,h,t,a)}else{let{p:t,f:n}=o(e);r=t,i=n}return iM(I,[r,i])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!n.isValid(e))throw Error("invalid scalar: out of range");if(e===ni||this.is0())return I.ZERO;if(e===nn)return this;if(O.hasCache(this))return this.multiply(e);if(!r)return O.unsafe(this,e);{let{k1neg:t,k1:i,k2neg:n,k2:s}=w(e),{p1:o,p2:a}=function(e,t,r,i){let n=t,s=e.ZERO,o=e.ZERO;for(;r>ij||i>ij;)r&iL&&(s=s.add(n)),i&iL&&(o=o.add(n)),n=n.double(),r>>=iL,i>>=iL;return{p1:s,p2:o}}(I,this,i,s);return x(r.beta,o,a,t,n)}}multiplyAndAddUnsafe(e,t,r){let i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return v(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return o===nn||(e?e(I,this):O.unsafe(this,a).is0())}clearCofactor(){let{clearCofactor:e}=t;return o===nn?this:e?e(I,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(e=!0){return r4(e,"isCompressed"),this.assertValidity(),h(I,this,e)}toHex(e=!0){return to(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return iM(I,e)}static msm(e,t){return function(e,t,r,i){(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);let n=r.length,s=i.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");let o=e.ZERO,a=ic(BigInt(n)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=il(c),u=Array(Number(l)+1).fill(o),h=Math.floor((t.BITS-1)/c)*c,f=o;for(let e=h;e>=0;e-=c){u.fill(o);for(let t=0;t<s;t++){let n=Number(i[t]>>BigInt(e)&l);u[n]=u[n].add(r[t])}let t=o;for(let e=u.length-1,r=o;e>0;e--)r=r.add(u[e]),t=t.add(r);if(f=f.add(t),0!==e)for(let e=0;e<c;e++)f=f.double()}return f}(I,n,e,t)}static fromPrivateKey(e){return I.BASE.multiply(nc(n,e))}}I.BASE=new I(s.Gx,s.Gy,i.ONE),I.ZERO=new I(i.ZERO,i.ONE,i.ZERO),I.Fp=i,I.Fn=n;let S=n.BITS,O=new iW(I,t.endo?Math.ceil(S/2):S);return I.BASE.precompute(8),I}(t,r),i,n))})({...e,hash:t});return{...r(t),create:r}}let nf={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},nd={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},np={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},ng=iT(nf.p),ny=iT(nd.p),nb=iT(np.p),nm=nh({...nf,Fp:ng,lowS:!1},tW);nh({...nd,Fp:ny,lowS:!1},tZ),nh({...np,Fp:nb,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},tJ);let nw="base10",nv="base16",nE="base64pad",nx="base64url",nI="utf8";function nS(){let e=tg(32);return(0,M.BB)(e,nv)}function nO(e){let t=tW((0,M.mL)(e,nv));return(0,M.BB)(t,nv)}function n_(e){let t=tW((0,M.mL)(e,nI));return(0,M.BB)(t,nv)}function nP(e){return(0,M.mL)(`${e}`,nw)}function nA(e){return Number((0,M.BB)(e,nw))}function nD(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function nR(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function nC(e){if(2===nA(e.type))return(0,M.BB)((0,M.zo)([e.type,e.sealed]),nE);if(1===nA(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,M.BB)((0,M.zo)([e.type,e.senderPublicKey,e.iv,e.sealed]),nE)}return(0,M.BB)((0,M.zo)([e.type,e.iv,e.sealed]),nE)}function nB(e){let t=(e.encoding||nE)===nx?nR(e.encoded):e.encoded,r=(0,M.mL)(t,nE),i=r.slice(0,1);if(1===nA(i)){let e=r.slice(1,33),t=r.slice(33,45);return{type:i,sealed:r.slice(45),iv:t,senderPublicKey:e}}if(2===nA(i))return{type:i,sealed:r.slice(1),iv:tg(12)};let n=r.slice(1,13);return{type:i,sealed:r.slice(13),iv:n}}function nU(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function nT(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function nN(e){return e?.relay||{protocol:"irn"}}function nk(e){let t=z.iO[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}var nj=Object.defineProperty,nL=Object.defineProperties,n$=Object.getOwnPropertyDescriptors,nM=Object.getOwnPropertySymbols,nz=Object.prototype.hasOwnProperty,nq=Object.prototype.propertyIsEnumerable,nF=(e,t,r)=>t in e?nj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,nV=(e,t)=>{for(var r in t||(t={}))nz.call(t,r)&&nF(e,r,t[r]);if(nM)for(var r of nM(t))nq.call(t,r)&&nF(e,r,t[r]);return e},nK=(e,t)=>nL(e,n$(t));function nH(e){var t;if(!e.includes("wc:")){let t=eA(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,r),s=e.substring(r+1,i).split("@"),o=Object.fromEntries(new URLSearchParams("u">typeof i?e.substring(i):"").entries()),a="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:n,topic:(t=s[0]).startsWith("//")?t.substring(2):t,version:parseInt(s[1],10),symKey:o.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let n=t.replace(i,""),s=e[t];r[n]=s}}),r}(o),methods:a,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function nG(e){let t=new URLSearchParams;return Object.entries(nV(nV(nK(nV({},function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")})).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function nW(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var nJ=Object.defineProperty,nZ=Object.defineProperties,nY=Object.getOwnPropertyDescriptors,nQ=Object.getOwnPropertySymbols,nX=Object.prototype.hasOwnProperty,n0=Object.prototype.propertyIsEnumerable,n1=(e,t,r)=>t in e?nJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,n2=(e,t)=>{for(var r in t||(t={}))nX.call(t,r)&&n1(e,r,t[r]);if(nQ)for(var r of nQ(t))n0.call(t,r)&&n1(e,r,t[r]);return e},n5=(e,t)=>nZ(e,nY(t));function n6(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function n8(e){return e.includes(":")}function n3(e){return n8(e)?e.split(":")[0]:e}function n4(e){var t,r,i;let n={};if(!sn(e))return n;for(let[s,o]of Object.entries(e)){let e=n8(s)?[s]:o.chains,a=o.methods||[],c=o.events||[],l=n3(s);n[l]=n5(n2({},n[l]),{chains:ex(e,null==(t=n[l])?void 0:t.chains),methods:ex(a,null==(r=n[l])?void 0:r.methods),events:ex(c,null==(i=n[l])?void 0:i.events)})}return n}function n9(e,t){let r=function(e){let t={};return e?.forEach(e=>{var r;let[i,n]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(r=t[i].chains)||r.push(`${i}:${n}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,i]of Object.entries(r))i.methods?i.methods=ex(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}let n7={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},se={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function st(e,t){let{message:r,code:i}=se[e];return{message:t?`${r} ${t}`:r,code:i}}function sr(e,t){let{message:r,code:i}=n7[e];return{message:t?`${r} ${t}`:r,code:i}}function si(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function sn(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function ss(e){return typeof e>"u"}function so(e,t){return!!(t&&ss(e))||"string"==typeof e&&!!e.trim().length}function sa(e,t){return!!(t&&ss(e))||"number"==typeof e&&!isNaN(e)}function sc(e){return!!(so(e,!1)&&e.includes(":"))&&2===e.split(":").length}function sl(e){let t=!0;return si(e)?e.length&&(t=e.every(e=>so(e,!1))):t=!1,t}function su(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let n;if(r)return;let s=(i=`${t}, namespace`,n=null,sl(e?.methods)?sl(e?.events)||(n=sr("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):n=sr("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),n);s&&(r=s)}),r}function sh(e,t){let r=null;if(e&&sn(e)){let i;let n=su(e,t);n&&(r=n);let s=(i=null,Object.values(e).forEach(e=>{var r,n;let s;if(i)return;let o=(r=e?.accounts,n=`${t} namespace`,s=null,si(r)?r.forEach(e=>{s||function(e){if(so(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&sc(e)}}return!1}(e)||(s=sr("UNSUPPORTED_ACCOUNTS",`${n}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):s=sr("UNSUPPORTED_ACCOUNTS",`${n}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),s);o&&(i=o)}),i);s&&(r=s)}else r=st("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function sf(e){return so(e.protocol,!0)}function sd(e){return"u">typeof e}function sp(e,t){return!(!sc(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...n6(e.accounts))}),t})(e).includes(t))}function sg(e,t,r){let i=null,n=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),s=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=n6(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(n),a=Object.keys(s),c=sy(Object.keys(e)),l=sy(Object.keys(t)),u=c.filter(e=>!l.includes(e));return u.length&&(i=st("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),ef(o,a)||(i=st("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let n=n6(t[e].accounts);n.includes(e)||(i=st("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${n.toString()}`))}),o.forEach(e=>{i||(ef(n[e].methods,s[e].methods)?ef(n[e].events,s[e].events)||(i=st("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=st("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function sy(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function sb(){let e=ec();return new Promise(t=>{switch(e){case en.browser:t(ea()&&navigator?.onLine);break;case en.reactNative:t(sm());break;case en.node:default:t(!0)}})}async function sm(){if(eo()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo){let e=await (null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}let sw={};class sv{static get(e){return sw[e]}static set(e,t){sw[e]=t}static delete(e){delete sw[e]}}function sE(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}var sx=r(96756),sI=r(11248),sS=r(15133),sO=r(58020),s_=Object.defineProperty,sP=(e,t,r)=>t in e?s_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sA=(e,t,r)=>sP(e,"symbol"!=typeof t?t+"":t,r);class sD extends sO.q{constructor(e){super(),this.opts=e,sA(this,"protocol","wc"),sA(this,"version",2)}}var sR=Object.defineProperty,sC=(e,t,r)=>t in e?sR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sB=(e,t,r)=>sC(e,"symbol"!=typeof t?t+"":t,r);class sU extends sO.q{constructor(e,t){super(),this.core=e,this.logger=t,sB(this,"records",new Map)}}class sT{constructor(e,t){this.logger=e,this.core=t}}class sN extends sO.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class sk extends sO.q{constructor(e){super()}}class sj{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class sL extends sO.q{constructor(e,t){super(),this.relayer=e,this.logger=t}}class s$ extends sO.q{constructor(e,t){super(),this.core=e,this.logger=t}}class sM{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class sz{constructor(e,t){this.projectId=e,this.logger=t}}class sq{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var sF=Object.defineProperty,sV=(e,t,r)=>t in e?sF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sK=(e,t,r)=>sV(e,"symbol"!=typeof t?t+"":t,r);class sH{constructor(e){this.opts=e,sK(this,"protocol","wc"),sK(this,"version",2)}}class sG{constructor(e){this.client=e}}var sW=r(80577),sJ=r(38979),sZ=r(5276),sY=r(75646),sQ=r(82957).Buffer,sX=r(25566);let s0="core",s1=`wc@2:${s0}:`,s2={logger:"error"},s5={database:":memory:"},s6="client_ed25519_seed",s8=a.ONE_DAY,s3=a.SIX_HOURS,s4="wss://relay.walletconnect.org",s9={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},s7={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},oe="2.21.9",ot={link_mode:"link_mode",relay:"relay"},or={inbound:"inbound",outbound:"outbound"},oi="WALLETCONNECT_LINK_MODE_APPS",on={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},os=(a.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:a.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:a.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:a.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:a.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:a.ONE_DAY,prompt:!1,tag:0},res:{ttl:a.ONE_DAY,prompt:!1,tag:0}}}),oo={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},oa={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},oc={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ol="https://verify.walletconnect.org",ou=`${ol}/v3`,oh=["https://verify.walletconnect.com",ol],of={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},od={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},op={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session"},og={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},oy={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},ob={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var om=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var s=e.charAt(n),o=s.charCodeAt(0);if(255!==r[o])throw TypeError(s+" is ambiguous");r[o]=n}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,n=0;e[t]===c;)i++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,f=s-1;(0!==u||h<n)&&-1!==f;f--,h++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");n=h,t++}if(" "!==e[t]){for(var d=s-n;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(i+(s-d)),g=i;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,n=0,s=t.length;n!==s&&0===t[n];)n++,r++;for(var o=(s-n)*u+1>>>0,l=new Uint8Array(o);n!==s;){for(var h=t[n],f=0,d=o-1;(0!==h||f<i)&&-1!==d;d--,f++)h+=256*l[d]>>>0,l[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw Error("Non-zero carry");i=f,n++}for(var p=o-i;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw Error(`Non-${t} character`)}}};let ow=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},ov=e=>new TextEncoder().encode(e),oE=e=>new TextDecoder().decode(e);class ox{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class oI{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return oO(this,e)}}class oS{constructor(e){this.decoders=e}or(e){return oO(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let oO=(e,t)=>new oS({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class o_{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new ox(e,t,r),this.decoder=new oI(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let oP=({name:e,prefix:t,encode:r,decode:i})=>new o_(e,t,r,i),oA=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:n}=om(r,t);return oP({prefix:e,name:t,encode:i,decode:e=>ow(n(e))})},oD=(e,t,r,i)=>{let n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,l=0;for(let t=0;t<s;++t){let s=n[e[t]];if(void 0===s)throw SyntaxError(`Non-${i} character`);c=c<<r|s,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},oR=(e,t,r)=>{let i="="===t[t.length-1],n=(1<<r)-1,s="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,s+=t[n&a>>o];if(o&&(s+=t[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},oC=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>oP({prefix:t,name:e,encode:e=>oR(e,i,r),decode:t=>oD(t,i,r,e)});var oB=Object.freeze({__proto__:null,identity:oP({prefix:"\0",name:"identity",encode:e=>oE(e),decode:e=>ov(e)})}),oU=Object.freeze({__proto__:null,base2:oC({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),oT=Object.freeze({__proto__:null,base8:oC({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),oN=Object.freeze({__proto__:null,base10:oA({prefix:"9",name:"base10",alphabet:"0123456789"})}),ok=Object.freeze({__proto__:null,base16:oC({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:oC({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let oj=oC({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),oL=oC({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o$=oC({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oM=oC({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oz=oC({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),oq=oC({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});var oF=Object.freeze({__proto__:null,base32:oj,base32upper:oL,base32pad:o$,base32padupper:oM,base32hex:oz,base32hexupper:oq,base32hexpad:oC({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:oC({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:oC({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),oV=Object.freeze({__proto__:null,base36:oA({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:oA({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),oK=Object.freeze({__proto__:null,base58btc:oA({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:oA({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let oH=oC({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});var oG=Object.freeze({__proto__:null,base64:oH,base64pad:oC({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:oC({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:oC({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let oW=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),oJ=oW.reduce((e,t,r)=>(e[r]=t,e),[]),oZ=oW.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var oY=Object.freeze({__proto__:null,base256emoji:oP({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=oJ[t],"")},decode:function(e){let t=[];for(let r of e){let e=oZ[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function oQ(e,t){var r,i=0,t=t||0,n=0,s=t,o=e.length;do{if(s>=o)throw oQ.bytes=0,RangeError("Could not decode varint");r=e[s++],i+=n<28?(127&r)<<n:(127&r)*Math.pow(2,n),n+=7}while(r>=128);return oQ.bytes=s-t,i}var oX=function e(t,r,i){r=r||[],i=i||0;for(var n=i;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-n+1,r};let o0=(e,t,r=0)=>(oX(e,t,r),t),o1=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,o2=(e,t)=>{let r=t.byteLength,i=o1(e),n=i+o1(r),s=new Uint8Array(n+r);return o0(e,s,0),o0(r,s,i),s.set(t,n),new o5(e,r,t,s)};class o5{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let o6=({name:e,code:t,encode:r})=>new o8(e,t,r);class o8{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?o2(this.code,t):t.then(e=>o2(this.code,e))}throw Error("Unknown type, must be binary type")}}let o3=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var o4=Object.freeze({__proto__:null,sha256:o6({name:"sha2-256",code:18,encode:o3("SHA-256")}),sha512:o6({name:"sha2-512",code:19,encode:o3("SHA-512")})}),o9=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:ow,digest:e=>o2(0,ow(e))}});new TextEncoder,new TextDecoder;let o7={...oB,...oU,...oT,...oN,...ok,...oF,...oV,...oK,...oG,...oY};function ae(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function at(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...o4,...o9});let ar=at("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ai=at("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?ae(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),an={utf8:ar,"utf-8":ar,hex:o7.base16,latin1:ai,ascii:ai,binary:ai,...o7};var as=Object.defineProperty,ao=(e,t,r)=>t in e?as(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aa=(e,t,r)=>ao(e,"symbol"!=typeof t?t+"":t,r);class ac{constructor(e,t){this.core=e,this.logger=t,aa(this,"keychain",new Map),aa(this,"name","keychain"),aa(this,"version","0.3"),aa(this,"initialized",!1),aa(this,"storagePrefix",s1),aa(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),aa(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),aa(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),aa(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=st("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),aa(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,sS.Ep)(t,this.name)}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ed(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ep(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var al=Object.defineProperty,au=(e,t,r)=>t in e?al(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ah=(e,t,r)=>au(e,"symbol"!=typeof t?t+"":t,r);class af{constructor(e,t,r){this.core=e,this.logger=t,ah(this,"name","crypto"),ah(this,"keychain"),ah(this,"randomSessionIdentifier",nS()),ah(this,"initialized",!1),ah(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),ah(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),ah(this,"getClientId",async()=>{this.isInitialized();let e=await this.getClientSeed(),t=$.Au(e);return $.bG(t.publicKey)}),ah(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=i4.utils.randomPrivateKey(),t=i4.getPublicKey(e);return{privateKey:(0,M.BB)(e,nv),publicKey:(0,M.BB)(t,nv)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),ah(this,"signJWT",async e=>{this.isInitialized();let t=await this.getClientSeed(),r=$.Au(t),i=this.randomSessionIdentifier;return await $.vf(i,e,s8,r)}),ah(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=r6(tW,i4.getSharedSecret((0,M.mL)(e,nv),(0,M.mL)(t,nv)),void 0,void 0,32);return(0,M.BB)(r,nv)}(this.getPrivateKey(e),t);return this.setSymKey(i,r)}),ah(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||nO(e);return await this.keychain.set(r,e),r}),ah(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),ah(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),ah(this,"encode",async(e,t,r)=>{this.isInitialized();let i=nU(r),n=(0,sW.safeJsonStringify)(t);if(2===i.type)return function(e,t){let r=nP(2),i=tg(12),n=nC({type:r,sealed:(0,M.mL)(e,nI),iv:i});return t===nx?nD(n):n}(n,r?.encoding);if(nT(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let s=this.getSymKey(e),{type:o,senderPublicKey:a}=i;return function(e){let t=nP("u">typeof e.type?e.type:0);if(1===nA(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let r="u">typeof e.senderPublicKey?(0,M.mL)(e.senderPublicKey,nv):void 0,i="u">typeof e.iv?(0,M.mL)(e.iv,nv):tg(12),n=nC({type:t,sealed:rX((0,M.mL)(e.symKey,nv),i).encrypt((0,M.mL)(e.message,nI)),iv:i,senderPublicKey:r});return e.encoding===nx?nD(n):n}({type:o,symKey:s,message:n,senderPublicKey:a,encoding:r?.encoding})}),ah(this,"decode",async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=nB({encoded:e,encoding:t?.encoding});return nU({type:nA(r.type),senderPublicKey:"u">typeof r.senderPublicKey?(0,M.BB)(r.senderPublicKey,nv):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type){let e=function(e,t){let{sealed:r}=nB({encoded:e,encoding:t});return(0,M.BB)(r,nI)}(t,r?.encoding);return(0,sW.safeJsonParse)(e)}if(nT(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),n=function(e){let t=(0,M.mL)(e.symKey,nv),{sealed:r,iv:i}=nB({encoded:e.encoded,encoding:e.encoding}),n=rX(t,i).decrypt(r);if(null===n)throw Error("Failed to decrypt");return(0,M.BB)(n,nI)}({symKey:i,encoded:t,encoding:r?.encoding});return(0,sW.safeJsonParse)(n)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),ah(this,"getPayloadType",(e,t=nE)=>nA(nB({encoded:e,encoding:t}).type)),ah(this,"getPayloadSenderPublicKey",(e,t=nE)=>{let r=nB({encoded:e,encoding:t});return r.senderPublicKey?(0,M.BB)(r.senderPublicKey,nv):void 0}),this.core=e,this.logger=(0,sS.Ep)(t,this.name),this.keychain=r||new ac(this.core,this.logger)}get context(){return(0,sS.Fd)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(s6)}catch{e=nS(),await this.keychain.set(s6,e)}return function(e,t="utf8"){let r=an[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?ae(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var ad=Object.defineProperty,ap=Object.defineProperties,ag=Object.getOwnPropertyDescriptors,ay=Object.getOwnPropertySymbols,ab=Object.prototype.hasOwnProperty,am=Object.prototype.propertyIsEnumerable,aw=(e,t,r)=>t in e?ad(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,av=(e,t)=>{for(var r in t||(t={}))ab.call(t,r)&&aw(e,r,t[r]);if(ay)for(var r of ay(t))am.call(t,r)&&aw(e,r,t[r]);return e},aE=(e,t)=>ap(e,ag(t)),ax=(e,t,r)=>aw(e,"symbol"!=typeof t?t+"":t,r);class aI extends sT{constructor(e,t){super(e,t),this.logger=e,this.core=t,ax(this,"messages",new Map),ax(this,"messagesWithoutClientAck",new Map),ax(this,"name","messages"),ax(this,"version","0.3"),ax(this,"initialized",!1),ax(this,"storagePrefix",s1),ax(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),ax(this,"set",async(e,t,r)=>{this.isInitialized();let i=n_(t),n=this.messages.get(e);if(typeof n>"u"&&(n={}),"u">typeof n[i])return i;if(n[i]=t,this.messages.set(e,n),r===or.inbound){let r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,aE(av({},r),{[i]:t}))}return await this.persist(),i}),ax(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),ax(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let r of e){let e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),ax(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[n_(t)])),ax(this,"ack",async(e,t)=>{this.isInitialized();let r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;let i=n_(t);delete r[i],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),ax(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=(0,sS.Ep)(e,this.name),this.core=t}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ed(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,ed(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ep(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?ep(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var aS=Object.defineProperty,aO=Object.defineProperties,a_=Object.getOwnPropertyDescriptors,aP=Object.getOwnPropertySymbols,aA=Object.prototype.hasOwnProperty,aD=Object.prototype.propertyIsEnumerable,aR=(e,t,r)=>t in e?aS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aC=(e,t)=>{for(var r in t||(t={}))aA.call(t,r)&&aR(e,r,t[r]);if(aP)for(var r of aP(t))aD.call(t,r)&&aR(e,r,t[r]);return e},aB=(e,t)=>aO(e,a_(t)),aU=(e,t,r)=>aR(e,"symbol"!=typeof t?t+"":t,r);class aT extends sN{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,aU(this,"events",new n.EventEmitter),aU(this,"name","publisher"),aU(this,"queue",new Map),aU(this,"publishTimeout",(0,a.toMiliseconds)(a.ONE_MINUTE)),aU(this,"initialPublishTimeout",(0,a.toMiliseconds)(15*a.ONE_SECOND)),aU(this,"needsTransportRestart",!1),aU(this,"publish",async(e,t,r)=>{var i,n,s,o,a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let c=r?.ttl||s3,l=r?.prompt||!1,u=r?.tag||0,h=r?.id||(0,sZ.getBigIntRpcId)().toString(),f=nk(nN().protocol),d={id:h,method:r?.publishMethod||f.publish,params:aC({topic:e,message:t,ttl:c,prompt:l,tag:u,attestation:r?.attestation},r?.tvf)},p=`Failed to publish payload, please try again. id:${h} tag:${u}`;try{ss(null==(i=d.params)?void 0:i.prompt)&&(null==(n=d.params)||delete n.prompt),ss(null==(s=d.params)?void 0:s.tag)&&(null==(o=d.params)||delete o.tag);let a=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=d.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(s9.publish,t),e())};this.relayer.events.on(s9.publish,t);let i=ey(new Promise((e,t)=>{this.rpcPublish(d,r).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${h} tag:${u}`);try{await i,this.events.removeListener(s9.publish,t)}catch(e){this.queue.set(h,{request:d,opts:r,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:h,topic:e,message:t,opts:r}}),await ey(a,this.publishTimeout,p)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(a=r?.internal)&&a.throwOnFailedPublish)throw e}finally{this.queue.delete(h)}}),aU(this,"publishCustom",async e=>{var t,r,i,n,s;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:e});let{payload:o,opts:c={}}=e,{attestation:l,tvf:u,publishMethod:h,prompt:f,tag:d,ttl:p=a.FIVE_MINUTES}=c,g=c.id||(0,sZ.getBigIntRpcId)().toString(),y=nk(nN().protocol),b=h||y.publish,m={id:g,method:b,params:aC(aB(aC({},o),{ttl:p,prompt:f,tag:d,attestation:l}),u)},w=`Failed to publish custom payload, please try again. id:${g} tag:${d}`;try{ss(null==(t=m.params)?void 0:t.prompt)&&(null==(r=m.params)||delete r.prompt),ss(null==(i=m.params)?void 0:i.tag)&&(null==(n=m.params)||delete n.tag);let e=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=m.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(s9.publish,t),e())};this.relayer.events.on(s9.publish,t);let r=ey(new Promise((e,t)=>{this.rpcPublish(m,c).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${b} id:${g} tag:${d}`);try{await r,this.events.removeListener(s9.publish,t)}catch(e){this.queue.set(g,{request:m,opts:c,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:g,payload:o,opts:c}}),await ey(e,this.publishTimeout,w)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(s=c?.internal)&&s.throwOnFailedPublish)throw e}finally{this.queue.delete(g)}}),aU(this,"on",(e,t)=>{this.events.on(e,t)}),aU(this,"once",(e,t)=>{this.events.once(e,t)}),aU(this,"off",(e,t)=>{this.events.off(e,t)}),aU(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,sS.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,sS.Fd)(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});let r=await this.relayer.request(e);return this.relayer.events.emit(s9.publish,aC(aC({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;let i=e.attempt+1;this.queue.set(t,aB(aC({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${null==(r=e.request.params)?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(sx.Lx.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(s9.connection_stalled);return}this.checkQueue()}),this.relayer.on(s9.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var aN=Object.defineProperty,ak=(e,t,r)=>t in e?aN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aj=(e,t,r)=>ak(e,"symbol"!=typeof t?t+"":t,r);class aL{constructor(){aj(this,"map",new Map),aj(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),aj(this,"get",e=>this.map.get(e)||[]),aj(this,"exists",(e,t)=>this.get(e).includes(t)),aj(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),aj(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var a$=Object.defineProperty,aM=Object.defineProperties,az=Object.getOwnPropertyDescriptors,aq=Object.getOwnPropertySymbols,aF=Object.prototype.hasOwnProperty,aV=Object.prototype.propertyIsEnumerable,aK=(e,t,r)=>t in e?a$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aH=(e,t)=>{for(var r in t||(t={}))aF.call(t,r)&&aK(e,r,t[r]);if(aq)for(var r of aq(t))aV.call(t,r)&&aK(e,r,t[r]);return e},aG=(e,t)=>aM(e,az(t)),aW=(e,t,r)=>aK(e,"symbol"!=typeof t?t+"":t,r);class aJ extends sL{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,aW(this,"subscriptions",new Map),aW(this,"topicMap",new aL),aW(this,"events",new n.EventEmitter),aW(this,"name","subscription"),aW(this,"version","0.3"),aW(this,"pending",new Map),aW(this,"cached",[]),aW(this,"initialized",!1),aW(this,"storagePrefix",s1),aW(this,"subscribeTimeout",(0,a.toMiliseconds)(a.ONE_MINUTE)),aW(this,"initialSubscribeTimeout",(0,a.toMiliseconds)(15*a.ONE_SECOND)),aW(this,"clientId"),aW(this,"batchSubscribeTopicsLimit",500),aW(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),aW(this,"subscribe",async(e,t)=>{var r;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let i=nN(t),n={topic:e,relay:i,transportType:t?.transportType};null!=(r=t?.internal)&&r.skipSubscribe||this.pending.set(e,n);let s=await this.rpcSubscribe(e,i,t);return"string"==typeof s&&(this.onSubscribe(s,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),aW(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),aW(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),aW(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),aW(this,"on",(e,t)=>{this.events.on(e,t)}),aW(this,"once",(e,t)=>{this.events.once(e,t)}),aW(this,"off",(e,t)=>{this.events.off(e,t)}),aW(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),aW(this,"start",async()=>{await this.onConnect()}),aW(this,"stop",async()=>{await this.onDisconnect()}),aW(this,"restart",async()=>{await this.restore(),await this.onRestart()}),aW(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),aW(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(sx.Lx.pulse,async()=>{await this.checkPending()}),this.events.on(on.created,async e=>{let t=on.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(on.deleted,async e=>{let t=on.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,sS.Ep)(t,this.name),this.clientId=""}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=nN(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let n=sr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i,n;let s=await this.getSubscriptionId(e);if(null!=(i=r?.internal)&&i.skipSubscribe)return s;r&&r?.transportType!==ot.relay||await this.restartToComplete({topic:e,id:e,relay:t});let o={method:nk(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o});let c=null==(n=r?.internal)?void 0:n.throwOnFailedPublish;try{if(r?.transportType===ot.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(o).catch(e=>this.logger.warn(e))},(0,a.toMiliseconds)(a.ONE_SECOND)),s;let t=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(on.created,r),t(i.id))};this.events.on(on.created,r);try{let i=await ey(new Promise((e,t)=>{this.relayer.request(o).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(on.created,r),t(i)}catch{}}),i=await ey(t,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!i&&c)throw Error(`Subscribing to ${e} failed, please try again`);return i?s:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(s9.connection_stalled),c)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:nk(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await ey(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(s9.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:nk(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await ey(new Promise((e,t)=>{this.relayer.request(r).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(s9.connection_stalled)}return t}rpcUnsubscribe(e,t,r){let i={method:nk(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,aG(aH({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,aH({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,aH({},t)),this.topicMap.set(t.topic,e),this.events.emit(on.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=st("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(on.deleted,aG(aH({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(on.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(on.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(e=>{var t;return e.topic===(null==(t=this.subscriptions.get(e.id))?void 0:t.topic)})){let{message:e}=st("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>aG(aH({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,a.toMiliseconds)(a.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return n_(e+await this.getClientId())}}var aZ=Object.defineProperty,aY=Object.getOwnPropertySymbols,aQ=Object.prototype.hasOwnProperty,aX=Object.prototype.propertyIsEnumerable,a0=(e,t,r)=>t in e?aZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,a1=(e,t)=>{for(var r in t||(t={}))aQ.call(t,r)&&a0(e,r,t[r]);if(aY)for(var r of aY(t))aX.call(t,r)&&a0(e,r,t[r]);return e},a2=(e,t,r)=>a0(e,"symbol"!=typeof t?t+"":t,r);class a5 extends sk{constructor(e){super(e),a2(this,"protocol","wc"),a2(this,"version",2),a2(this,"core"),a2(this,"logger"),a2(this,"events",new n.EventEmitter),a2(this,"provider"),a2(this,"messages"),a2(this,"subscriber"),a2(this,"publisher"),a2(this,"name","relayer"),a2(this,"transportExplicitlyClosed",!1),a2(this,"initialized",!1),a2(this,"connectionAttemptInProgress",!1),a2(this,"relayUrl"),a2(this,"projectId"),a2(this,"packageName"),a2(this,"bundleId"),a2(this,"hasExperiencedNetworkDisruption",!1),a2(this,"pingTimeout"),a2(this,"heartBeatTimeout",(0,a.toMiliseconds)(a.THIRTY_SECONDS+a.FIVE_SECONDS)),a2(this,"reconnectTimeout"),a2(this,"connectPromise"),a2(this,"reconnectInProgress",!1),a2(this,"requestsInFlight",[]),a2(this,"connectTimeout",(0,a.toMiliseconds)(15*a.ONE_SECOND)),a2(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||(0,sZ.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let n=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(n);let s=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==n),s}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),a2(this,"resetPingTimeout",()=>{es()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),a2(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),a2(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(s9.connect)}),a2(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),a2(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(s9.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),a2(this,"registerProviderListeners",()=>{this.provider.on(s7.payload,this.onPayloadHandler),this.provider.on(s7.connect,this.onConnectHandler),this.provider.on(s7.disconnect,this.onDisconnectHandler),this.provider.on(s7.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,sS.Ep)(e.logger,this.name):(0,sS.gw)((0,sS.jI)({level:e.logger||"error"})),this.messages=new aI(this.logger,e.core),this.subscriber=new aJ(this,this.logger),this.publisher=new aT(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||s4,eo()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="android"?this.packageName=el():eo()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="ios"&&(this.bundleId=el()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return(0,sS.Fd)(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:ot.relay},or.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,i,n;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let s=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),o=(null==(n=this.subscriber.topicMap.get(e))?void 0:n[0])||"",a,c=t=>{t.topic===e&&(this.subscriber.off(on.created,c),a())};return await Promise.all([new Promise(e=>{a=e,this.subscriber.on(on.created,c)}),new Promise(async(r,i)=>{o=await this.subscriber.subscribe(e,a1({internal:{throwOnFailedPublish:s}},t)).catch(e=>{s&&i(e)})||o,r()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ey(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await sb())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=ew(a.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(s9.message,e),await this.recordMessageEvent(e,or.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to connect"))};this.provider.once(s7.disconnect,r),await ey(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(s7.disconnect,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,r)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(s7.disconnect,i),await this.subscriber.start().then(e).catch(r).finally(()=>{this.provider.off(s7.disconnect,i)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,a.toMiliseconds)(1*t))),t++}}startPingTimeout(){var e,t,r,i,n;if(es())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(n=null==(i=null==(r=this.provider)?void 0:r.connection)?void 0:i.socket)||n.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new sJ.r(new sY.Z(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=r.split("?"),u=eh(e,t,i),h=function(e,t){let r=new URLSearchParams(e);return Object.entries(t).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,t])=>{null!=t&&r.set(e,String(t))}),r.toString()}(l[1]||"",{auth:n,ua:u,projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0});return l[0]+"?"+h}({sdkVersion:oe,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,sZ.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:n,attestation:s}=t.data,o={topic:r,message:i,publishedAt:n,transportType:ot.relay,attestation:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(a1({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else(0,sZ.isJsonRpcResponse)(e)&&this.events.emit(s9.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,or.inbound),this.events.emit(s9.message,e))}async acknowledgePayload(e){let t=(0,sZ.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(s7.payload,this.onPayloadHandler),this.provider.off(s7.connect,this.onConnectHandler),this.provider.off(s7.disconnect,this.onDisconnectHandler),this.provider.off(s7.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await sb();(function(e){switch(ec()){case en.browser:!eo()&&ea()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)));break;case en.reactNative:eo()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener(t=>e(t?.isConnected));case en.node:}})(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(sx.Lx.pulse,async()=>{var e;if(!this.transportExplicitlyClosed&&!this.connected&&(!(ea()&&(0,c.getDocument)())||(null==(e=(0,c.getDocument)())?void 0:e.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(s9.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,a.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function a6(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function a8(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let a3="[object Arguments]",a4="[object Object]";function a9(){}function a7(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}var ce=Object.defineProperty,ct=Object.getOwnPropertySymbols,cr=Object.prototype.hasOwnProperty,ci=Object.prototype.propertyIsEnumerable,cn=(e,t,r)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cs=(e,t)=>{for(var r in t||(t={}))cr.call(t,r)&&cn(e,r,t[r]);if(ct)for(var r of ct(t))ci.call(t,r)&&cn(e,r,t[r]);return e},co=(e,t,r)=>cn(e,"symbol"!=typeof t?t+"":t,r);class ca extends sj{constructor(e,t,r,i=s1,n){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,co(this,"map",new Map),co(this,"version","0.3"),co(this,"cached",[]),co(this,"initialized",!1),co(this,"getKey"),co(this,"storagePrefix",s1),co(this,"recentlyDeleted",[]),co(this,"recentlyDeletedLimit",200),co(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!ss(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),co(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),co(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),co(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>(function e(t,r,i,n,s,o,a){let c=a(t,r,i,n,s,o);if(void 0!==c)return c;if(typeof t==typeof r)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===r;case"number":return t===r||Object.is(t,r)}return function t(r,i,n,s){if(Object.is(r,i))return!0;let o=a8(r),a=a8(i);if(o===a3&&(o=a4),a===a3&&(a=a4),o!==a)return!1;switch(o){case"[object String]":return r.toString()===i.toString();case"[object Number]":{let e=r.valueOf(),t=i.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(r.valueOf(),i.valueOf());case"[object RegExp]":return r.source===i.source&&r.flags===i.flags;case"[object Function]":return r===i}let c=(n=n??new Map).get(r),l=n.get(i);if(null!=c&&null!=l)return c===i;n.set(r,i),n.set(i,r);try{switch(o){case"[object Map]":if(r.size!==i.size)return!1;for(let[t,o]of r.entries())if(!i.has(t)||!e(o,i.get(t),t,r,i,n,s))return!1;return!0;case"[object Set]":{if(r.size!==i.size)return!1;let t=Array.from(r.values()),o=Array.from(i.values());for(let a=0;a<t.length;a++){let c=t[a],l=o.findIndex(t=>e(c,t,void 0,r,i,n,s));if(-1===l)return!1;o.splice(l,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof sQ&&sQ.isBuffer(r)!==sQ.isBuffer(i)||r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(!e(r[t],i[t],t,r,i,n,s))return!1;return!0;case"[object ArrayBuffer]":return r.byteLength===i.byteLength&&t(new Uint8Array(r),new Uint8Array(i),n,s);case"[object DataView]":return r.byteLength===i.byteLength&&r.byteOffset===i.byteOffset&&t(new Uint8Array(r),new Uint8Array(i),n,s);case"[object Error]":return r.name===i.name&&r.message===i.message;case a4:{if(!(t(r.constructor,i.constructor,n,s)||a7(r)&&a7(i)))return!1;let o=[...Object.keys(r),...a6(r)],a=[...Object.keys(i),...a6(i)];if(o.length!==a.length)return!1;for(let t=0;t<o.length;t++){let a=o[t],c=r[a];if(!Object.hasOwn(i,a))return!1;let l=i[a];if(!e(c,l,a,r,i,n,s))return!1}return!0}default:return!1}}finally{n.delete(r),n.delete(i)}}(t,r,o,a)})(t[r],e[r],void 0,void 0,void 0,void 0,a9))):this.values)),co(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=cs(cs({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),co(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,sS.Ep)(t,this.name),this.storagePrefix=i,this.getKey=n}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=st("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=st("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=st("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var cc=Object.defineProperty,cl=(e,t,r)=>t in e?cc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cu=(e,t,r)=>cl(e,"symbol"!=typeof t?t+"":t,r);class ch{constructor(e,t){this.core=e,this.logger=t,cu(this,"name","pairing"),cu(this,"version","0.3"),cu(this,"events",new(s())),cu(this,"pairings"),cu(this,"initialized",!1),cu(this,"storagePrefix",s1),cu(this,"ignoredPayloadTypes",[1]),cu(this,"registeredMethods",[]),cu(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),cu(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),cu(this,"create",async e=>{this.isInitialized();let t=nS(),r=await this.core.crypto.setSymKey(t),i=ew(a.FIVE_MINUTES),n={protocol:"irn"},s={topic:r,expiry:i,relay:n,active:!1,methods:e?.methods},o=nG({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:n,expiryTimestamp:i,methods:e?.methods});return this.events.emit(oo.create,s),this.core.expirer.set(r,i),await this.pairings.set(r,s),await this.core.relayer.subscribe(r,{transportType:e?.transportType,internal:e?.internal}),{topic:r,uri:o}}),cu(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[of.pairing_started]}});this.isValidPair(e,r);let{topic:i,symKey:n,relay:s,expiryTimestamp:o,methods:c}=nH(e.uri);if(r.props.properties.topic=i,r.addTrace(of.pairing_uri_validation_success),r.addTrace(of.pairing_uri_not_expired),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace(of.existing_pairing),t.active)throw r.setError(od.active_pairing_already_exists),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace(of.pairing_not_expired)}let l=o||ew(a.FIVE_MINUTES),u={topic:i,relay:s,expiry:l,active:!1,methods:c};this.core.expirer.set(i,l),await this.pairings.set(i,u),r.addTrace(of.store_new_pairing),e.activatePairing&&await this.activate({topic:i}),this.events.emit(oo.create,u),r.addTrace(of.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(n,i),r.addTrace(of.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError(od.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:s})}catch(e){throw r.setError(od.subscribe_pairing_topic_failure),e}return r.addTrace(of.subscribe_pairing_topic_success),u}),cu(this,"activate",async({topic:e})=>{this.isInitialized();let t=ew(a.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),cu(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:n}=eg();this.events.once(eE("pairing_ping",e),({error:e})=>{e?n(e):i()}),await r()}}),cu(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),cu(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),cu(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),cu(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",sr("USER_DISCONNECTED")),await this.deletePairing(t))}),cu(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:n}=e,s=this.core.crypto.keychain.get(t);return nG({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:s,relay:r,expiryTimestamp:i,methods:n})}),cu(this,"sendRequest",async(e,t,r)=>{let i=(0,sZ.formatJsonRpcRequest)(t,r),n=await this.core.crypto.encode(e,i),s=os[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,n,s),i.id}),cu(this,"sendResult",async(e,t,r)=>{let i=(0,sZ.formatJsonRpcResult)(e,r),n=await this.core.crypto.encode(t,i),s=os[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,n,s),await this.core.history.resolve(i)}),cu(this,"sendError",async(e,t,r)=>{let i=(0,sZ.formatJsonRpcError)(e,r),n=await this.core.crypto.encode(t,i),s=(await this.core.history.get(t,e)).request.method,o=os[s]?os[s].res:os.unregistered_method.res;await this.core.relayer.publish(t,n,o),await this.core.history.resolve(i)}),cu(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,sr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),cu(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>ev(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),cu(this,"onRelayEventRequest",async e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),cu(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),cu(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit(oo.ping,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),cu(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("pairing_ping",r),{}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("pairing_ping",r),{error:t.error})},500)}),cu(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(oo.delete,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),cu(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=sr("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),cu(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(sr("WC_METHOD_UNSUPPORTED",e))}),cu(this,"isValidPair",(e,t)=>{var r;if(!sd(e)){let{message:r}=st("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(od.malformed_pairing_uri),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(so(e,!1)){if(t(e))return!0;let r=eA(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=st("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(od.malformed_pairing_uri),Error(r)}let i=nH(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=st("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(od.malformed_pairing_uri),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=st("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(od.malformed_pairing_uri),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,a.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError(od.pairing_expired);let{message:e}=st("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),cu(this,"isValidPing",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),cu(this,"isValidDisconnect",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),cu(this,"isValidPairingTopic",async e=>{if(!so(e,!1)){let{message:t}=st("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=st("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=st("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,sS.Ep)(t,this.name),this.pairings=new ca(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,sS.Fd)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(s9.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==ot.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let e=await this.core.crypto.decode(t,r);(0,sZ.isJsonRpcRequest)(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):(0,sZ.isJsonRpcResponse)(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(oc.expired,async e=>{let{topic:t}=em(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(oo.expire,{topic:t}))})}}var cf=Object.defineProperty,cd=(e,t,r)=>t in e?cf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cp=(e,t,r)=>cd(e,"symbol"!=typeof t?t+"":t,r);class cg extends sU{constructor(e,t){super(e,t),this.core=e,this.logger=t,cp(this,"records",new Map),cp(this,"events",new n.EventEmitter),cp(this,"name","history"),cp(this,"version","0.3"),cp(this,"cached",[]),cp(this,"initialized",!1),cp(this,"storagePrefix",s1),cp(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),cp(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:ew(a.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(oa.created,i)}),cp(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,sZ.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(oa.updated,t))}),cp(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),cp(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic!==e||"u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(oa.deleted,r))}),this.persist()}),cp(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),cp(this,"on",(e,t)=>{this.events.on(e,t)}),cp(this,"once",(e,t)=>{this.events.once(e,t)}),cp(this,"off",(e,t)=>{this.events.off(e,t)}),cp(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,sS.Ep)(t,this.name)}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:(0,sZ.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=st("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(oa.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=st("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(oa.created,e=>{let t=oa.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(oa.updated,e=>{let t=oa.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(oa.deleted,e=>{let t=oa.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(sx.Lx.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,a.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(oa.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var cy=Object.defineProperty,cb=(e,t,r)=>t in e?cy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cm=(e,t,r)=>cb(e,"symbol"!=typeof t?t+"":t,r);class cw extends s${constructor(e,t){super(e,t),this.core=e,this.logger=t,cm(this,"expirations",new Map),cm(this,"events",new n.EventEmitter),cm(this,"name","expirer"),cm(this,"version","0.3"),cm(this,"cached",[]),cm(this,"initialized",!1),cm(this,"storagePrefix",s1),cm(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),cm(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),cm(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(oc.created,{target:r,expiration:i})}),cm(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),cm(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(oc.deleted,{target:t,expiration:r})}}),cm(this,"on",(e,t)=>{this.events.on(e,t)}),cm(this,"once",(e,t)=>{this.events.once(e,t)}),cm(this,"off",(e,t)=>{this.events.off(e,t)}),cm(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,sS.Ep)(t,this.name)}get context(){return(0,sS.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return eb("topic",e);if("number"==typeof e)return eb("id",e);let{message:t}=st("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(oc.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=st("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=st("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,a.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(oc.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(sx.Lx.pulse,()=>this.checkExpirations()),this.events.on(oc.created,e=>{let t=oc.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(oc.expired,e=>{let t=oc.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(oc.deleted,e=>{let t=oc.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}}var cv=Object.defineProperty,cE=(e,t,r)=>t in e?cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cx=(e,t,r)=>cE(e,"symbol"!=typeof t?t+"":t,r);class cI extends sM{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,cx(this,"name","verify-api"),cx(this,"abortController"),cx(this,"isDevEnv"),cx(this,"verifyUrlV3",ou),cx(this,"storagePrefix",s1),cx(this,"version",2),cx(this,"publicKey"),cx(this,"fetchPromise"),cx(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,a.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),cx(this,"register",async e=>{if(!ea()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,n=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,c.getDocument)(),t=this.startAbortTimer(5*a.ONE_SECOND),i=await new Promise((i,s)=>{let o=()=>{window.removeEventListener("message",c),e.body.removeChild(a),s("attestation aborted")};this.abortController.signal.addEventListener("abort",o);let a=e.createElement("iframe");a.src=n,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});let c=n=>{if(n.data&&"string"==typeof n.data)try{let s=JSON.parse(n.data);if("verify_attestation"===s.type){if((0,$.xp)(s.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",c),i(null===s.attestation?"":s.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",i),i}catch(e){this.logger.warn(e)}return""}),cx(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t){this.logger.debug("resolve: attestationId is empty, skipping");return}if(t){if((0,$.xp)(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e){if(!e.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return e}}if(!r)return;let n=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,n)}),cx(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*a.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),cx(this,"getVerifyUrl",e=>{let t=e||ol;return oh.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${ol}`),t=ol),t}),cx(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(a.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),cx(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),cx(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),cx(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),cx(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),cx(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),cx(this,"validateAttestation",(e,t)=>{let r=function(e,t){let[r,i,n]=e.split("."),s=V.from(nR(n),"base64");if(64!==s.length)throw Error("Invalid signature length");let o=s.slice(0,32),a=s.slice(32,64),c=tW(`${r}.${i}`),l=function(e){let t=V.from(e.x,"base64"),r=V.from(e.y,"base64");return(0,M.zo)([new Uint8Array([4]),t,r])}(t);if(!nm.verify((0,M.zo)([o,a]),c,l))throw Error("Invalid signature");return(0,$.xp)(e).payload}(e,t.publicKey),i={hasExpired:(0,a.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=(0,sS.Ep)(t,this.name),this.abortController=new AbortController,this.isDevEnv=eP(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,sS.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,a.toMiliseconds)(e))}}var cS=Object.defineProperty,cO=(e,t,r)=>t in e?cS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c_=(e,t,r)=>cO(e,"symbol"!=typeof t?t+"":t,r);class cP extends sz{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,c_(this,"context","echo"),c_(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:n=!1}=e,s=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:n})})}),this.logger=(0,sS.Ep)(t,this.context)}}var cA=Object.defineProperty,cD=Object.getOwnPropertySymbols,cR=Object.prototype.hasOwnProperty,cC=Object.prototype.propertyIsEnumerable,cB=(e,t,r)=>t in e?cA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cU=(e,t)=>{for(var r in t||(t={}))cR.call(t,r)&&cB(e,r,t[r]);if(cD)for(var r of cD(t))cC.call(t,r)&&cB(e,r,t[r]);return e},cT=(e,t,r)=>cB(e,"symbol"!=typeof t?t+"":t,r);class cN extends sq{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,cT(this,"context","event-client"),cT(this,"storagePrefix",s1),cT(this,"storageVersion",.1),cT(this,"events",new Map),cT(this,"shouldPersist",!1),cT(this,"init",async()=>{if(!eP())try{let e={eventId:e_(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:eh(this.core.relayer.protocol,this.core.relayer.version,oe)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),cT(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:n}}=e,s=e_(),o=this.core.projectId||"",a=cU({eventId:s,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:n}},bundleId:o,domain:this.getAppDomain()},this.setMethods(s));return this.telemetryEnabled&&(this.events.set(s,a),this.shouldPersist=!0),a}),cT(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return cU(cU({},i),this.setMethods(i.eventId))}),cT(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),cT(this,"setEventListeners",()=>{this.core.heartbeat.on(sx.Lx.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,a.fromMiliseconds)(Date.now())-(0,a.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),cT(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),cT(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),cT(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),cT(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),cT(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,cU(cU({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),cT(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),cT(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${oe}${t}`,{method:"POST",body:JSON.stringify(e)})}),cT(this,"getAppDomain",()=>eu().url),this.logger=(0,sS.Ep)(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var ck=Object.defineProperty,cj=Object.getOwnPropertySymbols,cL=Object.prototype.hasOwnProperty,c$=Object.prototype.propertyIsEnumerable,cM=(e,t,r)=>t in e?ck(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cz=(e,t)=>{for(var r in t||(t={}))cL.call(t,r)&&cM(e,r,t[r]);if(cj)for(var r of cj(t))c$.call(t,r)&&cM(e,r,t[r]);return e},cq=(e,t,r)=>cM(e,"symbol"!=typeof t?t+"":t,r);class cF extends sD{constructor(e){var t;super(e),cq(this,"protocol","wc"),cq(this,"version",2),cq(this,"name",s0),cq(this,"relayUrl"),cq(this,"projectId"),cq(this,"customStoragePrefix"),cq(this,"events",new n.EventEmitter),cq(this,"logger"),cq(this,"heartbeat"),cq(this,"relayer"),cq(this,"crypto"),cq(this,"storage"),cq(this,"history"),cq(this,"expirer"),cq(this,"pairing"),cq(this,"verify"),cq(this,"echoClient"),cq(this,"linkModeSupportedApps"),cq(this,"eventClient"),cq(this,"initialized",!1),cq(this,"logChunkController"),cq(this,"on",(e,t)=>this.events.on(e,t)),cq(this,"once",(e,t)=>this.events.once(e,t)),cq(this,"off",(e,t)=>this.events.off(e,t)),cq(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),cq(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:ot.link_mode};this.relayer.onLinkMessageEvent(i,{sessionExists:r})});let r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||s4,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=(0,sS.jI)({level:"string"==typeof e?.logger&&e.logger?e.logger:s2.logger,name:s0}),{logger:s,chunkLoggerController:o}=(0,sS.Rt)({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,sS.Ep)(s,this.name),this.heartbeat=new sx.C$,this.crypto=new af(this,this.logger,e?.keychain),this.history=new cg(this,this.logger),this.expirer=new cw(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new sI.ZP(cz(cz({},s5),e?.storageOptions)),this.relayer=new a5({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ch(this,this.logger),this.verify=new cI(this,this.logger,this.storage),this.echoClient=new cP(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new cN(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new cF(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return(0,sS.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(oi,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(oi)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){console.warn("Failed to get global WalletConnect core",e);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return"u">typeof sX&&"true"===sX.env.DISABLE_GLOBAL_CORE}catch{return!0}}}let cV="client",cK=`wc@2:${cV}:`,cH={name:cV,logger:"error"},cG="WALLETCONNECT_DEEPLINK_CHOICE",cW="Proposal expired",cJ=a.SEVEN_DAYS,cZ={wc_sessionPropose:{req:{ttl:a.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:a.ONE_DAY,prompt:!1,tag:1104},res:{ttl:a.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:a.ONE_DAY,prompt:!1,tag:1106},res:{ttl:a.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:a.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:a.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:a.ONE_DAY,prompt:!1,tag:1112},res:{ttl:a.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:a.ONE_DAY,prompt:!1,tag:1114},res:{ttl:a.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:a.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:a.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:a.FIVE_MINUTES,prompt:!1,tag:1119}}},cY={min:a.FIVE_MINUTES,max:a.SEVEN_DAYS},cQ={idle:"IDLE",active:"ACTIVE"},cX={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},c0=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],c1="wc@1.5:auth:",c2=`${c1}:PUB_KEY`;var c5=Object.defineProperty,c6=Object.defineProperties,c8=Object.getOwnPropertyDescriptors,c3=Object.getOwnPropertySymbols,c4=Object.prototype.hasOwnProperty,c9=Object.prototype.propertyIsEnumerable,c7=(e,t,r)=>t in e?c5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,le=(e,t)=>{for(var r in t||(t={}))c4.call(t,r)&&c7(e,r,t[r]);if(c3)for(var r of c3(t))c9.call(t,r)&&c7(e,r,t[r]);return e},lt=(e,t)=>c6(e,c8(t)),lr=(e,t,r)=>c7(e,"symbol"!=typeof t?t+"":t,r);class li extends sG{constructor(e){super(e),lr(this,"name","engine"),lr(this,"events",new(s())),lr(this,"initialized",!1),lr(this,"requestQueue",{state:cQ.idle,queue:[]}),lr(this,"sessionRequestQueue",{state:cQ.idle,queue:[]}),lr(this,"emittedSessionRequests",new eD({limit:500})),lr(this,"requestQueueDelay",a.ONE_SECOND),lr(this,"expectedPairingMethodMap",new Map),lr(this,"recentlyDeletedMap",new Map),lr(this,"recentlyDeletedLimit",200),lr(this,"relayMessageCache",[]),lr(this,"pendingSessions",new Map),lr(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(cZ)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,a.toMiliseconds)(this.requestQueueDelay)))}),lr(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=lt(le({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,i,n,s,o,a;let c=n4(e),l=n4(t),u={};for(let e of Object.keys(c).concat(Object.keys(l)))u[e]={chains:ex(null==(r=c[e])?void 0:r.chains,null==(i=l[e])?void 0:i.chains),methods:ex(null==(n=c[e])?void 0:n.methods,null==(s=l[e])?void 0:s.methods),events:ex(null==(o=c[e])?void 0:o.events,null==(a=l[e])?void 0:a.events)};return u}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:n,sessionProperties:s,scopedProperties:o,relays:c}=t,l=r,u,h=!1;try{if(l){let e=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),e}if(!l||!h){let{topic:e,uri:t}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});l=e,u=t}if(!l){let{message:e}=st("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw Error(e)}let f=await this.client.core.crypto.generateKeyPair(),d=cZ.wc_sessionPropose.req.ttl||a.FIVE_MINUTES,p=ew(d),g=lt(le(le({requiredNamespaces:i,optionalNamespaces:n,relays:c??[{protocol:"irn"}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:l},s&&{sessionProperties:s}),o&&{scopedProperties:o}),{id:(0,sZ.payloadId)()}),y=eE("session_connect",g.id),{reject:b,resolve:m,done:w}=eg(d,cW),v=({id:e})=>{e===g.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(g.id),this.events.emit(y,{error:{message:cW,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(y,({error:e,session:t})=>{this.client.events.off("proposal_expire",v),e?b(e):t&&m(t)}),await this.sendProposeSession({proposal:g,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:g.id}}}),await this.setProposal(g.id,g),{uri:u,approval:w}}),lr(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),lr(this,"approve",async e=>{var t,r,i;let n=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[op.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw n.setError(og.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),n.setError(og.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),n.setError(og.session_approve_namespace_validation_failure),e}let{id:s,relayProtocol:o,namespaces:a,sessionProperties:c,scopedProperties:l,sessionConfig:u}=e,h=this.client.proposal.get(s);this.client.core.eventClient.deleteEvent({eventId:n.eventId});let{pairingTopic:f,proposer:d,requiredNamespaces:p,optionalNamespaces:g}=h,y=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:f});y||(y=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:op.session_approve_started,properties:{topic:f,trace:[op.session_approve_started,op.session_namespaces_validation_success]}}));let b=await this.client.core.crypto.generateKeyPair(),m=d.publicKey,w=await this.client.core.crypto.generateSharedKey(b,m),v=le(le(le({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:b,metadata:this.client.metadata},expiry:ew(cJ)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),u&&{sessionConfig:u}),E=ot.relay;y.addTrace(op.subscribing_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:E,internal:{skipSubscribe:!0}})}catch(e){throw y.setError(og.subscribe_session_topic_failure),e}y.addTrace(op.subscribe_session_topic_success);let x=lt(le({},v),{topic:w,requiredNamespaces:p,optionalNamespaces:g,pairingTopic:f,acknowledged:!1,self:v.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:b,transportType:ot.relay});await this.client.session.set(w,x),y.addTrace(op.store_session);try{await this.sendApproveSession({sessionTopic:w,proposal:h,pairingProposalResponse:{relay:{protocol:o??"irn"},responderPublicKey:b},sessionSettleRequest:v,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:s}}}),y.addTrace(op.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(w,sr("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(w),e}return this.client.core.eventClient.deleteEvent({eventId:y.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:d.metadata}),await this.deleteProposal(s),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(w,ew(cJ)),{topic:w,acknowledged:()=>Promise.resolve(this.client.session.get(w))}}),lr(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&await this.sendError({id:r,topic:t,error:i,rpcOpts:cZ.wc_sessionPropose.reject}),await this.deleteProposal(r)}),lr(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:n,reject:s}=eg(),o=(0,sZ.payloadId)(),a=(0,sZ.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(eE("session_update",o),({error:e})=>{e?s(e):n()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),s(e)}),{acknowledged:i}}),lr(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=(0,sZ.payloadId)(),{done:i,resolve:n,reject:s}=eg();return this.events.once(eE("session_extend",r),({error:e})=>{e?s(e):n()}),await this.setExpiry(t,ew(cJ)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{s(e)}),{acknowledged:i}}),lr(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:n=cZ.wc_sessionRequest.req.ttl}=e,s=this.client.session.get(i);s?.transportType===ot.relay&&await this.confirmOnlineStateOrThrow();let o=(0,sZ.payloadId)(),a=(0,sZ.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:u}=eg(n,"Request expired. Please try again.");this.events.once(eE("session_request",o),({error:e,result:t})=>{e?u(e):l(t)});let h="wc_sessionRequest",f=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);if(f)return await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:h,params:{request:lt(le({},r),{expiryTimestamp:ew(n)}),chainId:t},expiry:n,throwOnFailedPublish:!0,appLink:f}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),await c();let d={request:lt(le({},r),{expiryTimestamp:ew(n)}),chainId:t};return await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:h,params:d,expiry:n,throwOnFailedPublish:!0,tvf:this.getTVFParams(o,d)}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),e()}),new Promise(async e=>{var t;if(!(null!=(t=s.sessionConfig)&&t.disableDeepLink)){let e=await eS(this.client.core.storage,cG);await eI({id:o,topic:i,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),lr(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:r}=e,{id:i}=r,n=this.client.session.get(t);n.transportType===ot.relay&&await this.confirmOnlineStateOrThrow();let s=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);(0,sZ.isJsonRpcResult)(r)?await this.sendResult({id:i,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:s}):(0,sZ.isJsonRpcError)(r)&&await this.sendError({id:i,topic:t,error:r.error,appLink:s}),this.cleanupAfterResponse(e)}),lr(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,sZ.payloadId)(),r=(0,sZ.getBigIntRpcId)().toString(),{done:i,resolve:n,reject:s}=eg();this.events.once(eE("session_ping",e),({error:e})=>{e?s(e):n()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),lr(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,n=(0,sZ.getBigIntRpcId)().toString(),s=(0,sZ.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:n,clientRpcId:s})}),lr(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:sr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=st("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),lr(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),n=Object.keys(r),s=!0;return!!ef(n,i)&&(i.forEach(t=>{let{accounts:i,methods:n,events:o}=e.namespaces[t],a=n6(i),c=r[t];ef(G(t,c),a)&&ef(c.methods,n)&&ef(c.events,o)||(s=!1)}),s)})(t,e)))),lr(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),lr(this,"authenticate",async(e,t)=>{var r,i,n;let s;this.isInitialized(),this.isValidAuthenticate(e);let o=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),a=o?ot.link_mode:ot.relay;a===ot.relay&&await this.confirmOnlineStateOrThrow();let{chains:c,statement:l="",uri:u,domain:h,nonce:f,type:d,exp:p,nbf:g,methods:y=[],expiry:b}=e,m=[...e.resources||[]],{topic:w,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:v}});let E=await this.client.core.crypto.generateKeyPair(),x=nO(E);if(await Promise.all([this.client.auth.authKeys.set(c2,{responseTopic:x,publicKey:E}),this.client.auth.pairingTopics.set(x,{topic:x,pairingTopic:w})]),await this.client.core.relayer.subscribe(x,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${w}`),y.length>0){let{namespace:e}=K(c[0]),t=rw(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(e,"request",y));rI(m)&&(i=t,n=m.pop(),t=rw(function(e,t){rm(e),rm(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var n,s;Object.keys((null==(n=e.att)?void 0:n[r])||{}).concat(Object.keys((null==(s=t.att)?void 0:s[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(n=>{var s,o;i.att[r]=rh(ru({},i.att[r]),{[n]:(null==(s=e.att[r])?void 0:s[n])||(null==(o=t.att[r])?void 0:o[n])})})}),i}(rv(i),rv(n)))),m.push(t)}let I=b&&b>cZ.wc_sessionAuthenticate.req.ttl?b:cZ.wc_sessionAuthenticate.req.ttl,S={authPayload:{type:d??"caip122",chains:c,statement:l,aud:u,domain:h,version:"1",nonce:f,iat:new Date().toISOString(),exp:p,nbf:g,resources:m},requester:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:ew(I)},O={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:c,methods:[...new Set(["personal_sign",...y])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:ew(cZ.wc_sessionPropose.req.ttl),id:(0,sZ.payloadId)()},{done:_,resolve:P,reject:A}=eg(I,"Request expired"),D=(0,sZ.payloadId)(),R=eE("session_connect",O.id),C=eE("session_request",D),B=async({error:e,session:t})=>{this.events.off(C,U),e?A(e):t&&P({session:t})},U=async e=>{var r,i,n;let s;if(await this.deletePendingAuthRequest(D,{message:"fulfilled",code:0}),e.error){let t=sr("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(R,B),A(e.error.message))}await this.deleteProposal(O.id),this.events.off(R,B);let{cacaos:o,responder:c}=e.result,l=[],u=[];for(let e of o){await ry({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),A(sr("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=rI(t.resources),i=[rp(t.iss)],n=rg(t.iss);if(r){let e=rE(r),t=rx(r);l.push(...e),i.push(...t)}for(let e of i)u.push(`${e}:${n}`)}let h=await this.client.core.crypto.generateSharedKey(E,c.publicKey);l.length>0&&(s={topic:h,acknowledged:!0,self:{publicKey:E,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:ew(cJ),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:n9([...new Set(l)],[...new Set(u)]),transportType:a},await this.client.core.relayer.subscribe(h,{transportType:a}),await this.client.session.set(h,s),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),s=this.client.session.get(h)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=c.metadata.redirect)&&i.linkMode&&null!=(n=c.metadata.redirect)&&n.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(h,{transportType:ot.link_mode})),P({auths:o,session:s})};this.events.once(R,B),this.events.once(C,U);try{if(o){let e=(0,sZ.formatJsonRpcRequest)("wc_sessionAuthenticate",S,D);this.client.core.history.set(w,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:nx});s=nW(t,w,r)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:S,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:D}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:O,expiry:cZ.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:O.id})])}catch(e){throw this.events.off(R,B),this.events.off(C,U),e}return await this.setProposal(O.id,O),await this.setAuthRequest(D,{request:lt(le({},S),{verifyContext:{}}),pairingTopic:w,transportType:a}),{uri:s??v,response:_}}),lr(this,"approveSessionAuthenticate",async e=>{let t;let{id:r,auths:i}=e,n=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[oy.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw n.setError(ob.no_internet_connection),e}let s=this.getPendingAuthRequest(r);if(!s)throw n.setError(ob.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${r}`);let o=s.transportType||ot.relay;o===ot.relay&&await this.confirmOnlineStateOrThrow();let a=s.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=nO(a),u={type:1,receiverPublicKey:a,senderPublicKey:c},h=[],f=[];for(let e of i){if(!await ry({cacao:e,projectId:this.client.core.projectId})){n.setError(ob.invalid_cacao);let e=sr("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:e,encodeOpts:u}),Error(e.message)}n.addTrace(oy.cacaos_verified);let{p:t}=e,i=rI(t.resources),s=[rp(t.iss)],o=rg(t.iss);if(i){let e=rE(i),t=rx(i);h.push(...e),s.push(...t)}for(let e of s)f.push(`${e}:${o}`)}let d=await this.client.core.crypto.generateSharedKey(c,a);if(n.addTrace(oy.create_authenticated_session_topic),h?.length>0){t={topic:d,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:a,metadata:s.requester.metadata},controller:a,expiry:ew(cJ),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:s.pairingTopic,namespaces:n9([...new Set(h)],[...new Set(f)]),transportType:o},n.addTrace(oy.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(d,{transportType:o})}catch(e){throw n.setError(ob.subscribe_authenticated_session_topic_failure),e}n.addTrace(oy.subscribe_authenticated_session_topic_success),await this.client.session.set(d,t),n.addTrace(oy.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:s.pairingTopic,metadata:s.requester.metadata})}n.addTrace(oy.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:i,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(s.requester.metadata,o)})}catch(e){throw n.setError(ob.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:s.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:t}}),lr(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===ot.relay&&await this.confirmOnlineStateOrThrow();let n=i.requester.publicKey,s=await this.client.core.crypto.generateKeyPair(),o=nO(n);await this.sendError({id:t,topic:o,error:r,encodeOpts:{type:1,receiverPublicKey:n,senderPublicKey:s},rpcOpts:cZ.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.deleteProposal(t)}),lr(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return rb(t,r)}),lr(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),lr(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,n;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(n=r.peerMetadata)?void 0:n.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),lr(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:n=!0,id:s=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,sr("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(cG).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,sr("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=cQ.idle),n&&this.client.events.emit("session_delete",{id:s,topic:r})}),lr(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError(og.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,sr("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),lr(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=cQ.idle,this.client.events.emit("session_request_expire",{id:e}))}),lr(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),lr(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),lr(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,ew(cZ.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),lr(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:n=ot.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:n})}),lr(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:n}=e,s=i.request.expiryTimestamp||ew(cZ.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,s),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:n})}),lr(this,"sendRequest",async e=>{let t,i;let{topic:n,method:s,params:o,expiry:a,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:u,appLink:h,tvf:f,publishOpts:d={}}=e,p=(0,sZ.formatJsonRpcRequest)(s,o,l),g=!!h;try{let e=g?nx:nE;t=await this.client.core.crypto.encode(n,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),e}if(c0.includes(s)){let e=n_(JSON.stringify(p)),r=n_(t);i=await this.client.core.verify.register({id:r,decryptedId:e})}let y=le(le({},cZ[s].req),d);if(y.attestation=i,a&&(y.ttl=a),c&&(y.id=c),this.client.core.history.set(n,p),g){let e=nW(h,n,t);await r.g.Linking.openURL(e,this.client.name)}else y.tvf=lt(le({},f),{correlationId:p.id}),u?(y.internal=lt(le({},y.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,t,y)):this.client.core.relayer.publish(n,t,y).catch(e=>this.client.logger.error(e));return p.id}),lr(this,"sendProposeSession",async e=>{let{proposal:t,publishOpts:r}=e,i=(0,sZ.formatJsonRpcRequest)("wc_sessionPropose",t,t.id);this.client.core.history.set(t.pairingTopic,i);let n=await this.client.core.crypto.encode(t.pairingTopic,i,{encoding:nE}),s=n_(JSON.stringify(i)),o=n_(n),a=await this.client.core.verify.register({id:o,decryptedId:s});await this.client.core.relayer.publishCustom({payload:{pairingTopic:t.pairingTopic,sessionProposal:n},opts:lt(le({},r),{publishMethod:"wc_proposeSession",attestation:a})})}),lr(this,"sendApproveSession",async e=>{let{sessionTopic:t,pairingProposalResponse:r,proposal:i,sessionSettleRequest:n,publishOpts:s}=e,o=(0,sZ.formatJsonRpcResult)(i.id,r),a=await this.client.core.crypto.encode(i.pairingTopic,o,{encoding:nE}),c=(0,sZ.formatJsonRpcRequest)("wc_sessionSettle",n,s?.id),l=await this.client.core.crypto.encode(t,c,{encoding:nE});this.client.core.history.set(t,c),await this.client.core.relayer.publishCustom({payload:{sessionTopic:t,pairingTopic:i.pairingTopic,sessionProposalResponse:a,sessionSettlementRequest:l},opts:lt(le({},s),{publishMethod:"wc_approveSession"})})}),lr(this,"sendResult",async e=>{let t,i,n;let{id:s,topic:o,result:a,throwOnFailedPublish:c,encodeOpts:l,appLink:u}=e,h=(0,sZ.formatJsonRpcResult)(s,a),f=u&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=f?nx:nE;t=await this.client.core.crypto.encode(o,h,lt(le({},l||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${o} failed`),e}try{let e=(i=await this.client.core.history.get(o,s)).request;try{n=this.getTVFParams(s,e.params,a)}catch(e){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${e?.message}`)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${o}, ${s}) failed`),e}if(f){let e=nW(u,o,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=cZ[i.request.method].res;e.tvf=lt(le({},n),{correlationId:s}),c?(e.internal=lt(le({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,t,e)):this.client.core.relayer.publish(o,t,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(h)}),lr(this,"sendError",async e=>{let t,i;let{id:n,topic:s,error:o,encodeOpts:a,rpcOpts:c,appLink:l}=e,u=(0,sZ.formatJsonRpcError)(n,o),h=l&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=h?nx:nE;t=await this.client.core.crypto.encode(s,u,lt(le({},a||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),e}try{i=await this.client.core.history.get(s,n)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),e}if(h){let e=nW(l,s,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=i.request.method,r=c||cZ[e].res;this.client.core.relayer.publish(s,t,r)}await this.client.core.history.resolve(u)}),lr(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;ev(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{ev(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),lr(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),lr(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),lr(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===cQ.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=cQ.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=cQ.idle}),lr(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:n,encryptedId:s}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:s});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:s,transportType:n});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:s,transportType:n});default:return this.client.logger.info(`Unsupported request method ${o}`)}}),lr(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,n=(await this.client.core.history.get(t,r.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${n}`)}}),lr(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=st("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),lr(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),lr(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:n}=e,{params:s,id:o}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(od.proposal_listener_not_found)),this.isValidConnect(le({},r.params));let a=s.expiryTimestamp||ew(cZ.wc_sessionPropose.req.ttl),c=le({id:o,pairingTopic:t,expiryTimestamp:a,attestation:i,encryptedId:n},s);await this.setProposal(o,c);let l=await this.getVerifyContext({attestationId:i,hash:n_(JSON.stringify(r)),encryptedId:n,metadata:c.proposer.metadata});e?.addTrace(of.emit_session_proposal),this.client.events.emit("session_proposal",{id:o,params:c,verifyContext:l})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:cZ.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),lr(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if((0,sZ.isJsonRpcResult)(t)){let{result:n}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});let s=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s});let o=s.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});let a=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});let c=await this.client.core.crypto.generateSharedKey(o,a);this.pendingSessions.set(i,{sessionTopic:c,pairingTopic:e,proposalId:i,publicKey:o});let l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,sZ.isJsonRpcError)(t)){await this.deleteProposal(i);let e=eE("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),lr(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:n,expiry:s,namespaces:o,sessionProperties:a,scopedProperties:c,sessionConfig:l}=t.params,u=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!u)return this.client.logger.error(`Pending session not found for topic ${e}`);let h=this.client.proposal.get(u.proposalId),f=lt(le(le(le({topic:e,relay:r,expiry:s,namespaces:o,acknowledged:!0,pairingTopic:u.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:n.publicKey,self:{publicKey:u.publicKey,metadata:this.client.metadata},peer:{publicKey:n.publicKey,metadata:n.metadata}},a&&{sessionProperties:a}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:ot.relay});await this.client.session.set(f.topic,f),await this.setExpiry(f.topic,f.expiry),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:f.peer.metadata}),this.client.events.emit("session_connect",{session:f}),this.events.emit(eE("session_connect",u.proposalId),{session:f}),this.pendingSessions.delete(u.proposalId),this.deleteProposal(u.proposalId,!1),this.cleanupDuplicatePairings(f),await this.sendResult({id:t.id,topic:e,result:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),lr(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;(0,sZ.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(eE("session_approve",r),{})):(0,sZ.isJsonRpcError)(t)&&(await this.client.session.delete(e,sr("USER_DISCONNECTED")),this.events.emit(eE("session_approve",r),{error:t.error}))}),lr(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,n=sv.get(t);if(n&&this.isRequestOutOfSync(n,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:sr("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(le({topic:e},r));try{sv.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0})}catch(e){throw sv.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),lr(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),lr(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=eE("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("session_update",r),{}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("session_update",r),{error:t.error})}),lr(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,ew(cJ)),await this.sendResult({id:r,topic:e,result:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),lr(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=eE("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("session_extend",r),{}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("session_extend",r),{error:t.error})}),lr(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),lr(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=eE("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners 2176`);(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("session_ping",r),{}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("session_ping",r),{error:t.error})},500)}),lr(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise(t=>{this.client.core.relayer.once(s9.publish,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:sr("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),lr(this,"onSessionRequest",async e=>{var t,r,i;let{topic:n,payload:s,attestation:o,encryptedId:a,transportType:c}=e,{id:l,params:u}=s;try{await this.isValidRequest(le({topic:n},u));let e=this.client.session.get(n),s=await this.getVerifyContext({attestationId:o,hash:n_(JSON.stringify((0,sZ.formatJsonRpcRequest)("wc_sessionRequest",u,l))),encryptedId:a,metadata:e.peer.metadata,transportType:c}),h={id:l,topic:n,params:u,verifyContext:s};await this.setPendingSessionRequest(h),c===ot.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(h):(this.addSessionRequestToSessionRequestQueue(h),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:n,error:e}),this.client.logger.error(e)}}),lr(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=eE("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("session_request",r),{result:t.result}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("session_request",r),{error:t.error})}),lr(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,n=sv.get(t);if(n&&this.isRequestOutOfSync(n,r)){this.client.logger.info(`Discarding out of sync request - ${r}`);return}this.isValidEmit(le({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),sv.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),lr(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,sZ.isJsonRpcResult)(t)?this.events.emit(eE("session_request",r),{result:t.result}):(0,sZ.isJsonRpcError)(t)&&this.events.emit(eE("session_request",r),{error:t.error})}),lr(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:n,encryptedId:s,transportType:o}=e;try{let{requester:e,authPayload:a,expiryTimestamp:c}=i.params,l=await this.getVerifyContext({attestationId:n,hash:n_(JSON.stringify(i)),encryptedId:s,metadata:e.metadata,transportType:o}),u={requester:e,pairingTopic:r,id:i.id,authPayload:a,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(i.id,{request:u,pairingTopic:r,transportType:o}),o===ot.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:l})}catch(s){this.client.logger.error(s);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),n=this.getAppLinkIfEnabled(i.params.requester.metadata,o);await this.sendError({id:i.id,topic:r,error:s,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:cZ.wc_sessionAuthenticate.autoReject,appLink:n})}}),lr(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),lr(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=cQ.idle,this.processSessionRequestQueue()},(0,a.toMiliseconds)(this.requestQueueDelay))}),lr(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=eE("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(eE("session_request",e.request.id),{error:t})})}),lr(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===cQ.active){this.client.logger.info("session request queue is already active.");return}let e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),lr(this,"emitSessionRequest",e=>{if(this.emittedSessionRequests.has(e.id)){this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`);return}this.sessionRequestQueue.state=cQ.active,this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e)}),lr(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,sZ.formatJsonRpcRequest)("wc_sessionPropose",lt(le({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),lr(this,"isValidConnect",async e=>{let t;if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:n,sessionProperties:s,scopedProperties:o,relays:a}=e;if(ss(r)||await this.isValidPairingTopic(r),t=!1,a?a&&si(a)&&a.length&&a.forEach(e=>{t=sf(e)}):t=!0,!t){let{message:e}=st("MISSING_OR_INVALID",`connect() relays: ${a}`);throw Error(e)}if(!ss(i)&&0!==sn(i)){let e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(i,"requiredNamespaces")}if(ss(n)||0===sn(n)||this.validateNamespaces(n,"optionalNamespaces"),ss(s)||this.validateSessionProps(s,"sessionProperties"),!ss(o)){this.validateSessionProps(o,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(n||{}));if(!Object.keys(o).every(t=>e.includes(t.split(":")[0])))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(o)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),lr(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&sn(e)){let n;let s=su(e,t);s&&(i=s);let o=(n=null,Object.entries(e).forEach(([e,i])=>{var s,o;let a;if(n)return;let c=(s=G(e,i),o=`${t} ${r}`,a=null,si(s)&&s.length?s.forEach(e=>{a||sc(e)||(a=sr("UNSUPPORTED_CHAINS",`${o}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):sc(e)||(a=sr("UNSUPPORTED_CHAINS",`${o}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),a);c&&(n=c)}),n);o&&(i=o)}else i=st("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),lr(this,"isValidApprove",async e=>{if(!sd(e))throw Error(st("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:n,scopedProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let o=this.client.proposal.get(t),a=sh(r,"approve()");if(a)throw Error(a.message);let c=sg(o.requiredNamespaces,r,"approve()");if(c)throw Error(c.message);if(!so(i,!0)){let{message:e}=st("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}if(ss(n)||this.validateSessionProps(n,"sessionProperties"),!ss(s)){this.validateSessionProps(s,"scopedProperties");let e=new Set(Object.keys(r));if(!Object.keys(s).every(t=>e.has(t.split(":")[0])))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(s)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),lr(this,"isValidReject",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!sa(r.code,!1)||!r.message||!so(r.message,!1)){let{message:e}=st("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),lr(this,"isValidSessionSettleRequest",e=>{let t;if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:n,expiry:s}=e;if(!sf(r)){let{message:e}=st("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let o=(t=null,so(i?.publicKey,!1)||(t=st("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(o)throw Error(o.message);let a=sh(n,"onSessionSettleRequest()");if(a)throw Error(a.message);if(ev(s)){let{message:e}=st("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),lr(this,"isValidUpdate",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),n=sh(r,"update()");if(n)throw Error(n.message);let s=sg(i.requiredNamespaces,r,"update()");if(s)throw Error(s.message)}),lr(this,"isValidExtend",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),lr(this,"isValidRequest",async e=>{var t;if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:n,expiry:s}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!sp(o,n)){let{message:e}=st("MISSING_OR_INVALID",`request() chainId: ${n}`);throw Error(e)}if(ss(i)||!so(i.method,!1)){let{message:e}=st("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(so(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{n6(e.accounts).includes(t)&&r.push(...e.methods)}),r})(o,n).includes(t))){let{message:e}=st("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(s&&(!sa(s,!1)||!(s<=cY.max)||!(s>=cY.min))){let{message:e}=st("MISSING_OR_INVALID",`request() expiry: ${s}. Expiry must be a number (in seconds) between ${cY.min} and ${cY.max}`);throw Error(e)}}),lr(this,"isValidRespond",async e=>{var t;if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(ss(i)||ss(i.result)&&ss(i.error)||!sa(i.id,!1)||!so(i.jsonrpc,!1)){let{message:e}=st("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}}),lr(this,"isValidPing",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),lr(this,"isValidEmit",async e=>{var t;if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:n}=e;await this.isValidSessionTopic(r);let{namespaces:s}=this.client.session.get(r);if(!sp(s,n)){let{message:e}=st("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw Error(e)}if(ss(i)||!so(i.name,!1)){let{message:e}=st("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}if(!(so(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{n6(e.accounts).includes(t)&&r.push(...e.events)}),r})(s,n).includes(t))){let{message:e}=st("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),lr(this,"isValidDisconnect",async e=>{if(!sd(e)){let{message:t}=st("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),lr(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:n}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!so(r,!1))throw Error("uri is required parameter");if(!so(i,!1))throw Error("domain is required parameter");if(!so(n,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>K(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:s}=K(t[0]);if("eip155"!==s)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),lr(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:n,transportType:s}=e,o={verified:{verifyUrl:n.verifyUrl||ol,validation:"UNKNOWN",origin:n.url||""}};try{if(s===ot.link_mode){let e=this.getAppLinkIfEnabled(n,s);return o.verified.validation=e&&new URL(e).origin===new URL(n.url).origin?"VALID":"INVALID",o}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:n.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o}),lr(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,i)=>{if(null==r){let{message:n}=st("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[i]}`);throw Error(n)}})}),lr(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),lr(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),lr(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=st("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),lr(this,"isLinkModeEnabled",(e,t)=>{var i,n,s,o,a,c,l,u,h;return!!e&&t===ot.link_mode&&(null==(n=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:n.linkMode)===!0&&(null==(o=null==(s=this.client.metadata)?void 0:s.redirect)?void 0:o.universal)!==void 0&&(null==(c=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(u=e?.redirect)?void 0:u.universal)!==""&&(null==(h=e?.redirect)?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==r.g?void 0:r.g.Linking)}),lr(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),lr(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=eO(e,"topic")||"",r=decodeURIComponent(eO(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:ot.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),lr(this,"registerLinkModeListeners",async()=>{var e;if(eP()||eo()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==r.g?void 0:r.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),lr(this,"getTVFParams",(e,t,r)=>{var i,n,s;if(!(null!=(i=t.request)&&i.method))return{};let o={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{let e=this.extractTxHashesFromResult(t.request,r);o.txHashes=e,o.contractAddresses=this.isValidContractData(t.request.params)?[null==(s=null==(n=t.request.params)?void 0:n[0])?void 0:s.to]:[]}catch(e){this.client.logger.warn("Error getting TVF params",e)}return o}),lr(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),lr(this,"extractTxHashesFromResult",(e,t)=>{var r;try{if(!t)return[];let i=e.method,n=cX[i];if("sui_signTransaction"===i)return[function(e){let t=new Uint8Array(V.from(e,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),i=new Uint8Array(r.length+t.length);i.set(r),i.set(t,r.length);let n=t8(i,{dkLen:32});return k.Z.encode(n)}(t.transactionBytes)];if("near_signTransaction"===i)return[re(t)];if("near_signTransactions"===i)return t.map(e=>re(e));if("xrpl_signTransactionFor"===i||"xrpl_signTransaction"===i)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===i)return[function(e){let t=Uint8Array.from(V.from(e.signature,"hex")),r=function({publicKey:e,signature:t,payload:r}){var i,n;let s=sE(r.method),o=128|parseInt((null==(i=r.version)?void 0:i.toString())||"4"),a=function(e){let t=k.Z.decode(e)[0];return 42===t?0:60===t?2:1}(r.address),c="00"===r.era?new Uint8Array([0]):sE(r.era);if(1!==c.length&&2!==c.length)throw Error("Invalid era length");let l=parseInt(r.nonce,16),u=new Uint8Array([255&l,l>>8&255]),h=new Uint8Array([0,...e,a,...t,...c,...u,...function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){let t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){let t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw Error("BigInt compact encoding not supported > 2^30")}(BigInt(`0x${(n=r.tip).startsWith("0x")?n.slice(2):n}`)),...s]);return new Uint8Array([...function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){let t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<1073741824){let t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw Error("Compact encoding > 2^30 not supported")}(h.length+1),o,...h])}({publicKey:function(e){let t=k.Z.decode(e);if(t.length<33)throw Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),signature:t,payload:e.transaction});return function(e){let t=sE(e),r=(0,q.blake2b)(t,void 0,32);return"0x"+V.from(r).toString("hex")}(V.from(r).toString("hex"))}({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===i)return si(t)?t.map(e=>rt(e)):[rt(t)];if("cosmos_signDirect"===i)return[function(e){let t=V.from(e.signed.bodyBytes,"base64"),r=V.from(e.signed.authInfoBytes,"base64"),i=V.from(e.signature.signature,"base64"),n=[];n.push(V.from([10])),n.push(rr(t.length)),n.push(t),n.push(V.from([18])),n.push(rr(r.length)),n.push(r),n.push(V.from([26])),n.push(rr(i.length)),n.push(i);let s=tW(V.concat(n));return V.from(s).toString("hex").toUpperCase()}(t)];if("wallet_sendCalls"===i)return function(e){var t,r;let i=[];try{if("string"==typeof e)return i.push(e),i;if("object"!=typeof e)return i;null!=e&&e.id&&i.push(e.id);let n=null==(r=null==(t=e?.capabilities)?void 0:t.caip345)?void 0:r.transactionHashes;n&&i.push(...n)}catch(e){console.warn("getWalletSendCallsHashes failed: ",e)}return i}(t);if("string"==typeof t)return[t];let s=t[n.key];if(si(s))return"solana_signAllTransactions"===i?s.map(e=>(function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=r[0];if(0===i)throw Error("No signatures found");if(r.length<1+64*i)throw Error("Transaction data too short for claimed signature count");if(r.length<100)throw Error("Transaction too short");let n=V.from(e,"base64").slice(1,65);return k.Z.encode(n)})(e)):s;if("string"==typeof s)return[s]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,r]of Object.entries(t))for(let t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){let{message:e}=st("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(s9.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:n}=e,{publicKey:s}=this.client.auth.authKeys.keys.includes(c2)?this.client.auth.authKeys.get(c2):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:s,encoding:n===ot.link_mode?nx:nE});(0,sZ.isJsonRpcRequest)(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:n,encryptedId:n_(r)})):(0,sZ.isJsonRpcResponse)(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:n}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:n}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(oc.expired,async e=>{let{topic:t,id:r}=em(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,st("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,st("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(oo.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(oo.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!so(e,!1)){let{message:t}=st("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=st("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=st("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!so(e,!1)){let{message:t}=st("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=st("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=st("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=st("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(so(e,!1)){let{message:t}=st("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=st("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=st("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=st("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=st("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class ln extends ca{constructor(e,t){super(e,t,"proposal",cK),this.core=e,this.logger=t}}class ls extends ca{constructor(e,t){super(e,t,"session",cK),this.core=e,this.logger=t}}class lo extends ca{constructor(e,t){super(e,t,"request",cK,e=>e.id),this.core=e,this.logger=t}}class la extends ca{constructor(e,t){super(e,t,"authKeys",c1,()=>c2),this.core=e,this.logger=t}}class lc extends ca{constructor(e,t){super(e,t,"pairingTopics",c1),this.core=e,this.logger=t}}class ll extends ca{constructor(e,t){super(e,t,"requests",c1,e=>e.id),this.core=e,this.logger=t}}var lu=Object.defineProperty,lh=(e,t,r)=>t in e?lu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lf=(e,t,r)=>lh(e,"symbol"!=typeof t?t+"":t,r);class ld{constructor(e,t){this.core=e,this.logger=t,lf(this,"authKeys"),lf(this,"pairingTopics"),lf(this,"requests"),this.authKeys=new la(this.core,this.logger),this.pairingTopics=new lc(this.core,this.logger),this.requests=new ll(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var lp=Object.defineProperty,lg=(e,t,r)=>t in e?lp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ly=(e,t,r)=>lg(e,"symbol"!=typeof t?t+"":t,r);class lb extends sH{constructor(e){super(e),ly(this,"protocol","wc"),ly(this,"version",2),ly(this,"name",cH.name),ly(this,"metadata"),ly(this,"core"),ly(this,"logger"),ly(this,"events",new n.EventEmitter),ly(this,"engine"),ly(this,"session"),ly(this,"proposal"),ly(this,"pendingRequest"),ly(this,"auth"),ly(this,"signConfig"),ly(this,"on",(e,t)=>this.events.on(e,t)),ly(this,"once",(e,t)=>this.events.once(e,t)),ly(this,"off",(e,t)=>this.events.off(e,t)),ly(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),ly(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),ly(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),ly(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),ly(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||cH.name,this.metadata=function(e){var t,r;let i=eu();try{return null!=e&&e.url&&i.url&&new URL(e.url).host!==new URL(i.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),e.url=i.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),er(et(et({},i),e),{url:e?.url||i.url,name:e?.name||i.name,description:e?.description||i.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:i.icons})}catch(t){return console.warn("Error populating app metadata",t),e||i}}(e?.metadata),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,sS.gw)((0,sS.jI)({level:e?.logger||cH.logger}));this.core=e?.core||new cF(e),this.logger=(0,sS.Ep)(t,this.name),this.session=new ls(this.core,this.logger),this.proposal=new ln(this.core,this.logger),this.pendingRequest=new lo(this.core,this.logger),this.engine=new li(this),this.auth=new ld(this.core,this.logger)}static async init(e){let t=new lb(e);return await t.initialize(),t}get context(){return(0,sS.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var lm=r(5071),lw=r(84398).lW;let lv="error",lE="".concat("wc","@2:").concat("universal_provider",":"),lx="https://rpc.walletconnect.org/v1/",lI="generic",lS="".concat(lx,"bundler"),lO="call_status",l_="default_chain_changed";function lP(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function lA(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function lD(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let lR="[object String]",lC="[object Number]",lB="[object Boolean]",lU="[object Arguments]";function lT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function lN(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,s=null==n?void 0:n(e,t,r,i);if(null!=s)return s;if(lP(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){let t=Array(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=lN(e[s],s,r,i,n);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[s,o]of(i.set(e,t),e))t.set(s,lN(o,s,r,i,n));return t}if(e instanceof Set){let t=new Set;for(let s of(i.set(e,t),e))t.add(lN(s,void 0,r,i,n));return t}if("u">typeof lw&&lw.isBuffer(e))return e.subarray();if(lT(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);i.set(e,t);for(let s=0;s<e.length;s++)t[s]=lN(e[s],s,r,i,n);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),lk(t,e,r,i,n),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return i.set(e,t),lk(t,e,r,i,n),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return i.set(e,t),lk(t,e,r,i,n),t}if(e instanceof Error){let t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,lk(t,e,r,i,n),t}if("object"==typeof e&&function(e){switch(lD(e)){case lU:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case lB:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case lC:case"[object Object]":case"[object RegExp]":case"[object Set]":case lR:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),lk(t,e,r,i,n),t}return e}function lk(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,s=[...Object.keys(t),...lA(t)];for(let o=0;o<s.length;o++){let a=s[o],c=Object.getOwnPropertyDescriptor(e,a);(null==c||c.writable)&&(e[a]=lN(t[a],a,r,i,n))}}function lj(e){var t;return t=(t,r,i,n)=>{let s=void 0;if(null!=s)return s;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case lC:case lR:case lB:{let t=new e.constructor(null==e?void 0:e.valueOf());return lk(t,e),t}case lU:{let t={};return lk(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}},lN(e,void 0,e,new Map,t)}function lL(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===lD(e)}function l$(e){return"object"==typeof e&&null!==e}function lM(){}var lz=Object.defineProperty,lq=Object.defineProperties,lF=Object.getOwnPropertyDescriptors,lV=Object.getOwnPropertySymbols,lK=Object.prototype.hasOwnProperty,lH=Object.prototype.propertyIsEnumerable,lG=(e,t,r)=>t in e?lz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,lW=(e,t)=>{for(var r in t||(t={}))lK.call(t,r)&&lG(e,r,t[r]);if(lV)for(var r of lV(t))lH.call(t,r)&&lG(e,r,t[r]);return e},lJ=(e,t)=>lq(e,lF(t));function lZ(e,t,r){var i;let n=K(e);return(null==(i=t.rpcMap)?void 0:i[n.reference])||"".concat(lx,"?chainId=").concat(n.namespace,":").concat(n.reference,"&projectId=").concat(r)}function lY(e){return e.map(e=>"".concat(e.split(":")[0],":").concat(e.split(":")[1]))}function lQ(e){return Object.fromEntries(Object.entries(e).filter(e=>{var t,r;let[i,n]=e;return(null==(t=null==n?void 0:n.chains)?void 0:t.length)&&(null==(r=null==n?void 0:n.chains)?void 0:r.length)>0}))}function lX(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n=r.slice(0,-1),s=r[r.length-1],o=e;for(let e=0;e<n.length;e++)o=function e(t,r,i,n){if(lP(t)&&(t=Object(t)),null==r||"object"!=typeof r)return t;if(n.has(r))return function(e){if(lP(e))return e;if(Array.isArray(e)||lT(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){let t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}return"u">typeof File&&e instanceof File?new r([e],e.name,{type:e.type,lastModified:e.lastModified}):"object"==typeof e?Object.assign(Object.create(t),e):e}(n.get(r));if(n.set(r,t),Array.isArray(r)){var s;r=r.slice();for(let e=0;e<r.length;e++)r[e]=null!==(s=r[e])&&void 0!==s?s:void 0}let o=[...Object.keys(r),...lA(r)];for(let s=0;s<o.length;s++){let a=o[s],c=r[a],l=t[a];if(lL(c)&&(c={...c}),lL(l)&&(l={...l}),"u">typeof lw&&lw.isBuffer(c)&&(c=lj(c)),Array.isArray(c)){if("object"==typeof l&&null!=l){let e=[],t=Reflect.ownKeys(l);for(let r=0;r<t.length;r++){let i=t[r];e[i]=l[i]}l=e}else l=[]}let u=i(l,c,a,t,r,n);null!=u?t[a]=u:Array.isArray(c)||l$(l)&&l$(c)?t[a]=e(l,c,i,n):null==l&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){var t;let r=e[Symbol.toStringTag];return null!=r&&null!==(t=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))&&void 0!==t&&!!t.writable&&e.toString()==="[object ".concat(r,"]")}let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}(c)?t[a]=e({},c,i,n):null==l&&lT(c)?t[a]=lj(c):(void 0===l||void 0!==c)&&(t[a]=c)}return t}(o,n[e],s,new Map);return o}(e,...r,lM)}(lQ(l0(e)),lQ(l0(t)))}function l0(e){var t,r,i,n,s;let o={};if(!sn(e))return o;for(let[a,c]of Object.entries(e)){let e=n8(a)?[a]:c.chains,l=c.methods||[],u=c.events||[],h=c.rpcMap||{},f=n3(a);o[f]=lJ(lW(lW({},o[f]),c),{chains:ex(e,null==(t=o[f])?void 0:t.chains),methods:ex(l,null==(r=o[f])?void 0:r.methods),events:ex(u,null==(i=o[f])?void 0:i.events)}),(sn(h)||sn((null==(n=o[f])?void 0:n.rpcMap)||{}))&&(o[f].rpcMap=lW(lW({},h),null==(s=o[f])?void 0:s.rpcMap))}return o}function l1(e){return e.includes(":")?e.split(":")[2]:e}function l2(e){let t={};for(let[r,i]of Object.entries(e)){let e=i.methods||[],n=i.events||[],s=i.accounts||[],o=n8(r)?[r]:i.chains?i.chains:lY(i.accounts);t[r]={chains:o,methods:e,events:n,accounts:s}}return t}function l5(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let l6={},l8=e=>l6[e],l3=(e,t)=>{l6[e]=t};var l4=Object.defineProperty,l9=Object.getOwnPropertySymbols,l7=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,ut=(e,t,r)=>t in e?l4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ur=(e,t)=>{for(var r in t||(t={}))l7.call(t,r)&&ut(e,r,t[r]);if(l9)for(var r of l9(t))ue.call(t,r)&&ut(e,r,t[r]);return e};let ui="eip155",un=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],us=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,uo=e=>e&&e.startsWith("0x")?e:"0x".concat(BigInt(e).toString(16)),ua=e=>Object.keys(e).filter(e=>un.includes(e)).reduce((t,r)=>(t[r]=uc(e[r]),t),{}),uc=e=>"string"==typeof e&&function(e){try{let t=JSON.parse(e);return"object"==typeof t&&null!==t&&!Array.isArray(t)}catch(e){return!1}}(e)?JSON.parse(e):e,ul=(e,t,r)=>{let{sessionProperties:i={},scopedProperties:n={}}=e,s={};if(!sn(n)&&!sn(i))return;let o=ua(i);for(let e of r){let r=us(e);if(!r)continue;s[uo(r)]=o;let i=null==n?void 0:n["".concat(ui,":").concat(r)];if(i){let e=null==i?void 0:i["".concat(ui,":").concat(r,":").concat(t)];s[uo(r)]=ur(ur({},s[uo(r)]),ua(e||i))}}for(let[e,t]of Object.entries(s))0===Object.keys(t).length&&delete s[e];return Object.keys(s).length>0?s:void 0};var uu=Object.defineProperty,uh=(e,t,r)=>t in e?uu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uf=(e,t,r)=>uh(e,"symbol"!=typeof t?t+"":t,r);class ud{async getItem(e){return await this.storage.getItem(e)}async setItem(e,t){return await this.storage.setItem(e,t)}async removeItem(e){return await this.storage.removeItem(e)}static getStorage(e){return i||(i=new ud(e)),i}constructor(e){uf(this,"storage"),this.storage=e}}var up=Object.defineProperty,ug=Object.defineProperties,uy=Object.getOwnPropertyDescriptors,ub=Object.getOwnPropertySymbols,um=Object.prototype.hasOwnProperty,uw=Object.prototype.propertyIsEnumerable,uv=(e,t,r)=>t in e?up(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uE=(e,t)=>{for(var r in t||(t={}))um.call(t,r)&&uv(e,r,t[r]);if(ub)for(var r of ub(t))uw.call(t,r)&&uv(e,r,t[r]);return e},ux=(e,t)=>ug(e,uy(t));async function uI(e,t){let r;let i=K(e.result.capabilities.caip345.caip2),n=e.result.capabilities.caip345.transactionHashes,s=await Promise.allSettled(n.map(e=>uS(i.reference,e,t))),o=s.filter(e=>"fulfilled"===e.status).map(e=>e.value).filter(e=>e);s.filter(e=>"rejected"===e.status).forEach(e=>console.warn("Failed to fetch transaction receipt:",e.reason));let a=!o.length||o.some(e=>!e),c=o.every(e=>(null==e?void 0:e.status)==="0x1"),l=o.every(e=>(null==e?void 0:e.status)==="0x0"),u=o.some(e=>(null==e?void 0:e.status)==="0x0");return a?r=100:c?r=200:l?r=500:u&&(r=600),{id:e.result.id,version:e.request.version,atomic:e.request.atomicRequired,chainId:e.request.chainId,capabilities:e.result.capabilities,receipts:o,status:r}}async function uS(e,t,r){return await r(parseInt(e)).request((0,sZ.formatJsonRpcRequest)("eth_getTransactionReceipt",[t]))}async function uO(e){let{sendCalls:t,storage:r}=e,i=await r.getItem(lO);await r.setItem(lO,ux(uE({},i),{[t.result.id]:{request:t.request,result:t.result,expiry:ew(86400)}}))}async function u_(e){let{resultId:t,storage:r}=e,i=await r.getItem(lO);if(i){for(let e in delete i[t],await r.setItem(lO,i),i)ev(i[e].expiry)&&delete i[e];await r.setItem(lO,i)}}async function uP(e){let{resultId:t,storage:r}=e,i=await r.getItem(lO),n=null==i?void 0:i[t];if(n&&!ev(n.expiry))return n;await u_({resultId:t,storage:r})}var uA=Object.defineProperty,uD=Object.defineProperties,uR=Object.getOwnPropertyDescriptors,uC=Object.getOwnPropertySymbols,uB=Object.prototype.hasOwnProperty,uU=Object.prototype.propertyIsEnumerable,uT=(e,t,r)=>t in e?uA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uN=(e,t)=>{for(var r in t||(t={}))uB.call(t,r)&&uT(e,r,t[r]);if(uC)for(var r of uC(t))uU.call(t,r)&&uT(e,r,t[r]);return e},uk=(e,t)=>uD(e,uR(t)),uj=(e,t,r)=>uT(e,"symbol"!=typeof t?t+"":t,r);class uL{async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e);case"wallet_sendCalls":return await this.sendCalls(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t);let r=this.chainId;this.chainId=parseInt(e),this.events.emit(l_,{currentCaipChainId:"".concat(this.name,":").concat(e),previousCaipChainId:"".concat(this.name,":").concat(r)})}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||lZ("".concat(this.name,":").concat(e),this.namespace,this.client.core.projectId);if(!r)throw Error("No RPC url provided for chainId: ".concat(e));return new sJ.r(new lm.k(r,l8("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(t.includes(":")?t.split(":")[1]:t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(e){let t=e||this.chainId;return this.httpProviders[t]||(this.httpProviders=uk(uN({},this.httpProviders),{[t]:this.createHttpProvider(t)}),this.httpProviders[t])}async handleSwitchChain(e){var t,r;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",n=parseInt(i=i.startsWith("0x")?i:"0x".concat(i),16);if(this.isChainApproved(n))this.setDefaultChain("".concat(n));else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain("".concat(n));else throw Error("Failed to switch to chain 'eip155:".concat(n,"'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method."));return null}isChainApproved(e){return this.namespace.chains.includes("".concat(this.name,":").concat(e))}async getCapabilities(e){var t,r,i,n,s;let o;let a=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0],c=(null==(n=null==(i=e.request)?void 0:i.params)?void 0:n[1])||[];if(!a)throw Error("Missing address parameter in `wallet_getCapabilities` request");let l=this.client.session.get(e.topic),u=(null==(s=null==l?void 0:l.sessionProperties)?void 0:s.capabilities)||{},h="".concat(a).concat(c.join(",")),f=null==u?void 0:u[h];if(f)return f;try{o=ul(l,a,c)}catch(e){console.warn("Failed to extract capabilities from session",e)}if(o)return o;let d=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:uk(uN({},l.sessionProperties||{}),{capabilities:uk(uN({},u||{}),{[h]:d})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return d}async getCallStatus(e){var t,r,i;let n=this.client.session.get(e.topic),s=null==(t=n.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let o=null==(r=n.sessionProperties)?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,o)}let a=await uP({resultId:null==(i=e.request.params)?void 0:i[0],storage:this.storage});if(a)try{return await uI(a,this.getHttpProvider.bind(this))}catch(e){console.warn("Failed to fetch call status from stored send calls",e,a)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,sZ.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!n.ok)throw Error("Failed to fetch user operation receipt - ".concat(n.status));return await n.json()}getBundlerUrl(e,t){return"".concat(lS,"?projectId=").concat(this.client.core.projectId,"&chainId=").concat(e,"&bundler=").concat(t)}async sendCalls(e){var t,r,i;let n=await this.client.request(e),s=null==(t=e.request.params)?void 0:t[0],o=null==n?void 0:n.id,a=(null==n?void 0:n.capabilities)||{},c=null==(r=null==a?void 0:a.caip345)?void 0:r.caip2,l=null==(i=null==a?void 0:a.caip345)?void 0:i.transactionHashes;return o&&c&&null!=l&&l.length&&await uO({sendCalls:{request:s,result:n},storage:this.storage}),n}constructor(e){uj(this,"name","eip155"),uj(this,"client"),uj(this,"chainId"),uj(this,"namespace"),uj(this,"httpProviders"),uj(this,"events"),uj(this,"storage"),this.namespace=e.namespace,this.events=l8("events"),this.client=l8("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain()),this.storage=ud.getStorage(this.client.core.storage)}}var u$=Object.defineProperty,uM=(e,t,r)=>t in e?u$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uz=(e,t,r)=>uM(e,"symbol"!=typeof t?t+"":t,r);class uq{updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t);let r=this.chainId;this.chainId=e,this.events.emit(l_,{currentCaipChainId:"".concat(this.name,":").concat(e),previousCaipChainId:"".concat(this.name,":").concat(r)})}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return K(e).namespace}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{var t,i;let n=K(e),s=null==(i=null==(t=this.namespace)?void 0:t.rpcMap)?void 0:i["".concat(n.namespace,":").concat(n.reference)];r[n.reference]=this.createHttpProvider(e,s)}),r}getHttpProvider(e){let t=K(e).reference,r=this.httpProviders[t];if(typeof r>"u")throw Error("JSON-RPC provider for ".concat(e," not found"));return r}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||lZ(e,this.namespace,this.client.core.projectId);if(!r)throw Error("No RPC url provided for chainId: ".concat(e));return new sJ.r(new lm.Z(r,l8("disableProviderPing")))}constructor(e){uz(this,"name",lI),uz(this,"client"),uz(this,"httpProviders"),uz(this,"events"),uz(this,"namespace"),uz(this,"chainId"),this.namespace=e.namespace,this.events=l8("events"),this.client=l8("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}}var uF=Object.defineProperty,uV=Object.defineProperties,uK=Object.getOwnPropertyDescriptors,uH=Object.getOwnPropertySymbols,uG=Object.prototype.hasOwnProperty,uW=Object.prototype.propertyIsEnumerable,uJ=(e,t,r)=>t in e?uF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uZ=(e,t)=>{for(var r in t||(t={}))uG.call(t,r)&&uJ(e,r,t[r]);if(uH)for(var r of uH(t))uW.call(t,r)&&uJ(e,r,t[r]);return e},uY=(e,t)=>uV(e,uK(t)),uQ=(e,t,r)=>uJ(e,"symbol"!=typeof t?t+"":t,r);class uX{static async init(e){let t=new uX(e);return await t.initialize(),t}async request(e,t,r){let[i,n]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:uZ({},e),chainId:"".concat(i,":").concat(n),topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let n=new Date().getTime();this.request(e,r,i).then(e=>t(null,(0,sZ.formatJsonRpcResult)(n,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:sr("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let n=await i();if(this.session=n.session,this.session){let e=l2(this.session.namespaces);this.namespaces=lX(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return n}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let n=l2(i.namespaces);return this.namespaces=lX(this.namespaces,n),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e);this.getProvider(r).setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(!si(t))return;for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info("Inactive pairings cleared: ".concat(t.length))}catch(e){this.logger.warn("Failed to cleanup pending pairings",e)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await lb.init({core:this.providerOpts.core,logger:this.providerOpts.logger||lv,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),Error("The provided session: ".concat(null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic," doesn't exist in the Sign client"))}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>n3(e)))];l3("client",this.client),l3("events",this.events),l3("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];let i=[];return r.forEach(e=>{let r=t.namespaces[e].accounts;i.push(...r)}),i}(e,this.session);if((null==t?void 0:t.length)===0)return;let r=lY(t),i=uY(uZ({},lX(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:r});"eip155"===e?this.rpcProviders[e]=new uL({namespace:i}):this.rpcProviders[e]=new uq({namespace:i})})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{event:n}=r;if("accountsChanged"===n.name){let e=n.data;e&&si(e)&&this.events.emit("accountsChanged",e.map(l1))}else if("chainChanged"===n.name){let e=r.chainId,t=r.event.data,i=n3(e),n=l5(e)!==l5(t)?"".concat(i,":").concat(l5(t)):e;this.onChainChanged({currentCaipChainId:n})}else this.events.emit(n.name,n.data);this.events.emit("session_event",e)}),this.client.on("session_update",e=>{var t,r;let{topic:i,params:n}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{namespaces:s}=n,o=null==(r=this.client)?void 0:r.session.get(i);this.session=uY(uZ({},o),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:n})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",uY(uZ({},sr("USER_DISCONNECTED")),{data:e.topic})))}),this.on(l_,e=>{this.onChainChanged(uY(uZ({},e),{internal:!0}))})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[lI]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t={},optionalNamespaces:r={},sessionProperties:i,scopedProperties:n}=e;this.optionalNamespaces=lX(t,r),this.sessionProperties=i,this.scopedProperties=n}validateChain(e){let[t,r]=(null==e?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>n3(e)).includes(t))throw Error("Namespace '".concat(t,"' is not configured. Please call connect() first with namespace config."));if(t&&r)return[t,r];let i=n3(Object.keys(this.namespaces)[0]),n=this.rpcProviders[i].getDefaultChain();return[i,n]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e){let{currentCaipChainId:t,previousCaipChainId:r,internal:i=!1}=e;if(!this.namespaces)return;let[n,s]=this.validateChain(t);s&&(this.updateNamespaceChain(n,s),i?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:n,currentCaipChainId:t,previousCaipChainId:r})):this.getProvider(n).setDefaultChain(s),await this.persist("namespaces",this.namespaces))}emitAccountsChangedOnChainChange(e){var t,r;let{namespace:i,currentCaipChainId:n,previousCaipChainId:s}=e;try{if(s===n)return;let e=null==(r=null==(t=this.session)?void 0:t.namespaces[i])?void 0:r.accounts;if(!e)return;let o=e.filter(e=>e.includes("".concat(n,":"))).map(l1);if(!si(o))return;this.events.emit("accountsChanged",o)}catch(e){this.logger.warn("Failed to emit accountsChanged on chain change",e)}}updateNamespaceChain(e,t){if(!this.namespaces)return;let r=this.namespaces[e]?e:"".concat(e,":").concat(t);this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]={chains:[],methods:[],events:[],defaultChain:t}}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem("".concat(lE,"/").concat(e).concat(i),t)}async getFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem("".concat(lE,"/").concat(e).concat(r))}async deleteFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem("".concat(lE,"/").concat(e).concat(r))}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;for(let e of(await this.client.core.storage.getKeys()))e.startsWith(lE)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}constructor(e){uQ(this,"client"),uQ(this,"namespaces"),uQ(this,"optionalNamespaces"),uQ(this,"sessionProperties"),uQ(this,"scopedProperties"),uQ(this,"events",new(s())),uQ(this,"rpcProviders",{}),uQ(this,"session"),uQ(this,"providerOpts"),uQ(this,"logger"),uQ(this,"uri"),uQ(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof(null==e?void 0:e.logger)&&"string"!=typeof(null==e?void 0:e.logger)?e.logger:(0,sS.gw)((0,sS.jI)({level:(null==e?void 0:e.logger)||lv})),this.disableProviderPing=(null==e?void 0:e.disableProviderPing)||!1}}let u0="".concat("wc","@2:").concat("ethereum_provider",":"),u1=["eth_sendTransaction","personal_sign"],u2=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],u5=["chainChanged","accountsChanged"],u6=["chainChanged","accountsChanged","message","disconnect","connect"],u8=async()=>{let{createAppKit:e}=await r.e(1097).then(r.bind(r,51097));return e};var u3=Object.defineProperty,u4=Object.defineProperties,u9=Object.getOwnPropertyDescriptors,u7=Object.getOwnPropertySymbols,he=Object.prototype.hasOwnProperty,ht=Object.prototype.propertyIsEnumerable,hr=(e,t,r)=>t in e?u3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hi=(e,t)=>{for(var r in t||(t={}))he.call(t,r)&&hr(e,r,t[r]);if(u7)for(var r of u7(t))ht.call(t,r)&&hr(e,r,t[r]);return e},hn=(e,t)=>u4(e,u9(t)),hs=(e,t,r)=>hr(e,"symbol"!=typeof t?t+"":t,r);function ho(e){return Number(e[0].split(":")[1])}function ha(e){return"0x".concat(e.toString(16))}class hc{static async init(e){let t=new hc;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,r){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),r)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){var t;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);let{required:r,optional:i}=function(e){let{chains:t,optionalChains:r,methods:i,optionalMethods:n,events:s,optionalEvents:o,rpcMap:a}=e;if(!si(t))throw Error("Invalid chains");let c={chains:t,methods:i||u1,events:s||u5,rpcMap:hi({},t.length?{[ho(t)]:a[ho(t)]}:{})},l=null==s?void 0:s.filter(e=>!u5.includes(e)),u=null==i?void 0:i.filter(e=>!u1.includes(e));if(!r&&!o&&!n&&!(null!=l&&l.length)&&!(null!=u&&u.length))return{required:t.length?c:void 0};let h={chains:[...new Set((null==l?void 0:l.length)&&(null==u?void 0:u.length)||!r?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(null!=n&&n.length?n:u2))],events:[...new Set(c.events.concat(null!=o&&o.length?o:u6))],rpcMap:a};return{required:t.length?c:void 0,optional:r.length?h:void 0}}(this.rpc);try{let t=await new Promise(async(t,n)=>{var s,o;this.rpc.showQrModal&&(null==(s=this.modal)||s.open(),null==(o=this.modal)||o.subscribeState(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),n(Error("Connection request reset. Please try again.")))}));let a=null!=e&&e.scopedProperties?{[this.namespace]:e.scopedProperties}:void 0;await this.signer.connect(hn(hi({namespaces:hi({},r&&{[this.namespace]:r})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:null==e?void 0:e.pairingTopic,scopedProperties:a})).then(e=>{t(e)}).catch(e=>{var t;null==(t=this.modal)||t.showErrorMessage("Unable to connect"),n(Error(e.message))})});if(!t)return;let n=H(t.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:n),this.setAccounts(n),this.events.emit("connect",{chainId:ha(this.chainId)})}catch(e){throw this.signer.logger.error(e),e}finally{null==(t=this.modal)||t.close()}}async authenticate(e,t){var r;if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:null==e?void 0:e.chains});try{let r=await new Promise(async(r,i)=>{var n,s;this.rpc.showQrModal&&(null==(n=this.modal)||n.open(),null==(s=this.modal)||s.subscribeState(e=>{e.open||this.signer.session||(this.signer.abortPairingAttempt(),i(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(hn(hi({},e),{chains:this.rpc.chains}),t).then(e=>{r(e)}).catch(e=>{var t;null==(t=this.modal)||t.showErrorMessage("Unable to connect"),i(Error(e.message))})}),i=r.session;if(i){let e=H(i.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:e),this.setAccounts(e),this.events.emit("connect",{chainId:ha(this.chainId)})}return r}catch(e){throw this.signer.logger.error(e),e}finally{null==(r=this.modal)||r.close()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{let{params:t}=e,{event:r}=t;"accountsChanged"===r.name?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===r.name?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",e)}),this.signer.on("accountsChanged",e=>{this.accounts=this.parseAccounts(e),this.events.emit("accountsChanged",this.accounts)}),this.signer.on("chainChanged",e=>{let t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",ha(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",hn(hi({},sr("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return"string"==typeof e&&e.startsWith("".concat(this.namespace,":"))}formatChainId(e){return"".concat(this.namespace,":").concat(e)}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){let t=e.filter(e=>this.isCompatibleChainId(e)).map(e=>this.parseChainId(e));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",ha(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){let t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){let[t,r,i]=e.split(":");return{chainId:"".concat(t,":").concat(r),address:i}}setAccounts(e){this.accounts=e.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,r;let i=null!=(t=null==e?void 0:e.chains)?t:[],n=null!=(r=null==e?void 0:e.optionalChains)?r:[],s=i.concat(n);if(!s.length)throw Error("No chains specified in either `chains` or `optionalChains`");let o=i.length?(null==e?void 0:e.methods)||u1:[],a=i.length?(null==e?void 0:e.events)||u5:[],c=(null==e?void 0:e.optionalMethods)||[],l=(null==e?void 0:e.optionalEvents)||[],u=(null==e?void 0:e.rpcMap)||this.buildRpcMap(s,e.projectId),h=(null==e?void 0:e.qrModalOptions)||void 0;return{chains:null==i?void 0:i.map(e=>this.formatChainId(e)),optionalChains:n.map(e=>this.formatChainId(e)),methods:o,events:a,optionalMethods:c,optionalEvents:l,rpcMap:u,showQrModal:!!(null!=e&&e.showQrModal),qrModalOptions:h,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){let r={};return e.forEach(e=>{r[e]=this.getRpcUrl(e,t)}),r}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ho(this.rpc.chains):ho(this.rpc.optionalChains),this.signer=await uX.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storage:e.storage,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{let t=await u8(),{convertWCMToAppKitOptions:r}=await Promise.resolve().then(function(){return hE}),i=r(hn(hi({},this.rpc.qrModalOptions),{chains:[...new Set([...this.rpc.chains,...this.rpc.optionalChains])],metadata:this.rpc.metadata,projectId:this.rpc.projectId}));if(!i.networks.length)throw Error("No networks found for WalletConnect\xb7");e=t(hn(hi({},i),{universalProvider:this.signer,manualWCControl:!0}))}catch(e){throw console.warn(e),Error("To use QR modal, please install @reown/appkit package")}if(e)try{this.modal=e}catch(e){throw this.signer.logger.error(e),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;let{chains:t,optionalChains:r,rpcMap:i}=e;t&&si(t)&&(this.rpc.chains=t.map(e=>this.formatChainId(e)),t.forEach(e=>{this.rpc.rpcMap[e]=(null==i?void 0:i[e])||this.getRpcUrl(e)})),r&&si(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==r?void 0:r.map(e=>this.formatChainId(e)),r.forEach(e=>{this.rpc.rpcMap[e]=(null==i?void 0:i[e])||this.getRpcUrl(e)}))}getRpcUrl(e,t){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[e])||"".concat("https://rpc.walletconnect.org/v1/","?chainId=eip155:").concat(e,"&projectId=").concat(t||this.rpc.projectId)}async loadPersistedSession(){if(this.session)try{let e=await this.signer.client.core.storage.getItem("".concat(this.STORAGE_KEY,"/chainId")),t=this.session.namespaces["".concat(this.namespace,":").concat(e)]?this.session.namespaces["".concat(this.namespace,":").concat(e)]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:null==t?void 0:t.accounts),this.setAccounts(null==t?void 0:t.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem("".concat(this.STORAGE_KEY,"/chainId"),this.chainId)}parseAccounts(e){return"string"==typeof e||e instanceof String?[this.parseAccount(e)]:e.map(e=>this.parseAccount(e))}constructor(){hs(this,"events",new n.EventEmitter),hs(this,"namespace","eip155"),hs(this,"accounts",[]),hs(this,"signer"),hs(this,"chainId",1),hs(this,"modal"),hs(this,"rpc"),hs(this,"STORAGE_KEY",u0),hs(this,"on",(e,t)=>(this.events.on(e,t),this)),hs(this,"once",(e,t)=>(this.events.once(e,t),this)),hs(this,"removeListener",(e,t)=>(this.events.removeListener(e,t),this)),hs(this,"off",(e,t)=>(this.events.off(e,t),this)),hs(this,"parseAccount",e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e),this.signer={},this.rpc={}}}let hl=hc;var hu=Object.defineProperty,hh=Object.defineProperties,hf=Object.getOwnPropertyDescriptors,hd=Object.getOwnPropertySymbols,hp=Object.prototype.hasOwnProperty,hg=Object.prototype.propertyIsEnumerable,hy=(e,t,r)=>t in e?hu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hb=(e,t)=>{for(var r in t||(t={}))hp.call(t,r)&&hy(e,r,t[r]);if(hd)for(var r of hd(t))hg.call(t,r)&&hy(e,r,t[r]);return e},hm=(e,t)=>hh(e,hf(t));let hw=e=>{let[t,r]=e.split(":");return hv({id:r,caipNetworkId:e,chainNamespace:t,name:"",nativeCurrency:{name:"",symbol:"",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}})};function hv(e){return hb({formatters:void 0,fees:void 0,serializers:void 0},e)}var hE=Object.freeze({__proto__:null,convertWCMToAppKitOptions:function(e){var t,r,i,n,s,o,a;let c=null==(t=e.chains)?void 0:t.map(hw).filter(Boolean);if(0===c.length)throw Error("At least one chain must be specified");let l=c.find(t=>{var r;return t.id===(null==(r=e.defaultChain)?void 0:r.id)}),u={projectId:e.projectId,networks:c,themeMode:e.themeMode,themeVariables:function(e){if(e)return{"--w3m-font-family":e["--wcm-font-family"],"--w3m-accent":e["--wcm-accent-color"],"--w3m-color-mix":e["--wcm-background-color"],"--w3m-z-index":e["--wcm-z-index"]?Number(e["--wcm-z-index"]):void 0,"--w3m-qr-color":e["--wcm-accent-color"],"--w3m-font-size-master":e["--wcm-text-medium-regular-size"],"--w3m-border-radius-master":e["--wcm-container-border-radius"],"--w3m-color-mix-strength":0}}(e.themeVariables),chainImages:e.chainImages,connectorImages:e.walletImages,defaultNetwork:l,metadata:hm(hb({},e.metadata),{name:(null==(r=e.metadata)?void 0:r.name)||"WalletConnect",description:(null==(i=e.metadata)?void 0:i.description)||"Connect to WalletConnect-compatible wallets",url:(null==(n=e.metadata)?void 0:n.url)||"https://walletconnect.org",icons:(null==(s=e.metadata)?void 0:s.icons)||["https://walletconnect.org/walletconnect-logo.png"]}),showWallets:!0,featuredWalletIds:"NONE"===e.explorerRecommendedWalletIds?[]:Array.isArray(e.explorerRecommendedWalletIds)?e.explorerRecommendedWalletIds:[],excludeWalletIds:"ALL"===e.explorerExcludedWalletIds?[]:Array.isArray(e.explorerExcludedWalletIds)?e.explorerExcludedWalletIds:[],enableEIP6963:!1,enableInjected:!1,enableCoinbase:!0,enableWalletConnect:!0,features:{email:!1,socials:!1}};if(null!=(o=e.mobileWallets)&&o.length||null!=(a=e.desktopWallets)&&a.length){let t=[...(e.mobileWallets||[]).map(e=>({id:e.id,name:e.name,links:e.links})),...(e.desktopWallets||[]).map(e=>({id:e.id,name:e.name,links:{native:e.links.native,universal:e.links.universal}}))],r=[...u.featuredWalletIds||[],...u.excludeWalletIds||[]],i=t.filter(e=>!r.includes(e.id));i.length&&(u.customWallets=i)}return u},defineChain:hv})},84398:function(e,t,r){"use strict";let i=r(59196),n=r(68848),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!a.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|p(e,t),i=o(r),n=i.write(e,t);return n!==r&&(i=i.slice(0,n)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(j(e,Uint8Array)){let t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(j(e,ArrayBuffer)||e&&j(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(j(e,SharedArrayBuffer)||e&&j(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return a.from(i,t,r);let n=function(e){var t;if(a.isBuffer(e)){let t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),o(e<0?0:0|d(e))}function h(e){let t=e.length<0?0:0|d(e.length),r=o(t);for(let i=0;i<t;i+=1)r[i]=255&e[i];return r}function f(e,t,r){let i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),a.prototype),i}function d(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||j(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return T(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(n)return i?-1:T(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=t;i<r;++i)n+=L[e[i]];return n}(this,t,r);case"utf8":case"utf-8":return w(this,t,r);case"ascii":return function(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}(this,t,r);case"latin1":case"binary":return function(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}(this,t,r);case"base64":var s,o;return s=t,o=r,0===s&&o===this.length?i.fromByteArray(this):i.fromByteArray(this.slice(s,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let i=e.slice(t,r),n="";for(let e=0;e<i.length-1;e+=2)n+=String.fromCharCode(i[e]+256*i[e+1]);return n}(this,t,r);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function b(e,t,r,i,n){var s;if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(s=r=+r)!=s&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return -1;r=e.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof t&&(t=a.from(t,i)),a.isBuffer(t))return 0===t.length?-1:m(e,t,r,i,n);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,i,n);throw TypeError("val must be string, number or Buffer")}function m(e,t,r,i,n){let s,o=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;o=2,a/=2,c/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n){let i=-1;for(s=r;s<a;s++)if(l(e,s)===l(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===c)return i*o}else -1!==i&&(s-=s-i),i=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let i=0;i<c;i++)if(l(e,s+i)!==l(t,i)){r=!1;break}if(r)return s}return -1}function w(e,t,r){r=Math.min(e.length,r);let i=[],n=t;for(;n<r;){let t=e[n],s=null,o=t>239?4:t>223?3:t>191?2:1;if(n+o<=r){let r,i,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(r=e[n+1]))==128&&(c=(31&t)<<6|63&r)>127&&(s=c);break;case 3:r=e[n+1],i=e[n+2],(192&r)==128&&(192&i)==128&&(c=(15&t)<<12|(63&r)<<6|63&i)>2047&&(c<55296||c>57343)&&(s=c);break;case 4:r=e[n+1],i=e[n+2],a=e[n+3],(192&r)==128&&(192&i)==128&&(192&a)==128&&(c=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&a)>65535&&c<1114112&&(s=c)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),n+=o}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}function v(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function E(e,t,r,i,n,s){if(!a.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function x(e,t,r,i,n){R(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function I(e,t,r,i,n){R(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function S(e,t,r,i,n,s){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function O(e,t,r,i,s){return t=+t,r>>>=0,s||S(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,i,23,4),r+4}function _(e,t,r,i,s){return t=+t,r>>>=0,s||S(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,i,52,8),r+8}t.lW=a,t.h2=50,a.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return(l(e),e<=0)?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(j(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),j(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let i=a.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){let t=e[r];if(j(t,Uint8Array))n+t.length>i.length?(a.isBuffer(t)||(t=a.from(t)),t.copy(i,n)):Uint8Array.prototype.set.call(i,t,n);else if(a.isBuffer(t))t.copy(i,n);else throw TypeError('"list" argument must be an Array of Buffers');n+=t.length}return i},a.byteLength=p,a.prototype._isBuffer=!0,a.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},a.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},a.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},a.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?w(this,0,e):g.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){let e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(a.prototype[s]=a.prototype.inspect),a.prototype.compare=function(e,t,r,i,n){if(j(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,n>>>=0,this===e)return 0;let s=n-i,o=r-t,c=Math.min(s,o),l=this.slice(i,n),u=e.slice(t,r);for(let e=0;e<c;++e)if(l[e]!==u[e]){s=l[e],o=u[e];break}return s<o?-1:o<s?1:0},a.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return b(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return b(this,e,t,r,!1)},a.prototype.write=function(e,t,r,i){var n,s,o,a,c,l,u,h;if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let f=this.length-t;if((void 0===r||r>f)&&(r=f),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let d=!1;for(;;)switch(i){case"hex":return function(e,t,r,i){let n;r=Number(r)||0;let s=e.length-r;i?(i=Number(i))>s&&(i=s):i=s;let o=t.length;for(i>o/2&&(i=o/2),n=0;n<i;++n){let i=parseInt(t.substr(2*n,2),16);if(i!=i)break;e[r+n]=i}return n}(this,e,t,r);case"utf8":case"utf-8":return n=t,s=r,k(T(e,this.length-n),this,n,s);case"ascii":case"latin1":case"binary":return o=t,a=r,k(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,o,a);case"base64":return c=t,l=r,k(N(e),this,c,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=r,k(function(e,t){let r,i;let n=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n.push(r%256),n.push(i);return n}(e,this.length-u),this,u,h);default:if(d)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),d=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,a.prototype),i},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);let i=this[e+--t],n=1;for(;t>0&&(n*=256);)i+=this[e+--t]*n;return i},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||v(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=$(function(e){C(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&B(e,this.length-8);let i=t+256*this[++e]+65536*this[++e]+16777216*this[++e],n=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(i)+(BigInt(n)<<BigInt(32))}),a.prototype.readBigUInt64BE=$(function(e){C(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&B(e,this.length-8);let i=16777216*t+65536*this[++e]+256*this[++e]+this[++e],n=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(i)<<BigInt(32))+BigInt(n)}),a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||v(e,t,this.length);let i=t,n=1,s=this[e+--i];for(;i>0&&(n*=256);)s+=this[e+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*t)),s},a.prototype.readInt8=function(e,t){return(e>>>=0,t||v(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||v(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||v(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=$(function(e){C(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&B(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),a.prototype.readBigInt64BE=$(function(e){C(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&B(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||v(e,4,this.length),n.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||v(e,4,this.length),n.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||v(e,8,this.length),n.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||v(e,8,this.length),n.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}let n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){let i=Math.pow(2,8*r)-1;E(this,e,t,r,i,0)}let n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=$(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return x(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=$(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return I(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}let n=0,s=1,o=0;for(this[t]=255&e;++n<r&&(s*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r},a.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){let i=Math.pow(2,8*r-1);E(this,e,t,r,i-1,-i)}let n=r-1,s=1,o=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||E(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=$(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return x(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=$(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return I(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeFloatLE=function(e,t,r){return O(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return O(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return _(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return _(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,i){if(!a.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);let n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},a.prototype.fill=function(e,t,r,i){let n;if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!a.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){let t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{let s=a.isBuffer(e)?e:a.from(e,i),o=s.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=s[n%o]}return this};let P={};function A(e,t,r){P[e]=class extends r{get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}}}function D(e){let t="",r=e.length,i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function R(e,t,r,i,n,s){if(e>r||e<t){let i;let n="bigint"==typeof t?"n":"";throw i=s>3?0===t||t===BigInt(0)?">= 0".concat(n," and < 2").concat(n," ** ").concat((s+1)*8).concat(n):">= -(2".concat(n," ** ").concat((s+1)*8-1).concat(n,") and < 2 ** ")+"".concat((s+1)*8-1).concat(n):">= ".concat(t).concat(n," and <= ").concat(r).concat(n),new P.ERR_OUT_OF_RANGE("value",i,e)}C(n,"offset"),(void 0===i[n]||void 0===i[n+s])&&B(n,i.length-(s+1))}function C(e,t){if("number"!=typeof e)throw new P.ERR_INVALID_ARG_TYPE(t,"number",e)}function B(e,t,r){if(Math.floor(e)!==e)throw C(e,r),new P.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new P.ERR_BUFFER_OUT_OF_BOUNDS;throw new P.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}A("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"},RangeError),A("ERR_INVALID_ARG_TYPE",function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)},TypeError),A("ERR_OUT_OF_RANGE",function(e,t,r){let i='The value of "'.concat(e,'" is out of range.'),n=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?n=D(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=D(n)),n+="n"),i+=" It must be ".concat(t,". Received ").concat(n)},RangeError);let U=/[^+/0-9A-Za-z-_]/g;function T(e,t){let r;t=t||1/0;let i=e.length,n=null,s=[];for(let o=0;o<i;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319||o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function N(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function k(e,t,r,i){let n;for(n=0;n<i&&!(n+r>=t.length)&&!(n>=e.length);++n)t[n+r]=e[n];return n}function j(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let L=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let i=16*r;for(let n=0;n<16;++n)t[i+n]=e[r]+e[n]}return t}();function $(e){return"undefined"==typeof BigInt?M:e}function M(){throw Error("BigInt not supported")}},58020:function(e,t,r){"use strict";r.d(t,{q:function(){return i}});class i{}},96756:function(e,t,r){"use strict";r.d(t,{C$:function(){return l},Lx:function(){return c}});var i=r(55445),n=r(40537),s=r(58020);class o extends s.q{constructor(e){super()}}let a=n.FIVE_SECONDS,c={pulse:"heartbeat_pulse"};class l extends o{constructor(e){super(e),this.events=new i.EventEmitter,this.interval=a,this.interval=e?.interval||a}static async init(e){let t=new l(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,n.toMiliseconds)(this.interval))}pulse(){this.events.emit(c.pulse)}}},5071:function(e,t,r){"use strict";r.d(t,{Z:function(){return m},k:function(){return m}});var i=r(55445),n=r(80751),s=r.n(n),o=r(80577),a=r(5276),c=Object.defineProperty,l=Object.defineProperties,u=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,p=(e,t,r)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))f.call(t,r)&&p(e,r,t[r]);if(h)for(var r of h(t))d.call(t,r)&&p(e,r,t[r]);return e},y=(e,t)=>l(e,u(t));let b={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class m{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new i.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,a.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{let t=(0,o.safeJsonStringify)(e),r=await (await s()(this.url,y(g({},b),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!(0,a.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(Error("HTTP connection is missing or invalid"));e()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){let t=(0,o.safeJsonStringify)({id:1,jsonrpc:"2.0",method:"test",params:[]});await s()(e,y(g({},b),{body:t}))}this.onOpen()}catch(t){let e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?(0,o.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=r.message||r.toString(),n=(0,a.formatJsonRpcError)(e,i);this.events.emit("payload",n)}parseError(e,t=this.url){return(0,a.parseConnectionError)(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}},38979:function(e,t,r){"use strict";r.d(t,{r:function(){return s}});var i=r(55445),n=r(5276);class s extends n.IJsonRpcProvider{constructor(e){super(e),this.events=new i.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict((0,n.formatJsonRpcRequest)(e.method,e.params||[],e.id||(0,n.getBigIntRpcId)().toString()),t)}async requestStrict(e,t){return new Promise(async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(e){i(e)}this.events.on(`${e.id}`,e=>{(0,n.isJsonRpcError)(e)?i(e.error):r(e.result)});try{await this.connection.send(e,t)}catch(e){i(e)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,n.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}},44265:function(e,t,r){"use strict";r.d(t,{CA:function(){return n},JV:function(){return a},O4:function(){return i},dQ:function(){return s},xK:function(){return o}});let i="INTERNAL_ERROR",n="SERVER_ERROR",s=[-32700,-32600,-32601,-32602,-32603],o={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[i]:{code:-32603,message:"Internal error"},[n]:{code:-32e3,message:"Server error"}},a=n},23497:function(e,t,r){"use strict";var i=r(13303);r.o(i,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return i.IJsonRpcProvider}}),r.o(i,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return i.formatJsonRpcError}}),r.o(i,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return i.formatJsonRpcRequest}}),r.o(i,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return i.formatJsonRpcResult}}),r.o(i,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return i.getBigIntRpcId}}),r.o(i,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return i.isHttpUrl}}),r.o(i,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return i.isJsonRpcError}}),r.o(i,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return i.isJsonRpcRequest}}),r.o(i,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return i.isJsonRpcResponse}}),r.o(i,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return i.isJsonRpcResult}}),r.o(i,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return i.isLocalhostUrl}}),r.o(i,"isReactNative")&&r.d(t,{isReactNative:function(){return i.isReactNative}}),r.o(i,"isWsUrl")&&r.d(t,{isWsUrl:function(){return i.isWsUrl}}),r.o(i,"payloadId")&&r.d(t,{payloadId:function(){return i.payloadId}})},28418:function(e,t,r){"use strict";r.d(t,{CX:function(){return a},L2:function(){return o},by:function(){return s},i5:function(){return n}});var i=r(44265);function n(e){return i.dQ.includes(e)}function s(e){return Object.keys(i.xK).includes(e)?i.xK[e]:i.xK[i.JV]}function o(e){return Object.values(i.xK).find(t=>t.code===e)||i.xK[i.JV]}function a(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?Error(`Unavailable ${r} RPC url at ${t}`):e}},74947:function(e,t,r){"use strict";r.d(t,{CS:function(){return o},RI:function(){return l},o0:function(){return s},sT:function(){return a},tm:function(){return c}});var i=r(28418),n=r(44265);function s(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function o(e=6){return BigInt(s(e))}function a(e,t,r){return{id:r||s(),jsonrpc:"2.0",method:e,params:t}}function c(e,t){return{id:e,jsonrpc:"2.0",result:t}}function l(e,t,r){var s;return{id:e,jsonrpc:"2.0",error:void 0===(s=t)?(0,i.by)(n.O4):("string"==typeof s&&(s=Object.assign(Object.assign({},(0,i.by)(n.CA)),{message:s})),void 0!==r&&(s.data=r),(0,i.i5)(s.code)&&(s=(0,i.L2)(s.code)),s)}}},5276:function(e,t,r){"use strict";r.d(t,{IJsonRpcProvider:function(){return o.x0},formatJsonRpcError:function(){return s.RI},formatJsonRpcRequest:function(){return s.sT},formatJsonRpcResult:function(){return s.tm},getBigIntRpcId:function(){return s.CS},isHttpUrl:function(){return a.jK},isJsonRpcError:function(){return c.jg},isJsonRpcRequest:function(){return c.DW},isJsonRpcResponse:function(){return c.u},isJsonRpcResult:function(){return c.k4},isLocalhostUrl:function(){return a.JF},isWsUrl:function(){return a.UZ},parseConnectionError:function(){return i.CX},payloadId:function(){return s.o0}}),r(44265);var i=r(28418),n=r(23497);r.o(n,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return n.IJsonRpcProvider}}),r.o(n,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return n.formatJsonRpcError}}),r.o(n,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return n.formatJsonRpcRequest}}),r.o(n,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return n.formatJsonRpcResult}}),r.o(n,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return n.getBigIntRpcId}}),r.o(n,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return n.isHttpUrl}}),r.o(n,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return n.isJsonRpcError}}),r.o(n,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return n.isJsonRpcRequest}}),r.o(n,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return n.isJsonRpcResponse}}),r.o(n,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return n.isJsonRpcResult}}),r.o(n,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return n.isLocalhostUrl}}),r.o(n,"isReactNative")&&r.d(t,{isReactNative:function(){return n.isReactNative}}),r.o(n,"isWsUrl")&&r.d(t,{isWsUrl:function(){return n.isWsUrl}}),r.o(n,"payloadId")&&r.d(t,{payloadId:function(){return n.payloadId}});var s=r(74947);r(22673);var o=r(75826),a=r(20276),c=r(65505)},22673:function(e,t,r){},75826:function(e,t,r){"use strict";r.d(t,{x0:function(){return s}});class i{}class n extends i{constructor(){super()}}class s extends n{constructor(e){super()}}},20276:function(e,t,r){"use strict";function i(e,t){let r=function(e){let t=e.match(RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function n(e){return i(e,"^https?:")}function s(e){return i(e,"^wss?:")}function o(e){return RegExp("wss?://localhost(:d{2,5})?").test(e)}r.d(t,{JF:function(){return o},UZ:function(){return s},jK:function(){return n}})},65505:function(e,t,r){"use strict";function i(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function n(e){return i(e)&&"method"in e}function s(e){return i(e)&&(o(e)||a(e))}function o(e){return"result"in e}function a(e){return"error"in e}r.d(t,{DW:function(){return n},jg:function(){return a},k4:function(){return o},u:function(){return s}})},75646:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var i=r(55445),n=r(80577),s=r(5276);let o=()=>"u">typeof WebSocket||"u">typeof r.g&&"u">typeof r.g.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket,a=e=>e.split("?")[0],c="u">typeof WebSocket?WebSocket:"u">typeof r.g&&"u">typeof r.g.WebSocket?r.g.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:r(16854);class l{constructor(e){if(this.url=e,this.events=new i.EventEmitter,this.registering=!1,!(0,s.isWsUrl)(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(Error("Connection already closed"));return}this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,n.safeJsonStringify)(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!(0,s.isWsUrl)(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,r)=>{let i=(0,s.isReactNative)()?void 0:{rejectUnauthorized:!(0,s.isLocalhostUrl)(e)},n=new c(e,[],i);o()?n.onerror=e=>{r(this.emitError(e.error))}:n.on("error",e=>{r(this.emitError(e))}),n.onopen=()=>{this.onOpen(n),t(n)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?(0,n.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=r.message||r.toString(),n=(0,s.formatJsonRpcError)(e,i);this.events.emit("payload",n)}parseError(e,t=this.url){return(0,s.parseConnectionError)(e,a(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){let t=this.parseError(Error(e?.message||`WebSocket connection failed for host: ${a(this.url)}`));return this.events.emit("register_error",t),t}}},16854:function(e){"use strict";e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},11248:function(e,t,r){"use strict";let i;var n=r(80577),s=r(88251),o=s&&"object"==typeof s&&"default"in s?s:{default:s};let a=":memory:",c=class{constructor(e){this.writeActionsQueue={state:"idle",actions:[]},i||(i=function(){try{let e=r(30324),t=r(97846);return{db:e,driver:t}}catch{throw Error('To use WalletConnect server side, you\'ll need to install the "unstorage" dependency. If you are seeing this error during a build / in an SSR environment, you can add "unstorage" as a devDependency to make this error go away.')}}()),e?.dbName===a?this.database=i.db.createStorage():this.database=i.db.createStorage({driver:i.driver({base:e?.dbName})})}static create(e){let t=e.dbName;return t===a?new c(e):(c.instances[t]||(c.instances[t]=new c(e)),c.instances[t])}async getKeys(){return this.database.getKeys()}async getEntries(){return(await this.database.getItems(await this.database.getKeys())).map(e=>[e.key,e.value])}async onWriteAction(e){let{key:t,value:r,action:i}=e,n=()=>({}),s=new Promise(e=>n=e);this.writeActionsQueue.actions.push({key:t,value:r,action:i,callback:n}),"idle"===this.writeActionsQueue.state&&this.startWriteActions(),await s}async startWriteActions(){if(0===this.writeActionsQueue.actions.length){this.writeActionsQueue.state="idle";return}for(this.writeActionsQueue.state="active";this.writeActionsQueue.actions.length>0;){let e=this.writeActionsQueue.actions.shift();if(!e)continue;let{key:t,value:r,action:i,callback:s}=e;switch(i){case"setItem":await this.database.setItem(t),await this.database.setItem(t,n.safeJsonStringify(r));break;case"removeItem":await this.database.removeItem(t)}s()}this.writeActionsQueue.state="idle"}async getItem(e){let t=await this.database.getItem(e);if(null!==t)return t}async setItem(e,t){await this.onWriteAction({key:e,value:t,action:"setItem"})}async removeItem(e){await this.onWriteAction({key:e,action:"removeItem"})}};c.instances={};let l=".to_migrate",u=async(e,t,r)=>{var i;if(e===a){r();return}let s="wc_storage_version",o=await t.getItem(s);if(o&&o>=1){r();return}let c=await h(`${e}${l}`);if(!c){r();return}let u=n.safeJsonParse(c);if(!u){r();return}let f=null==(i=u?.collections)?void 0:i[0],p=f?.data;if(!p||!p.length){r();return}for(;p.length;){let e=p.shift();if(!e)continue;let{id:r,value:i}=e;await t.setItem(r,n.safeJsonParse(i))}await t.setItem(s,1),d(`${e}${l}`,`${e}.migrated`),r()},h=async e=>await new Promise(t=>{o.default.readFile(e,{encoding:"utf8"},(e,r)=>{e&&t(void 0),t(r)})}),f=e=>{e!==a&&o.default.existsSync(e)&&(o.default.lstatSync(e).isDirectory()||d(e,`${e}${l}`))},d=(e,t)=>{try{o.default.renameSync(e,t)}catch{}};class p{constructor(e){this.initialized=!1,this.setInitialized=()=>{this.initialized=!0};let t=e?.database||e?.table||"walletconnect.db";f(t),this.database=c.create({dbName:t}),u(t,this.database,this.setInitialized)}async getKeys(){return await this.initialize(),this.database.getKeys()}async getEntries(){return await this.initialize(),this.database.getEntries()}async getItem(e){return await this.initialize(),this.database.getItem(e)}async setItem(e,t){await this.initialize(),await this.database.setItem(e,t)}async removeItem(e){await this.initialize(),await this.database.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{let t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}t.ZP=p},15133:function(e,t,r){"use strict";r.d(t,{Ep:function(){return S},Fd:function(){return I},Rt:function(){return O},gw:function(){return n.a},jI:function(){return x}});var i=r(94299),n=r.n(i),s=r(80577);let o={level:"info"},a="custom_context";class c{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class l{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new c(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}class u{constructor(e,t=1024e3){this.level=e??"error",this.levelValue=i.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new l(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===i.levels.values.error?console.error(e):t===i.levels.values.warn?console.warn(e):t===i.levels.values.debug?console.debug(e):t===i.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,s.safeJsonStringify)({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new l(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push((0,s.safeJsonStringify)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class h{constructor(e,t=1024e3){this.baseChunkLogger=new u(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class f{constructor(e,t=1024e3){this.baseChunkLogger=new u(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var d=Object.defineProperty,p=Object.defineProperties,g=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,w=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t)=>{for(var r in t||(t={}))b.call(t,r)&&w(e,r,t[r]);if(y)for(var r of y(t))m.call(t,r)&&w(e,r,t[r]);return e},E=(e,t)=>p(e,g(t));function x(e){return E(v({},e),{level:e?.level||o.level})}function I(e,t=a){return typeof e.bindings>"u"?function(e,t=a){return e[t]||""}(e,t):e.bindings().context||""}function S(e,t,r=a){let i=function(e,t,r=a){let i=I(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=a){return e[r]=t,e}(e.child({context:i}),i,r)}function O(e){return"u">typeof e.loggerOverride&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:"u">typeof window?function(e){var t,r;let i=new h(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n()(E(v({},e.opts),{level:"trace",browser:E(v({},null==(r=e.opts)?void 0:r.browser),{write:e=>i.write(e)})})),chunkLoggerController:i}}(e):function(e){var t;let r=new f(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:n()(E(v({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}(e)}},21086:function(e,t,r){"use strict";r.d(t,{iO:function(){return i}});let i={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}}},46633:function(e,t,r){"use strict";r.d(t,{Au:function(){return tO},bG:function(){return tI},vf:function(){return t_},xp:function(){return tS}});var i=r(40537),n=r(80577);function s(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function o(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}let a="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,c=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function l(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),s(e),e}class u{clone(){return this._cloneInto()}}function h(e=32){if(a&&"function"==typeof a.getRandomValues)return a.getRandomValues(new Uint8Array(e));if(a&&"function"==typeof a.randomBytes)return a.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}class f extends u{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=c(this.buffer)}update(e){o(this);let{view:t,buffer:r,blockLen:i}=this,n=(e=l(e)).length;for(let s=0;s<n;){let o=Math.min(i-this.pos,n-s);if(o===i){let t=c(e);for(;i<=n-s;s+=i)this.process(t,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){o(this),function(e,t){s(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:n}=this,{pos:a}=this;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(r,0),a=0);for(let e=a;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),s=BigInt(4294967295),o=Number(r>>n&s),a=Number(r&s),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)})(r,i-8,BigInt(8*this.length),n),this.process(r,0);let l=c(e),u=this.outputLen;if(u%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=u/4,f=this.get();if(h>f.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<h;e++)l.setUint32(4*e,f[e],n)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:s,pos:o}=this;return e.length=i,e.pos=o,e.finished=n,e.destroyed=s,i%t&&e.buffer.set(r),e}}let d=BigInt(4294967296-1),p=BigInt(32),g={split:function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let n=0;n<e.length;n++){let{h:s,l:o}=function(e,t=!1){return t?{h:Number(e&d),l:Number(e>>p&d)}:{h:0|Number(e>>p&d),l:0|Number(e&d)}}(e[n],t);[r[n],i[n]]=[s,o]}return[r,i]},shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,add:function(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/4294967296|0)|0,l:0|n}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,i)=>t+r+i+(e/4294967296|0)|0,add4L:(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),add4H:(e,t,r,i,n)=>t+r+i+n+(e/4294967296|0)|0,add5H:(e,t,r,i,n,s)=>t+r+i+n+s+(e/4294967296|0)|0,add5L:(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0)},[y,b]=g.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),m=new Uint32Array(80),w=new Uint32Array(80);class v extends f{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g]}set(e,t,r,i,n,s,o,a,c,l,u,h,f,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)m[r]=e.getUint32(t),w[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|m[e-15],r=0|w[e-15],i=g.rotrSH(t,r,1)^g.rotrSH(t,r,8)^g.shrSH(t,r,7),n=g.rotrSL(t,r,1)^g.rotrSL(t,r,8)^g.shrSL(t,r,7),s=0|m[e-2],o=0|w[e-2],a=g.rotrSH(s,o,19)^g.rotrBH(s,o,61)^g.shrSH(s,o,6),c=g.rotrSL(s,o,19)^g.rotrBL(s,o,61)^g.shrSL(s,o,6),l=g.add4L(n,c,w[e-7],w[e-16]),u=g.add4H(l,i,a,m[e-7],m[e-16]);m[e]=0|u,w[e]=0|l}let{Ah:r,Al:i,Bh:n,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:f,Fl:d,Gh:p,Gl:v,Hh:E,Hl:x}=this;for(let e=0;e<80;e++){let t=g.rotrSH(u,h,14)^g.rotrSH(u,h,18)^g.rotrBH(u,h,41),I=g.rotrSL(u,h,14)^g.rotrSL(u,h,18)^g.rotrBL(u,h,41),S=u&f^~u&p,O=h&d^~h&v,_=g.add5L(x,I,O,b[e],w[e]),P=g.add5H(_,E,t,S,y[e],m[e]),A=0|_,D=g.rotrSH(r,i,28)^g.rotrBH(r,i,34)^g.rotrBH(r,i,39),R=g.rotrSL(r,i,28)^g.rotrBL(r,i,34)^g.rotrBL(r,i,39),C=r&n^r&o^n&o,B=i&s^i&a^s&a;E=0|p,x=0|v,p=0|f,v=0|d,f=0|u,d=0|h,({h:u,l:h}=g.add(0|c,0|l,0|P,0|A)),c=0|o,l=0|a,o=0|n,a=0|s,n=0|r,s=0|i;let U=g.add3L(A,R,B);r=g.add3H(U,P,D,C),i=0|U}({h:r,l:i}=g.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:s}=g.add(0|this.Bh,0|this.Bl,0|n,0|s)),({h:o,l:a}=g.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l:l}=g.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=g.add(0|this.Eh,0|this.El,0|u,0|h)),({h:f,l:d}=g.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:v}=g.add(0|this.Gh,0|this.Gl,0|p,0|v)),({h:E,l:x}=g.add(0|this.Hh,0|this.Hl,0|E,0|x)),this.set(r,i,n,s,o,a,c,l,u,h,f,d,p,v,E,x)}roundClean(){m.fill(0),w.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let E=function(e){let t=t=>e().update(l(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new v),x=BigInt(0),I=BigInt(1),S=BigInt(2);function O(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function _(e){if(!O(e))throw Error("Uint8Array expected")}function P(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}let A=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function D(e){_(e);let t="";for(let r=0;r<e.length;r++)t+=A[e[r]];return t}function R(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?x:BigInt("0x"+e)}let C={_0:48,_9:57,A:65,F:70,a:97,f:102};function B(e){return e>=C._0&&e<=C._9?e-C._0:e>=C.A&&e<=C.F?e-(C.A-10):e>=C.a&&e<=C.f?e-(C.a-10):void 0}function U(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,n=0;t<r;t++,n+=2){let r=B(e.charCodeAt(n)),s=B(e.charCodeAt(n+1));if(void 0===r||void 0===s)throw Error('hex string expected, got non-hex character "'+(e[n]+e[n+1])+'" at index '+n);i[t]=16*r+s}return i}function T(e){return _(e),R(D(Uint8Array.from(e).reverse()))}function N(e,t){return U(e.toString(16).padStart(2*t,"0"))}function k(e,t){return N(e,t).reverse()}function j(e,t,r){let i;if("string"==typeof t)try{i=U(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(O(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i}function L(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];_(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}let $=e=>"bigint"==typeof e&&x<=e;function M(e,t,r,i){if(!($(t)&&$(r)&&$(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let z=e=>(S<<BigInt(e-1))-I,q={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||O(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function F(e,t,r={}){let i=(t,r,i)=>{let n=q[r];if("function"!=typeof n)throw Error("invalid validator function");let s=e[t];if(!(i&&void 0===s)&&!n(s,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function V(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let s=e(r,...i);return t.set(r,s),s}}let K=BigInt(0),H=BigInt(1),G=BigInt(2),W=BigInt(3),J=BigInt(4),Z=BigInt(5),Y=BigInt(8);function Q(e,t){let r=e%t;return r>=K?r:t+r}function X(e,t,r){let i=e;for(;t-- >K;)i*=i,i%=r;return i}function ee(e,t){if(e===K)throw Error("invert: expected non-zero number");if(t<=K)throw Error("invert: expected positive modulus, got "+t);let r=Q(e,t),i=t,n=K,s=H;for(;r!==K;){let e=i/r,t=i%r,o=n-s*e;i=r,r=t,n=s,s=o}if(i!==H)throw Error("invert: does not exist");return Q(n,t)}let et=(e,t)=>(Q(e,t)&H)===H,er=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ei(e,t){let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function en(e,t,r=!1,i={}){let n;if(e<=K)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:s,nByteLength:o}=ei(e,t);if(o>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:s,BYTES:o,MASK:z(s),ZERO:K,ONE:H,create:t=>Q(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return K<=t&&t<e},is0:e=>e===K,isOdd:e=>(e&H)===H,neg:t=>Q(-t,e),eql:(e,t)=>e===t,sqr:t=>Q(t*t,e),add:(t,r)=>Q(t+r,e),sub:(t,r)=>Q(t-r,e),mul:(t,r)=>Q(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<K)throw Error("invalid exponent, negatives unsupported");if(r===K)return e.ONE;if(r===H)return t;let i=e.ONE,n=t;for(;r>K;)r&H&&(i=e.mul(i,n)),n=e.sqr(n),r>>=H;return i})(a,e,t),div:(t,r)=>Q(t*ee(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>ee(t,e),sqrt:i.sqrt||(t=>(n||(n=function(e){if(e%J===W){let t=(e+H)/J;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(e%Y===Z){let t=(e-Z)/Y;return function(e,r){let i=e.mul(r,G),n=e.pow(i,t),s=e.mul(r,n),o=e.mul(e.mul(s,G),n),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),r))throw Error("Cannot find square root");return a}}return function(e){let t,r,i;let n=(e-H)/G;for(t=e-H,r=0;t%G===K;t/=G,r++);for(i=G;i<e&&function(e,t,r){if(t<K)throw Error("invalid exponent, negatives unsupported");if(r<=K)throw Error("invalid modulus");if(r===H)return K;let i=H;for(;t>K;)t&H&&(i=i*e%r),e=e*e%r,t>>=H;return i}(i,n,e)!==e-H;i++)if(i>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let t=(e+H)/J;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let s=(t+H)/G;return function(e,o){if(e.pow(o,n)===e.neg(e.ONE))throw Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),t),l=e.pow(o,s),u=e.pow(o,t);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(c,H<<BigInt(a-t-1));c=e.sqr(r),l=e.mul(l,r),u=e.mul(u,c),a=t}return l}}(e)}(e)),n(a,t))),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,n)=>e.is0(i)?t:(r[n]=t,e.mul(t,i)),e.ONE),n=e.inv(i);return t.reduceRight((t,i,n)=>e.is0(i)?t:(r[n]=e.mul(t,r[n]),e.mul(t,i)),n),r})(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?k(e,o):N(e,o),fromBytes:e=>{if(e.length!==o)throw Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?T(e):R(D(e))}});return Object.freeze(a)}let es=BigInt(0),eo=BigInt(1);function ea(e,t){let r=t.negate();return e?r:t}function ec(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function el(e,t){return ec(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}let eu=new WeakMap,eh=new WeakMap;function ef(e){return eh.get(e)||1}let ed=BigInt(0),ep=BigInt(1),eg=BigInt(2),ey=BigInt(8),eb={zip215:!0};BigInt(0),BigInt(1);let em=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ew=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);let ev=BigInt(1),eE=BigInt(2);BigInt(3);let ex=BigInt(5),eI=BigInt(8),eS=en(em,void 0,!0),eO=function(e){var t;let r=function(e){let t=(F(e.Fp,er.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),F(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ei(e.n,e.nBitLength),...e,p:e.Fp.ORDER}));return F(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:i,n:n,prehash:s,hash:o,randomBytes:a,nByteLength:c,h:l}=r,u=eg<<BigInt(8*c)-ep,h=i.create,f=en(r.n,r.nBitLength),d=r.uvRatio||((e,t)=>{try{return{isValid:!0,value:i.sqrt(e*i.inv(t))}}catch{return{isValid:!1,value:ed}}}),p=r.adjustScalarBytes||(e=>e),g=r.domain||((e,t,r)=>{if(P("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function y(e,t){M("coordinate "+e,t,ed,u)}function b(e){if(!(e instanceof v))throw Error("ExtendedPoint expected")}let m=V((e,t)=>{let{ex:r,ey:n,ez:s}=e,o=e.is0();null==t&&(t=o?ey:i.inv(s));let a=h(r*t),c=h(n*t),l=h(s*t);if(o)return{x:ed,y:ep};if(l!==ep)throw Error("invZ was invalid");return{x:a,y:c}}),w=V(e=>{let{a:t,d:i}=r;if(e.is0())throw Error("bad point: ZERO");let{ex:n,ey:s,ez:o,et:a}=e,c=h(n*n),l=h(s*s),u=h(o*o),f=h(u*u),d=h(c*t);if(h(u*h(d+l))!==h(f+h(i*h(c*l))))throw Error("bad point: equation left != right (1)");if(h(n*s)!==h(o*a))throw Error("bad point: equation left != right (2)");return!0});class v{constructor(e,t,r,i){this.ex=e,this.ey=t,this.ez=r,this.et=i,y("x",e),y("y",t),y("z",r),y("t",i),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof v)throw Error("extended point not allowed");let{x:t,y:r}=e||{};return y("x",t),y("y",r),new v(t,r,ep,h(t*r))}static normalizeZ(e){let t=i.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(v.fromAffine)}static msm(e,t){return function(e,t,r,i){if(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let n=e.ZERO,s=function(e){let t;for(t=0;e>x;e>>=I,t+=1);return t}(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=Array(a+1).fill(n),l=Math.floor((t.BITS-1)/o)*o,u=n;for(let e=l;e>=0;e-=o){c.fill(n);for(let t=0;t<i.length;t++){let n=Number(i[t]>>BigInt(e)&BigInt(a));c[n]=c[n].add(r[t])}let t=n;for(let e=c.length-1,r=n;e>0;e--)r=r.add(c[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<o;e++)u=u.double()}return u}(v,f,e,t)}_setWindowSize(e){O.setWindowSize(this,e)}assertValidity(){w(this)}equals(e){b(e);let{ex:t,ey:r,ez:i}=this,{ex:n,ey:s,ez:o}=e,a=h(t*o),c=h(n*i),l=h(r*o),u=h(s*i);return a===c&&l===u}is0(){return this.equals(v.ZERO)}negate(){return new v(h(-this.ex),this.ey,this.ez,h(-this.et))}double(){let{a:e}=r,{ex:t,ey:i,ez:n}=this,s=h(t*t),o=h(i*i),a=h(eg*h(n*n)),c=h(e*s),l=t+i,u=h(h(l*l)-s-o),f=c+o,d=f-a,p=c-o,g=h(u*d),y=h(f*p),b=h(u*p);return new v(g,y,h(d*f),b)}add(e){b(e);let{a:t,d:i}=r,{ex:n,ey:s,ez:o,et:a}=this,{ex:c,ey:l,ez:u,et:f}=e;if(t===BigInt(-1)){let e=h((s-n)*(l+c)),t=h((s+n)*(l-c)),r=h(t-e);if(r===ed)return this.double();let i=h(o*eg*f),d=h(a*eg*u),p=d+i,g=t+e,y=d-i,b=h(p*r),m=h(g*y),w=h(p*y);return new v(b,m,h(r*g),w)}let d=h(n*c),p=h(s*l),g=h(a*i*f),y=h(o*u),m=h((n+s)*(c+l)-d-p),w=y-g,E=y+g,x=h(p-t*d),I=h(m*w),S=h(E*x),O=h(m*x);return new v(I,S,h(w*E),O)}subtract(e){return this.add(e.negate())}wNAF(e){return O.wNAFCached(this,e,v.normalizeZ)}multiply(e){M("scalar",e,ep,n);let{p:t,f:r}=this.wNAF(e);return v.normalizeZ([t,r])[0]}multiplyUnsafe(e,t=v.ZERO){return M("scalar",e,ed,n),e===ed?S:this.is0()||e===ep?this:O.wNAFCachedUnsafe(this,e,v.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return O.unsafeLadder(this,n).is0()}toAffine(e){return m(this,e)}clearCofactor(){let{h:e}=r;return e===ep?this:this.multiplyUnsafe(e)}static fromHex(e,t=!1){let{d:n,a:s}=r,o=i.BYTES;e=j("pointHex",e,o),P("zip215",t);let a=e.slice(),c=e[o-1];a[o-1]=-129&c;let l=T(a);M("pointHex.y",l,ed,t?u:i.ORDER);let f=h(l*l),{isValid:p,value:g}=d(h(f-ep),h(n*f-s));if(!p)throw Error("Point.fromHex: invalid y coordinate");let y=(g&ep)===ep,b=(128&c)!=0;if(!t&&g===ed&&b)throw Error("Point.fromHex: x=0 and x_0=1");return b!==y&&(g=h(-g)),v.fromAffine({x:g,y:l})}static fromPrivateKey(e){return _(e).point}toRawBytes(){let{x:e,y:t}=this.toAffine(),r=k(t,i.BYTES);return r[r.length-1]|=e&ep?128:0,r}toHex(){return D(this.toRawBytes())}}v.BASE=new v(r.Gx,r.Gy,ep,h(r.Gx*r.Gy)),v.ZERO=new v(ed,ep,ep,ed);let{BASE:E,ZERO:S}=v,O=(t=8*c,{constTimeNegate:ea,hasPrecomputes:e=>1!==ef(e),unsafeLadder(e,t,r=v.ZERO){let i=e;for(;t>es;)t&eo&&(r=r.add(i)),i=i.double(),t>>=eo;return r},precomputeWindow(e,r){let{windows:i,windowSize:n}=el(r,t),s=[],o=e,a=o;for(let e=0;e<i;e++){a=o,s.push(a);for(let e=1;e<n;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(e,r,i){let{windows:n,windowSize:s}=el(e,t),o=v.ZERO,a=v.BASE,c=BigInt(2**e-1),l=2**e,u=BigInt(e);for(let e=0;e<n;e++){let t=e*s,n=Number(i&c);i>>=u,n>s&&(n-=l,i+=eo);let h=t+Math.abs(n)-1,f=e%2!=0,d=n<0;0===n?a=a.add(ea(f,r[t])):o=o.add(ea(d,r[h]))}return{p:o,f:a}},wNAFUnsafe(e,r,i,n=v.ZERO){let{windows:s,windowSize:o}=el(e,t),a=BigInt(2**e-1),c=2**e,l=BigInt(e);for(let e=0;e<s;e++){let t=e*o;if(i===es)break;let s=Number(i&a);if(i>>=l,s>o&&(s-=c,i+=eo),0===s)continue;let u=r[t+Math.abs(s)-1];s<0&&(u=u.negate()),n=n.add(u)}return n},getPrecomputes(e,t,r){let i=eu.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&eu.set(t,r(i))),i},wNAFCached(e,t,r){let i=ef(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let n=ef(e);return 1===n?this.unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)},setWindowSize(e,r){ec(r,t),eh.set(e,r),eu.delete(e)}});function _(e){let t=i.BYTES;e=j("private key",e,t);let r=j("hashed private key",o(e),2*t),s=p(r.slice(0,t)),a=r.slice(t,2*t),c=Q(T(s),n),l=E.multiply(c),u=l.toRawBytes();return{head:s,prefix:a,scalar:c,point:l,pointBytes:u}}function A(e=new Uint8Array,...t){return Q(T(o(g(L(...t),j("context",e),!!s))),n)}return E._setWindowSize(8),{CURVE:r,getPublicKey:function(e){return _(e).pointBytes},sign:function(e,t,r={}){e=j("message",e),s&&(e=s(e));let{prefix:o,scalar:a,pointBytes:c}=_(t),l=A(r.context,o,e),u=E.multiply(l).toRawBytes(),h=Q(l+A(r.context,u,c,e)*a,n);return M("signature.s",h,ed,n),j("result",L(u,k(h,i.BYTES)),2*i.BYTES)},verify:function(e,t,r,n=eb){let o,a,c;let{context:l,zip215:u}=n,h=i.BYTES;e=j("signature",e,2*h),t=j("message",t),r=j("publicKey",r,h),void 0!==u&&P("zip215",u),s&&(t=s(t));let f=T(e.slice(h,2*h));try{o=v.fromHex(r,u),a=v.fromHex(e.slice(0,h),u),c=E.multiplyUnsafe(f)}catch{return!1}if(!u&&o.isSmallOrder())return!1;let d=A(l,a.toRawBytes(),o.toRawBytes(),t);return a.add(o.multiplyUnsafe(d)).subtract(c).clearCofactor().equals(v.ZERO)},ExtendedPoint:v,utils:{getExtendedPublicKey:_,randomPrivateKey:()=>a(i.BYTES),precompute:(e=8,t=v.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:eS,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:eI,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:E,randomBytes:h,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){let r=Q(t*t*t,em),i=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=e*e%em*e%em,o=X(s,eE,em)*s%em,a=X(o,ev,em)*e%em,c=X(a,ex,em)*a%em,l=X(c,t,em)*c%em,u=X(l,r,em)*l%em,h=X(u,i,em)*u%em,f=X(h,n,em)*h%em,d=X(f,n,em)*h%em,p=X(d,t,em)*c%em;return{pow_p_5_8:X(p,eE,em)*e%em,b2:s}}(e*Q(r*r*t,em)).pow_p_5_8,n=Q(e*r*i,em),s=Q(t*n*n,em),o=n,a=Q(n*ew,em),c=s===e,l=s===Q(-e,em),u=s===Q(-e*ew,em);return c&&(n=o),(l||u)&&(n=a),et(n,em)&&(n=Q(-n,em)),{isValid:c||l,value:n}}}),e_="base64url",eP="utf8",eA="utf8",eD="base58btc";function eR(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function eC(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?eR(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function eB(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=eC(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return eR(r)}var eU=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var s=e.charAt(n),o=s.charCodeAt(0);if(255!==r[o])throw TypeError(s+" is ambiguous");r[o]=n}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,n=0;e[t]===c;)i++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,f=s-1;(0!==u||h<n)&&-1!==f;f--,h++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");n=h,t++}if(" "!==e[t]){for(var d=s-n;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(i+(s-d)),g=i;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,n=0,s=t.length;n!==s&&0===t[n];)n++,r++;for(var o=(s-n)*u+1>>>0,l=new Uint8Array(o);n!==s;){for(var h=t[n],f=0,d=o-1;(0!==h||f<i)&&-1!==d;d--,f++)h+=256*l[d]>>>0,l[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw Error("Non-zero carry");i=f,n++}for(var p=o-i;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw Error(`Non-${t} character`)}}};let eT=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},eN=e=>new TextEncoder().encode(e),ek=e=>new TextDecoder().decode(e);class ej{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class eL{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return eM(this,e)}}class e${constructor(e){this.decoders=e}or(e){return eM(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let eM=(e,t)=>new e$({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ez{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new ej(e,t,r),this.decoder=new eL(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let eq=({name:e,prefix:t,encode:r,decode:i})=>new ez(e,t,r,i),eF=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:n}=eU(r,t);return eq({prefix:e,name:t,encode:i,decode:e=>eT(n(e))})},eV=(e,t,r,i)=>{let n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,l=0;for(let t=0;t<s;++t){let s=n[e[t]];if(void 0===s)throw SyntaxError(`Non-${i} character`);c=c<<r|s,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},eK=(e,t,r)=>{let i="="===t[t.length-1],n=(1<<r)-1,s="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,s+=t[n&a>>o];if(o&&(s+=t[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},eH=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>eq({prefix:t,name:e,encode:e=>eK(e,i,r),decode:t=>eV(t,i,r,e)});var eG=Object.freeze({__proto__:null,identity:eq({prefix:"\0",name:"identity",encode:e=>ek(e),decode:e=>eN(e)})}),eW=Object.freeze({__proto__:null,base2:eH({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),eJ=Object.freeze({__proto__:null,base8:eH({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),eZ=Object.freeze({__proto__:null,base10:eF({prefix:"9",name:"base10",alphabet:"0123456789"})}),eY=Object.freeze({__proto__:null,base16:eH({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:eH({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let eQ=eH({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eX=eH({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),e0=eH({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e1=eH({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),e2=eH({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),e5=eH({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});var e6=Object.freeze({__proto__:null,base32:eQ,base32upper:eX,base32pad:e0,base32padupper:e1,base32hex:e2,base32hexupper:e5,base32hexpad:eH({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:eH({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:eH({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),e8=Object.freeze({__proto__:null,base36:eF({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:eF({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),e3=Object.freeze({__proto__:null,base58btc:eF({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:eF({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let e4=eH({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});var e9=Object.freeze({__proto__:null,base64:e4,base64pad:eH({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:eH({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:eH({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let e7=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),te=e7.reduce((e,t,r)=>(e[r]=t,e),[]),tt=e7.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var tr=Object.freeze({__proto__:null,base256emoji:eq({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=te[t],"")},decode:function(e){let t=[];for(let r of e){let e=tt[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function ti(e,t){var r,i=0,t=t||0,n=0,s=t,o=e.length;do{if(s>=o)throw ti.bytes=0,RangeError("Could not decode varint");r=e[s++],i+=n<28?(127&r)<<n:(127&r)*Math.pow(2,n),n+=7}while(r>=128);return ti.bytes=s-t,i}var tn=function e(t,r,i){r=r||[],i=i||0;for(var n=i;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-n+1,r};let ts=(e,t,r=0)=>(tn(e,t,r),t),to=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,ta=(e,t)=>{let r=t.byteLength,i=to(e),n=i+to(r),s=new Uint8Array(n+r);return ts(e,s,0),ts(r,s,i),s.set(t,n),new tc(e,r,t,s)};class tc{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let tl=({name:e,code:t,encode:r})=>new tu(e,t,r);class tu{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?ta(this.code,t):t.then(e=>ta(this.code,e))}throw Error("Unknown type, must be binary type")}}let th=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var tf=Object.freeze({__proto__:null,sha256:tl({name:"sha2-256",code:18,encode:th("SHA-256")}),sha512:tl({name:"sha2-512",code:19,encode:th("SHA-512")})}),td=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:eT,digest:e=>ta(0,eT(e))}});new TextEncoder,new TextDecoder;let tp={...eG,...eW,...eJ,...eZ,...eY,...e6,...e8,...e3,...e9,...tr};function tg(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...tf,...td});let ty=tg("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),tb=tg("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=eC((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),tm={utf8:ty,"utf-8":ty,hex:tp.base16,latin1:tb,ascii:tb,binary:tb,...tp};function tw(e,t="utf8"){let r=tm[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function tv(e,t="utf8"){let r=tm[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?eR(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function tE(e){return(0,n.safeJsonParse)(tw(tv(e,e_),eP))}function tx(e){return tw(tv((0,n.safeJsonStringify)(e),eP),e_)}function tI(e){return["did","key","z"+tw(eB([tv("K36",eD),e]),eD)].join(":")}function tS(e){let t=e.split("."),r=tE(t[0]);return{header:r,payload:tE(t[1]),signature:tv(t[2],e_),data:tv(t.slice(0,2).join("."),eA)}}function tO(e=h(32)){let t=eO.getPublicKey(e);return{secretKey:eB([e,t]),publicKey:t}}async function t_(e,t,r,n,s=(0,i.fromMiliseconds)(Date.now())){var o,a;let c={alg:"EdDSA",typ:"JWT"},l={iss:tI(n.publicKey),sub:e,aud:t,iat:s,exp:s+r},u=tv([tx((o={header:c,payload:l}).header),tx(o.payload)].join("."),eA);return[tx((a={header:c,payload:l,signature:eO.sign(u,n.secretKey.slice(0,32))}).header),tx(a.payload),tw(a.signature,e_)].join(".")}},80577:function(e,t,r){"use strict";r.r(t),r.d(t,{safeJsonParse:function(){return s},safeJsonStringify:function(){return o}});let i=e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t),n=e=>JSON.parse(e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3'),(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t);function s(e){if("string"!=typeof e)throw Error(`Cannot safe json parse value of type ${typeof e}`);try{return n(e)}catch(t){return e}}function o(e){return"string"==typeof e?e:i(e)||""}},70213:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(12658),t),i.__exportStar(r(75127),t)},12658:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},75127:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},40537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(78627),t),i.__exportStar(r(59854),t),i.__exportStar(r(3205),t),i.__exportStar(r(70213),t)},3205:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(62494).__exportStar(r(71146),t)},71146:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;class r{}t.IWatch=r},68353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;let i=r(70213);t.toMiliseconds=function(e){return e*i.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/i.ONE_THOUSAND)}},86029:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}},78627:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(86029),t),i.__exportStar(r(68353),t)},59854:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){let t=this.get(e);if(void 0!==t.elapsed)throw Error(`Watch already stopped for label: ${e}`);let r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){let t=this.timestamps.get(e);if(void 0===t)throw Error(`No timestamp found for label: ${e}`);return t}elapsed(e){let t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=r,t.default=r},62494:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return s},__asyncDelegator:function(){return v},__asyncGenerator:function(){return w},__asyncValues:function(){return E},__await:function(){return m},__awaiter:function(){return u},__classPrivateFieldGet:function(){return O},__classPrivateFieldSet:function(){return _},__createBinding:function(){return f},__decorate:function(){return a},__exportStar:function(){return d},__extends:function(){return n},__generator:function(){return h},__importDefault:function(){return S},__importStar:function(){return I},__makeTemplateObject:function(){return x},__metadata:function(){return l},__param:function(){return c},__read:function(){return g},__rest:function(){return o},__spread:function(){return y},__spreadArrays:function(){return b},__values:function(){return p}});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function a(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,i){t(r,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,i){return new(r||(r=Promise))(function(n,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function h(e,t){var r,i,n,s,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function f(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}function d(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){n[e]&&(i[e]=function(t){return new Promise(function(r,i){s.push([e,t,r,i])>1||a(e,t)})})}function a(e,t){try{var r;(r=n[e](t)).value instanceof m?Promise.resolve(r.value.v).then(c,l):u(s[0][2],r)}catch(e){u(s[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function v(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,n){t[i]=e[i]?function(t){return(r=!r)?{value:m(e[i](t)),done:"return"===i}:n?n(t):t}:n}}function E(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,n){!function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)}(i,n,(t=e[r](t)).done,t.value)})}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function I(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function _(e,t,r){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},67045:function(e,t,r){"use strict";r.d(t,{tQ:function(){return u},Vv:function(){return z}});class i extends Error{constructor(e,t={}){let r=t.cause instanceof i?t.cause.details:t.cause?.message?t.cause.message:t.details,n=t.cause instanceof i&&t.cause.docsPath||t.docsPath;super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...n?[`Docs: https://abitype.dev${n}`]:[],...r?[`Details: ${r}`]:[],"Version: abitype@1.0.8"].join("\n")),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),t.cause&&(this.cause=t.cause),this.details=r,this.docsPath=n,this.metaMessages=t.metaMessages,this.shortMessage=e}}function n(e,t){let r=e.exec(t);return r?.groups}let s=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,o=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,a=/^\(.+?\).*?$/,c=/^tuple(?<array>(\[(\d*)\])*)$/;function l(e){let t="",r=e.length;for(let i=0;i<r;i++)t+=function e(t){let r=t.type;if(c.test(t.type)&&"components"in t){r="(";let i=t.components.length;for(let n=0;n<i;n++)r+=e(t.components[n]),n<i-1&&(r+=", ");let s=n(c,t.type);return r+=`)${s?.array??""}`,e({...t,type:r})}return("indexed"in t&&t.indexed&&(r=`${r} indexed`),t.name)?`${r} ${t.name}`:r}(e[i]),i!==r-1&&(t+=", ");return t}function u(e){return"function"===e.type?`function ${e.name}(${l(e.inputs)})${e.stateMutability&&"nonpayable"!==e.stateMutability?` ${e.stateMutability}`:""}${e.outputs?.length?` returns (${l(e.outputs)})`:""}`:"event"===e.type?`event ${e.name}(${l(e.inputs)})`:"error"===e.type?`error ${e.name}(${l(e.inputs)})`:"constructor"===e.type?`constructor(${l(e.inputs)})${"payable"===e.stateMutability?" payable":""}`:"fallback"===e.type?`fallback() external${"payable"===e.stateMutability?" payable":""}`:"receive() external payable"}let h=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/,f=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/,d=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/,p=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/,g=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/,y=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/,b=/^receive\(\) external payable$/,m=new Set(["indexed"]),w=new Set(["calldata","memory","storage"]);class v extends i{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class E extends i{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class x extends i{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class I extends i{constructor({param:e,name:t}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${t}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class S extends i{constructor({param:e,type:t,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${t?` in "${t}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class O extends i{constructor({param:e,type:t,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${t?` in "${t}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class _ extends i{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class P extends i{constructor({signature:e,type:t}){super(`Invalid ${t} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class A extends i{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class D extends i{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class R extends i{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class C extends i{constructor({current:e,depth:t}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${t>0?"opening":"closing"} parentheses.`],details:`Depth "${t}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}let B=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]),U=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,T=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,N=/^u?int$/;function k(e,t){var r,i;let c;let l=function(e,t,r){let i="";if(r)for(let e of Object.entries(r)){if(!e)continue;let t="";for(let r of e[1])t+=`[${r.type}${r.name?`:${r.name}`:""}]`;i+=`(${e[0]}{${t}})`}return t?`${t}:${e}${i}`:e}(e,t?.type,t?.structs);if(B.has(l))return B.get(l);let u=a.test(e),h=n(u?T:U,e);if(!h)throw new x({param:e});if(h.name&&("address"===(r=h.name)||"bool"===r||"function"===r||"string"===r||"tuple"===r||s.test(r)||o.test(r)||$.test(r)))throw new I({param:e,name:h.name});let f=h.name?{name:h.name}:{},d="indexed"===h.modifier?{indexed:!0}:{},p=t?.structs??{},g={};if(u){c="tuple";let e=j(h.type),t=[],r=e.length;for(let i=0;i<r;i++)t.push(k(e[i],{structs:p}));g={components:t}}else if(h.type in p)c="tuple",g={components:p[h.type]};else if(N.test(h.type))c=`${h.type}256`;else if(c=h.type,t?.type!=="struct"&&!L(c))throw new E({type:c});if(h.modifier){if(!t?.modifiers?.has?.(h.modifier))throw new S({param:e,type:t?.type,modifier:h.modifier});if(w.has(h.modifier)&&(i=c,!h.array&&"bytes"!==i&&"string"!==i&&"tuple"!==i))throw new O({param:e,type:t?.type,modifier:h.modifier})}let y={type:`${c}${h.array??""}`,...f,...d,...g};return B.set(l,y),y}function j(e,t=[],r="",i=0){let n=e.trim().length;for(let s=0;s<n;s++){let n=e[s],o=e.slice(s+1);switch(n){case",":return 0===i?j(o,[...t,r.trim()]):j(o,t,`${r}${n}`,i);case"(":return j(o,t,`${r}${n}`,i+1);case")":return j(o,t,`${r}${n}`,i-1);default:return j(o,t,`${r}${n}`,i)}}if(""===r)return t;if(0!==i)throw new C({current:r,depth:i});return t.push(r.trim()),t}function L(e){return"address"===e||"bool"===e||"function"===e||"string"===e||s.test(e)||o.test(e)}let $=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/,M=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function z(e){let t=function(e){let t={},r=e.length;for(let i=0;i<r;i++){let r=e[i];if(!p.test(r))continue;let s=n(p,r);if(!s)throw new P({signature:r,type:"struct"});let o=s.properties.split(";"),a=[],c=o.length;for(let e=0;e<c;e++){let t=o[e].trim();if(!t)continue;let r=k(t,{type:"struct"});a.push(r)}if(!a.length)throw new D({signature:r});t[s.name]=a}let i={},s=Object.entries(t),o=s.length;for(let e=0;e<o;e++){let[r,o]=s[e];i[r]=function e(t,r,i=new Set){let s=[],o=t.length;for(let c=0;c<o;c++){let o=t[c];if(a.test(o.type))s.push(o);else{let t=n(M,o.type);if(!t?.type)throw new _({abiParameter:o});let{array:a,type:c}=t;if(c in r){if(i.has(c))throw new R({type:c});s.push({...o,type:`tuple${a??""}`,components:e(r[c]??[],r,new Set([...i,c]))})}else if(L(c))s.push(o);else throw new v({type:c})}}return s}(o,t)}return i}(e),r=[],i=e.length;for(let s=0;s<i;s++){let i=e[s];p.test(i)||r.push(function(e,t={}){if(d.test(e))return function(e,t={}){let r=n(d,e);if(!r)throw new P({signature:e,type:"function"});let i=j(r.parameters),s=[],o=i.length;for(let e=0;e<o;e++)s.push(k(i[e],{modifiers:w,structs:t,type:"function"}));let a=[];if(r.returns){let e=j(r.returns),i=e.length;for(let r=0;r<i;r++)a.push(k(e[r],{modifiers:w,structs:t,type:"function"}))}return{name:r.name,type:"function",stateMutability:r.stateMutability??"nonpayable",inputs:s,outputs:a}}(e,t);if(f.test(e))return function(e,t={}){let r=n(f,e);if(!r)throw new P({signature:e,type:"event"});let i=j(r.parameters),s=[],o=i.length;for(let e=0;e<o;e++)s.push(k(i[e],{modifiers:m,structs:t,type:"event"}));return{name:r.name,type:"event",inputs:s}}(e,t);if(h.test(e))return function(e,t={}){let r=n(h,e);if(!r)throw new P({signature:e,type:"error"});let i=j(r.parameters),s=[],o=i.length;for(let e=0;e<o;e++)s.push(k(i[e],{structs:t,type:"error"}));return{name:r.name,type:"error",inputs:s}}(e,t);if(g.test(e))return function(e,t={}){let r=n(g,e);if(!r)throw new P({signature:e,type:"constructor"});let i=j(r.parameters),s=[],o=i.length;for(let e=0;e<o;e++)s.push(k(i[e],{structs:t,type:"constructor"}));return{type:"constructor",stateMutability:r.stateMutability??"nonpayable",inputs:s}}(e,t);if(y.test(e))return function(e){let t=n(y,e);if(!t)throw new P({signature:e,type:"fallback"});return{type:"fallback",stateMutability:t.stateMutability??"nonpayable"}}(e);if(b.test(e))return{type:"receive",stateMutability:"payable"};throw new A({signature:e})}(i,t))}return r}},8374:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});var i=r(9520);function n(e){return{address:e.address,amount:i.xS(e.amount),index:i.xS(e.index),validatorIndex:i.xS(e.validatorIndex)}}function s(e){return{..."bigint"==typeof e.baseFeePerGas&&{baseFeePerGas:i.xS(e.baseFeePerGas)},..."bigint"==typeof e.blobBaseFee&&{blobBaseFee:i.xS(e.blobBaseFee)},..."string"==typeof e.feeRecipient&&{feeRecipient:e.feeRecipient},..."bigint"==typeof e.gasLimit&&{gasLimit:i.xS(e.gasLimit)},..."bigint"==typeof e.number&&{number:i.xS(e.number)},..."bigint"==typeof e.prevRandao&&{prevRandao:i.xS(e.prevRandao)},..."bigint"==typeof e.time&&{time:i.xS(e.time)},...e.withdrawals&&{withdrawals:e.withdrawals.map(n)}}}},87034:function(e,t,r){"use strict";r.d(t,{$s:function(){return f},Dp:function(){return c},M6:function(){return h},dp:function(){return u},mL:function(){return l}}),r(68568);var i=r(3567),n=r(9520),s=r(16192),o=r(16977);r(60763);let a=new TextEncoder;function c(e){return e instanceof Uint8Array?e:"string"==typeof e?function(e,t={}){let{size:r}=t,a=e;r&&(o.Yf(e,r),a=n.eh(e,r));let c=a.slice(2);c.length%2&&(c=`0${c}`);let l=c.length/2,u=new Uint8Array(l);for(let e=0,t=0;e<l;e++){let r=s.DN(c.charCodeAt(t++)),n=s.DN(c.charCodeAt(t++));if(void 0===r||void 0===n)throw new i.G(`Invalid byte sequence ("${c[t-2]}${c[t-1]}" in "${c}").`);u[e]=16*r+n}return u}(e):e instanceof Uint8Array?e:new Uint8Array(e)}function l(e,t={}){let{size:r}=t,i=a.encode(e);return"number"==typeof r?(s.Yf(i,r),s.vk(i,{dir:"right",size:r})):i}function u(e){return e.length}class h extends i.G{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class f extends i.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}},3567:function(e,t,r){"use strict";r.d(t,{G:function(){return i}});class i extends Error{constructor(e,t={}){let r=(()=>{if(t.cause instanceof i){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&"string"==typeof t.cause.details?t.cause.details:t.cause?.message?t.cause.message:t.details})(),n=t.cause instanceof i&&t.cause.docsPath||t.docsPath,s=`https://oxlib.sh${n??""}`;super([e||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...r||n?["",r?`Details: ${r}`:void 0,n?`See: ${s}`:void 0]:[]].filter(e=>"string"==typeof e).join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=t.cause,this.details=r,this.docs=s,this.docsPath=n,this.shortMessage=e}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&t.cause?e(t.cause,r):r?null:t}(this,e)}}},9520:function(e,t,r){"use strict";r.d(t,{$s:function(){return m},Dp:function(){return c},M6:function(){return b},O3:function(){return l},Q_:function(){return d},dp:function(){return g},eh:function(){return p},mL:function(){return f},xS:function(){return h},xv:function(){return u},zo:function(){return a}}),r(68568),r(87034);var i=r(3567);r(16192);var n=r(16977);r(60763);let s=new TextEncoder,o=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function a(...e){return`0x${e.reduce((e,t)=>e+t.replace("0x",""),"")}`}function c(e){return e instanceof Uint8Array?u(e):Array.isArray(e)?u(new Uint8Array(e)):e}function l(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(n.Yf(r,t.size),d(r,t.size)):r}function u(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=o[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(n.Yf(i,t.size),p(i,t.size)):i}function h(e,t={}){let r;let{signed:i,size:n}=t,s=BigInt(e);n?r=i?(1n<<8n*BigInt(n)-1n)-1n:2n**(8n*BigInt(n))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof r&&i?-r-1n:0;if(r&&s>r||s<o){let t="bigint"==typeof e?"n":"";throw new y({max:r?`${r}${t}`:void 0,min:`${o}${t}`,signed:i,size:n,value:`${e}${t}`})}let a=(i&&s<0?(1n<<BigInt(8*n))+BigInt(s):s).toString(16),c=`0x${a}`;return n?d(c,n):c}function f(e,t={}){return u(s.encode(e),t)}function d(e,t){return n.vk(e,{dir:"left",size:t})}function p(e,t){return n.vk(e,{dir:"right",size:t})}function g(e){return Math.ceil((e.length-2)/2)}class y extends i.G{constructor({max:e,min:t,signed:r,size:i,value:n}){super(`Number \`${n}\` is not in safe${i?` ${8*i}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${t}\` to \`${e}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class b extends i.G{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class m extends i.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}},60763:function(e,t,r){"use strict";function i(e,t,r){return JSON.stringify(e,(e,r)=>"function"==typeof t?t(e,r):"bigint"==typeof r?r.toString()+"#__bigint":r,r)}r.d(t,{P:function(){return i}})},16192:function(e,t,r){"use strict";r.d(t,{DN:function(){return o},Yf:function(){return n},vk:function(){return a}});var i=r(87034);function n(e,t){if(i.dp(e)>t)throw new i.M6({givenSize:i.dp(e),maxSize:t})}let s={zero:48,nine:57,A:65,F:70,a:97,f:102};function o(e){return e>=s.zero&&e<=s.nine?e-s.zero:e>=s.A&&e<=s.F?e-(s.A-10):e>=s.a&&e<=s.f?e-(s.a-10):void 0}function a(e,t={}){let{dir:r,size:n=32}=t;if(0===n)return e;if(e.length>n)throw new i.$s({size:e.length,targetSize:n,type:"Bytes"});let s=new Uint8Array(n);for(let t=0;t<n;t++){let i="right"===r;s[i?t:n-t-1]=e[i?t:e.length-t-1]}return s}},16977:function(e,t,r){"use strict";r.d(t,{Yf:function(){return n},vk:function(){return s}});var i=r(9520);function n(e,t){if(i.dp(e)>t)throw new i.M6({givenSize:i.dp(e),maxSize:t})}function s(e,t={}){let{dir:r,size:n=32}=t;if(0===n)return e;let s=e.replace("0x","");if(s.length>2*n)throw new i.$s({size:Math.ceil(s.length/2),targetSize:n,type:"Hex"});return`0x${s["right"===r?"padEnd":"padStart"](2*n,"0")}`}},42560:function(e,t,r){"use strict";function i(e){return"string"==typeof e?{address:e,type:"json-rpc"}:e}r.d(t,{T:function(){return i}})},59550:function(e,t,r){"use strict";r.d(t,{R:function(){return x}});var i=r(67045),n=r(8374),s=r(42560),o=r(22109),a=r(69365),c=r(440),l=r(34981),u=r(54907),h=r(39857),f=r(12497),d=r(79251),p=r(74318),g=r(46819),y=r(98878),b=r(51101),m=r(89890),w=r(53521),v=r(12037),E=r(12187);async function x(e,t){let{account:o=e.account,authorizationList:h,batch:d=!!e.batch?.multicall,blockNumber:p,blockTag:w=e.experimental_blockTag??"latest",accessList:x,blobs:O,blockOverrides:_,code:P,data:A,factory:D,factoryData:R,gas:C,gasPrice:B,maxFeePerBlobGas:U,maxFeePerGas:T,maxPriorityFeePerGas:N,nonce:k,to:j,value:L,stateOverride:$,...M}=t,z=o?(0,s.T)(o):void 0;if(P&&(D||R))throw new c.G("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(P&&j)throw new c.G("Cannot provide both `code` & `to` as parameters.");let q=P&&A,F=D&&R&&j&&A,V=q||F,K=q?S({code:P,data:A}):F?function(e){let{data:t,factory:r,factoryData:n,to:s}=e;return(0,f.w)({abi:(0,i.Vv)(["constructor(address, bytes, address, bytes)"]),bytecode:a.pG,args:[s,t,r,n]})}({data:A,factory:D,factoryData:R,to:j}):A;try{(0,E.F)(t);let r=("bigint"==typeof p?(0,g.eC)(p):void 0)||w,i=_?n.o(_):void 0,s=(0,v.mF)($),o=e.chain?.formatters?.transactionRequest?.format,a=(o||m.tG)({...(0,b.K)(M,{format:o}),from:z?.address,accessList:x,authorizationList:h,blobs:O,data:K,gas:C,gasPrice:B,maxFeePerBlobGas:U,maxFeePerGas:T,maxPriorityFeePerGas:N,nonce:k,to:V?void 0:j,value:L});if(d&&function({request:e}){let{data:t,to:r,...i}=e;return!(!t||t.startsWith("0x82ad56cb"))&&!!r&&!(Object.values(i).filter(e=>void 0!==e).length>0)}({request:a})&&!s&&!i)try{return await I(e,{...a,blockNumber:p,blockTag:w})}catch(e){if(!(e instanceof l.pZ)&&!(e instanceof l.mm))throw e}let c=(()=>{let e=[a,r];return s&&i?[...e,s,i]:s?[...e,s]:i?[...e,{},i]:e})(),u=await e.request({method:"eth_call",params:c});if("0x"===u)return{data:void 0};return{data:u}}catch(o){let i=function(e){if(!(e instanceof c.G))return;let t=e.walk();return"object"==typeof t?.data?t.data?.data:t.data}(o),{offchainLookup:n,offchainLookupSignature:s}=await Promise.resolve().then(r.bind(r,81149));if(!1!==e.ccipRead&&i?.slice(0,10)===s&&j)return{data:await n(e,{data:i,to:j})};if(V&&i?.slice(0,10)==="0x101bb98d")throw new u.Mo({factory:D});throw(0,y.P)(o,{...t,account:z,chain:e.chain})}}async function I(e,t){let{batchSize:r=1024,deployless:i=!1,wait:n=0}="object"==typeof e.batch?.multicall?e.batch.multicall:{},{blockNumber:s,blockTag:c=e.experimental_blockTag??"latest",data:f,to:y}=t,b=(()=>{if(i)return null;if(t.multicallAddress)return t.multicallAddress;if(e.chain)return(0,p.L)({blockNumber:s,chain:e.chain,contract:"multicall3"});throw new l.pZ})(),m=("bigint"==typeof s?(0,g.eC)(s):void 0)||c,{schedule:v}=(0,w.S)({id:`${e.uid}.${m}`,wait:n,shouldSplitBatch:e=>e.reduce((e,{data:t})=>e+(t.length-2),0)>2*r,fn:async t=>{let r=t.map(e=>({allowFailure:!0,callData:e.data,target:e.to})),i=(0,d.R)({abi:o.F8,args:[r],functionName:"aggregate3"}),n=await e.request({method:"eth_call",params:[{...null===b?{data:S({code:a.xd,data:i})}:{to:b,data:i}},m]});return(0,h.k)({abi:o.F8,args:[r],functionName:"aggregate3",data:n||"0x"})}}),[{returnData:E,success:x}]=await v({data:f,to:y});if(!x)throw new u.VQ({data:E});return"0x"===E?{data:void 0}:{data:E}}function S(e){let{code:t,data:r}=e;return(0,f.w)({abi:(0,i.Vv)(["constructor(bytes, bytes)"]),bytecode:a.NO,args:[t,r]})}},22109:function(e,t,r){"use strict";r.d(t,{F8:function(){return i},Yi:function(){return n}});let i=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],n=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],s=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}];[...s],[...s]},69365:function(e,t,r){"use strict";r.d(t,{NO:function(){return i},pG:function(){return n},xd:function(){return s}});let i="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",n="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",s="0x608060405234801561001057600080fd5b506115b9806100206000396000f3fe6080604052600436106100f35760003560e01c80634d2301cc1161008a578063a8b0574e11610059578063a8b0574e14610325578063bce38bd714610350578063c3077fa914610380578063ee82ac5e146103b2576100f3565b80634d2301cc1461026257806372425d9d1461029f57806382ad56cb146102ca57806386d516e8146102fa576100f3565b80633408e470116100c65780633408e470146101af578063399542e9146101da5780633e64a6961461020c57806342cbb15c14610237576100f3565b80630f28c97d146100f8578063174dea7114610123578063252dba421461015357806327e86d6e14610184575b600080fd5b34801561010457600080fd5b5061010d6103ef565b60405161011a9190610c0a565b60405180910390f35b61013d60048036038101906101389190610c94565b6103f7565b60405161014a9190610e94565b60405180910390f35b61016d60048036038101906101689190610f0c565b610615565b60405161017b92919061101b565b60405180910390f35b34801561019057600080fd5b506101996107ab565b6040516101a69190611064565b60405180910390f35b3480156101bb57600080fd5b506101c46107b7565b6040516101d19190610c0a565b60405180910390f35b6101f460048036038101906101ef91906110ab565b6107bf565b6040516102039392919061110b565b60405180910390f35b34801561021857600080fd5b506102216107e1565b60405161022e9190610c0a565b60405180910390f35b34801561024357600080fd5b5061024c6107e9565b6040516102599190610c0a565b60405180910390f35b34801561026e57600080fd5b50610289600480360381019061028491906111a7565b6107f1565b6040516102969190610c0a565b60405180910390f35b3480156102ab57600080fd5b506102b4610812565b6040516102c19190610c0a565b60405180910390f35b6102e460048036038101906102df919061122a565b61081a565b6040516102f19190610e94565b60405180910390f35b34801561030657600080fd5b5061030f6109e4565b60405161031c9190610c0a565b60405180910390f35b34801561033157600080fd5b5061033a6109ec565b6040516103479190611286565b60405180910390f35b61036a600480360381019061036591906110ab565b6109f4565b6040516103779190610e94565b60405180910390f35b61039a60048036038101906103959190610f0c565b610ba6565b6040516103a99392919061110b565b60405180910390f35b3480156103be57600080fd5b506103d960048036038101906103d491906112cd565b610bca565b6040516103e69190611064565b60405180910390f35b600042905090565b60606000808484905090508067ffffffffffffffff81111561041c5761041b6112fa565b5b60405190808252806020026020018201604052801561045557816020015b610442610bd5565b81526020019060019003908161043a5790505b5092503660005b828110156105c957600085828151811061047957610478611329565b5b6020026020010151905087878381811061049657610495611329565b5b90506020028101906104a89190611367565b925060008360400135905080860195508360000160208101906104cb91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16818580606001906104f2919061138f565b604051610500929190611431565b60006040518083038185875af1925050503d806000811461053d576040519150601f19603f3d011682016040523d82523d6000602084013e610542565b606091505b5083600001846020018290528215151515815250505081516020850135176105bc577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260846000fd5b826001019250505061045c565b5082341461060c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610603906114a7565b60405180910390fd5b50505092915050565b6000606043915060008484905090508067ffffffffffffffff81111561063e5761063d6112fa565b5b60405190808252806020026020018201604052801561067157816020015b606081526020019060019003908161065c5790505b5091503660005b828110156107a157600087878381811061069557610694611329565b5b90506020028101906106a791906114c7565b92508260000160208101906106bc91906111a7565b73ffffffffffffffffffffffffffffffffffffffff168380602001906106e2919061138f565b6040516106f0929190611431565b6000604051808303816000865af19150503d806000811461072d576040519150601f19603f3d011682016040523d82523d6000602084013e610732565b606091505b5086848151811061074657610745611329565b5b60200260200101819052819250505080610795576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161078c9061153b565b60405180910390fd5b81600101915050610678565b5050509250929050565b60006001430340905090565b600046905090565b6000806060439250434091506107d68686866109f4565b905093509350939050565b600048905090565b600043905090565b60008173ffffffffffffffffffffffffffffffffffffffff16319050919050565b600044905090565b606060008383905090508067ffffffffffffffff81111561083e5761083d6112fa565b5b60405190808252806020026020018201604052801561087757816020015b610864610bd5565b81526020019060019003908161085c5790505b5091503660005b828110156109db57600084828151811061089b5761089a611329565b5b602002602001015190508686838181106108b8576108b7611329565b5b90506020028101906108ca919061155b565b92508260000160208101906108df91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060400190610905919061138f565b604051610913929190611431565b6000604051808303816000865af19150503d8060008114610950576040519150601f19603f3d011682016040523d82523d6000602084013e610955565b606091505b5082600001836020018290528215151515815250505080516020840135176109cf577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260646000fd5b8160010191505061087e565b50505092915050565b600045905090565b600041905090565b606060008383905090508067ffffffffffffffff811115610a1857610a176112fa565b5b604051908082528060200260200182016040528015610a5157816020015b610a3e610bd5565b815260200190600190039081610a365790505b5091503660005b82811015610b9c576000848281518110610a7557610a74611329565b5b60200260200101519050868683818110610a9257610a91611329565b5b9050602002810190610aa491906114c7565b9250826000016020810190610ab991906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060200190610adf919061138f565b604051610aed929190611431565b6000604051808303816000865af19150503d8060008114610b2a576040519150601f19603f3d011682016040523d82523d6000602084013e610b2f565b606091505b508260000183602001829052821515151581525050508715610b90578060000151610b8f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b869061153b565b60405180910390fd5b5b81600101915050610a58565b5050509392505050565b6000806060610bb7600186866107bf565b8093508194508295505050509250925092565b600081409050919050565b6040518060400160405280600015158152602001606081525090565b6000819050919050565b610c0481610bf1565b82525050565b6000602082019050610c1f6000830184610bfb565b92915050565b600080fd5b600080fd5b600080fd5b600080fd5b600080fd5b60008083601f840112610c5457610c53610c2f565b5b8235905067ffffffffffffffff811115610c7157610c70610c34565b5b602083019150836020820283011115610c8d57610c8c610c39565b5b9250929050565b60008060208385031215610cab57610caa610c25565b5b600083013567ffffffffffffffff811115610cc957610cc8610c2a565b5b610cd585828601610c3e565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60008115159050919050565b610d2281610d0d565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610d62578082015181840152602081019050610d47565b83811115610d71576000848401525b50505050565b6000601f19601f8301169050919050565b6000610d9382610d28565b610d9d8185610d33565b9350610dad818560208601610d44565b610db681610d77565b840191505092915050565b6000604083016000830151610dd96000860182610d19565b5060208301518482036020860152610df18282610d88565b9150508091505092915050565b6000610e0a8383610dc1565b905092915050565b6000602082019050919050565b6000610e2a82610ce1565b610e348185610cec565b935083602082028501610e4685610cfd565b8060005b85811015610e825784840389528151610e638582610dfe565b9450610e6e83610e12565b925060208a01995050600181019050610e4a565b50829750879550505050505092915050565b60006020820190508181036000830152610eae8184610e1f565b905092915050565b60008083601f840112610ecc57610ecb610c2f565b5b8235905067ffffffffffffffff811115610ee957610ee8610c34565b5b602083019150836020820283011115610f0557610f04610c39565b5b9250929050565b60008060208385031215610f2357610f22610c25565b5b600083013567ffffffffffffffff811115610f4157610f40610c2a565b5b610f4d85828601610eb6565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b6000610f918383610d88565b905092915050565b6000602082019050919050565b6000610fb182610f59565b610fbb8185610f64565b935083602082028501610fcd85610f75565b8060005b858110156110095784840389528151610fea8582610f85565b9450610ff583610f99565b925060208a01995050600181019050610fd1565b50829750879550505050505092915050565b60006040820190506110306000830185610bfb565b81810360208301526110428184610fa6565b90509392505050565b6000819050919050565b61105e8161104b565b82525050565b60006020820190506110796000830184611055565b92915050565b61108881610d0d565b811461109357600080fd5b50565b6000813590506110a58161107f565b92915050565b6000806000604084860312156110c4576110c3610c25565b5b60006110d286828701611096565b935050602084013567ffffffffffffffff8111156110f3576110f2610c2a565b5b6110ff86828701610eb6565b92509250509250925092565b60006060820190506111206000830186610bfb565b61112d6020830185611055565b818103604083015261113f8184610e1f565b9050949350505050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061117482611149565b9050919050565b61118481611169565b811461118f57600080fd5b50565b6000813590506111a18161117b565b92915050565b6000602082840312156111bd576111bc610c25565b5b60006111cb84828501611192565b91505092915050565b60008083601f8401126111ea576111e9610c2f565b5b8235905067ffffffffffffffff81111561120757611206610c34565b5b60208301915083602082028301111561122357611222610c39565b5b9250929050565b6000806020838503121561124157611240610c25565b5b600083013567ffffffffffffffff81111561125f5761125e610c2a565b5b61126b858286016111d4565b92509250509250929050565b61128081611169565b82525050565b600060208201905061129b6000830184611277565b92915050565b6112aa81610bf1565b81146112b557600080fd5b50565b6000813590506112c7816112a1565b92915050565b6000602082840312156112e3576112e2610c25565b5b60006112f1848285016112b8565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600080fd5b600080fd5b600080fd5b60008235600160800383360303811261138357611382611358565b5b80830191505092915050565b600080833560016020038436030381126113ac576113ab611358565b5b80840192508235915067ffffffffffffffff8211156113ce576113cd61135d565b5b6020830192506001820236038313156113ea576113e9611362565b5b509250929050565b600081905092915050565b82818337600083830152505050565b600061141883856113f2565b93506114258385846113fd565b82840190509392505050565b600061143e82848661140c565b91508190509392505050565b600082825260208201905092915050565b7f4d756c746963616c6c333a2076616c7565206d69736d61746368000000000000600082015250565b6000611491601a8361144a565b915061149c8261145b565b602082019050919050565b600060208201905081810360008301526114c081611484565b9050919050565b6000823560016040038336030381126114e3576114e2611358565b5b80830191505092915050565b7f4d756c746963616c6c333a2063616c6c206661696c6564000000000000000000600082015250565b600061152560178361144a565b9150611530826114ef565b602082019050919050565b6000602082019050818103600083015261155481611518565b9050919050565b60008235600160600383360303811261157757611576611358565b5b8083019150509291505056fea264697066735822122020c1bc9aacf8e4a6507193432a895a8e77094f45a1395583f07b24e860ef06cd64736f6c634300080c0033"},33410:function(e,t,r){"use strict";r.d(t,{zL:function(){return i}});let i=2n**256n-1n},4419:function(e,t,r){"use strict";r.d(t,{$:function(){return i},Up:function(){return n},hZ:function(){return s}});let i={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},n={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},s={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"}},95907:function(e,t,r){"use strict";r.d(t,{Zn:function(){return n},ez:function(){return i}});let i={gwei:9,wei:18},n={ether:-9,wei:9}},24530:function(e,t,r){"use strict";r.d(t,{CI:function(){return E},M4:function(){return h},MS:function(){return p},MX:function(){return b},S4:function(){return w},Zh:function(){return d},cO:function(){return a},dh:function(){return v},eF:function(){return m},fM:function(){return o},fs:function(){return f},gr:function(){return u},hn:function(){return x},wM:function(){return I},wb:function(){return l},xB:function(){return c},xL:function(){return y},yP:function(){return g}});var i=r(64445),n=r(38525),s=r(440);class o extends s.G{constructor({docsPath:e}){super("A constructor was not found on the ABI.\nMake sure you are using the correct ABI and that the constructor exists on it.",{docsPath:e,name:"AbiConstructorNotFoundError"})}}class a extends s.G{constructor({docsPath:e}){super("Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.\nMake sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists.",{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class c extends s.G{constructor({data:e,params:t,size:r}){super(`Data size of ${r} bytes is too small for given parameters.`,{metaMessages:[`Params: (${(0,i.h)(t,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=t,this.size=r}}class l extends s.G{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class u extends s.G{constructor({expectedLength:e,givenLength:t,type:r}){super(`ABI encoding array length mismatch for type ${r}.
Expected length: ${e}
Given length: ${t}`,{name:"AbiEncodingArrayLengthMismatchError"})}}class h extends s.G{constructor({expectedSize:e,value:t}){super(`Size of bytes "${t}" (bytes${(0,n.d)(t)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class f extends s.G{constructor({expectedLength:e,givenLength:t}){super(`ABI encoding params/values length mismatch.
Expected length (params): ${e}
Given length (values): ${t}`,{name:"AbiEncodingLengthMismatchError"})}}class d extends s.G{constructor(e,{docsPath:t}){super(`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).
Cannot encode error result without knowing what the parameter types are.
Make sure you are using the correct ABI and that the inputs exist on it.`,{docsPath:t,name:"AbiErrorInputsNotFoundError"})}}class p extends s.G{constructor(e,{docsPath:t}={}){super(`Error ${e?`"${e}" `:""}not found on ABI.
Make sure you are using the correct ABI and that the error exists on it.`,{docsPath:t,name:"AbiErrorNotFoundError"})}}class g extends s.G{constructor(e,{docsPath:t}){super(`Encoded error signature "${e}" not found on ABI.
Make sure you are using the correct ABI and that the error exists on it.
You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`,{docsPath:t,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class y extends s.G{constructor(e,{docsPath:t}={}){super(`Function ${e?`"${e}" `:""}not found on ABI.
Make sure you are using the correct ABI and that the function exists on it.`,{docsPath:t,name:"AbiFunctionNotFoundError"})}}class b extends s.G{constructor(e,{docsPath:t}){super(`Function "${e}" does not contain any \`outputs\` on ABI.
Cannot decode function result without knowing what the parameter types are.
Make sure you are using the correct ABI and that the function exists on it.`,{docsPath:t,name:"AbiFunctionOutputsNotFoundError"})}}class m extends s.G{constructor(e,{docsPath:t}){super(`Encoded function signature "${e}" not found on ABI.
Make sure you are using the correct ABI and that the function exists on it.
You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`,{docsPath:t,name:"AbiFunctionSignatureNotFoundError"})}}class w extends s.G{constructor(e,t){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${(0,i.t)(e.abiItem)}\`, and`,`\`${t.type}\` in \`${(0,i.t)(t.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class v extends s.G{constructor(e,{docsPath:t}){super(`Type "${e}" is not a valid encoding type.
Please provide a valid ABI type.`,{docsPath:t,name:"InvalidAbiEncodingType"})}}class E extends s.G{constructor(e,{docsPath:t}){super(`Type "${e}" is not a valid decoding type.
Please provide a valid ABI type.`,{docsPath:t,name:"InvalidAbiDecodingType"})}}class x extends s.G{constructor(e){super(`Value "${e}" is not a valid array.`,{name:"InvalidArrayError"})}}class I extends s.G{constructor(e){super(`"${e}" is not a valid definition type.
Valid types: "function", "event", "error"`,{name:"InvalidDefinitionTypeError"})}}},49787:function(e,t,r){"use strict";r.d(t,{b:function(){return n}});var i=r(440);class n extends i.G{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}},440:function(e,t,r){"use strict";r.d(t,{G:function(){return s}});let i="2.36.0",n={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${i}`};class s extends Error{constructor(e,t={}){let r=t.cause instanceof s?t.cause.details:t.cause?.message?t.cause.message:t.details,o=t.cause instanceof s&&t.cause.docsPath||t.docsPath,a=n.getDocsUrl?.({...t,docsPath:o});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...a?[`Docs: ${a}`]:[],...r?[`Details: ${r}`]:[],...n.version?[`Version: ${n.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=o,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=i}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}},34981:function(e,t,r){"use strict";r.d(t,{mm:function(){return n},pZ:function(){return s}});var i=r(440);class n extends i.G{constructor({blockNumber:e,chain:t,contract:r}){super(`Chain "${t.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class s extends i.G{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}},54907:function(e,t,r){"use strict";r.d(t,{Mo:function(){return u},VQ:function(){return h},cg:function(){return l}});var i=r(42560);r(4419),r(29415),r(64445),r(50971),r(14931);var n=r(84562),s=r(70097);r(24530);var o=r(440),a=r(64996),c=r(84312);r(88885);class l extends o.G{constructor(e,{account:t,docsPath:r,chain:o,data:l,gas:u,gasPrice:h,maxFeePerGas:f,maxPriorityFeePerGas:d,nonce:p,to:g,value:y,stateOverride:b}){let m=t?(0,i.T)(t):void 0,w=(0,c.xr)({from:m?.address,to:g,value:void 0!==y&&`${(0,n.d)(y)} ${o?.nativeCurrency?.symbol||"ETH"}`,data:l,gas:u,gasPrice:void 0!==h&&`${(0,s.o)(h)} gwei`,maxFeePerGas:void 0!==f&&`${(0,s.o)(f)} gwei`,maxPriorityFeePerGas:void 0!==d&&`${(0,s.o)(d)} gwei`,nonce:p});b&&(w+=`
${(0,a.Bj)(b)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",w].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class u extends o.G{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class h extends o.G{constructor({data:e,message:t}){super(t||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}},20758:function(e,t,r){"use strict";r.d(t,{KD:function(){return o},T_:function(){return n},lQ:function(){return s}});var i=r(440);class n extends i.G{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class s extends i.G{constructor({length:e,position:t}){super(`Position \`${t}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class o extends i.G{constructor({count:e,limit:t}){super(`Recursive read limit of \`${t}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}},30656:function(e,t,r){"use strict";r.d(t,{$s:function(){return s},W_:function(){return o},mV:function(){return n}});var i=r(440);class n extends i.G{constructor({offset:e,position:t,size:r}){super(`Slice ${"start"===t?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}class s extends i.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}class o extends i.G{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${t} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}},46693:function(e,t,r){"use strict";r.d(t,{J5:function(){return n},M6:function(){return o},yr:function(){return s}});var i=r(440);class n extends i.G{constructor({max:e,min:t,signed:r,size:i,value:n}){super(`Number "${n}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class s extends i.G{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class o extends i.G{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}},183:function(e,t,r){"use strict";r.d(t,{C_:function(){return h},G$:function(){return a},Hh:function(){return o},M_:function(){return s},WF:function(){return f},ZI:function(){return c},cj:function(){return y},cs:function(){return g},dR:function(){return d},pZ:function(){return p},se:function(){return u},vU:function(){return l}});var i=r(70097),n=r(440);class s extends n.G{constructor({cause:e,message:t}={}){let r=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(s,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(s,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class o extends n.G{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${(0,i.o)(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(o,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class a extends n.G{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${(0,i.o)(t)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(a,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class c extends n.G{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(c,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class l extends n.G{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.
Try increasing the nonce or find the latest nonce with \`getTransactionCount\`.`,{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(l,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class u extends n.G{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(u,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class h extends n.G{constructor({cause:e}={}){super("The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account.",{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(h,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class f extends n.G{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(f,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class d extends n.G{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(d,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class p extends n.G{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(p,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class g extends n.G{constructor({cause:e,maxPriorityFeePerGas:t,maxFeePerGas:r}={}){super(`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${(0,i.o)(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${(0,i.o)(r)} gwei`:""}).`,{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(g,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class y extends n.G{constructor({cause:e}){super(`An error occurred while executing: ${e?.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}},32252:function(e,t,r){"use strict";r.d(t,{Gg:function(){return o},W5:function(){return c},bs:function(){return a}});var i=r(67991),n=r(440),s=r(88885);class o extends n.G{constructor({body:e,cause:t,details:r,headers:n,status:o,url:a}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[o&&`Status: ${o}`,`URL: ${(0,s.G)(a)}`,e&&`Request body: ${(0,i.P)(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=n,this.status=o,this.url=a}}class a extends n.G{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${(0,s.G)(r)}`,`Request body: ${(0,i.P)(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}class c extends n.G{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${(0,s.G)(t)}`,`Request body: ${(0,i.P)(e)}`],name:"TimeoutError"})}}},65155:function(e,t,r){"use strict";var i=r(440),n=r(32252);class s extends i.G{constructor(e,{code:t,docsPath:r,metaMessages:i,name:s,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:i||e?.metaMessages,name:s||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=s||e.name,this.code=e instanceof n.bs?e.code:t??-1}}class o extends s{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class a extends s{constructor(e){super(e,{code:a.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(a,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class c extends s{constructor(e){super(e,{code:c.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(c,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class l extends s{constructor(e,{method:t}={}){super(e,{code:l.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(l,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class u extends s{constructor(e){super(e,{code:u.code,name:"InvalidParamsRpcError",shortMessage:"Invalid parameters were provided to the RPC method.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(u,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class h extends s{constructor(e){super(e,{code:h.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(h,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class f extends s{constructor(e){super(e,{code:f.code,name:"InvalidInputRpcError",shortMessage:"Missing or invalid parameters.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(f,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class d extends s{constructor(e){super(e,{code:d.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(d,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class p extends s{constructor(e){super(e,{code:p.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(p,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class g extends s{constructor(e){super(e,{code:g.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(g,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class y extends s{constructor(e,{method:t}={}){super(e,{code:y.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(y,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class b extends s{constructor(e){super(e,{code:b.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(b,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class m extends s{constructor(e){super(e,{code:m.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(m,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class w extends o{constructor(e){super(e,{code:w.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(w,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class v extends o{constructor(e){super(e,{code:v.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(v,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class E extends o{constructor(e,{method:t}={}){super(e,{code:E.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(E,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class x extends o{constructor(e){super(e,{code:x.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(x,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class I extends o{constructor(e){super(e,{code:I.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(I,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class S extends o{constructor(e){super(e,{code:S.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(S,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class O extends o{constructor(e){super(e,{code:O.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(O,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class _ extends o{constructor(e){super(e,{code:_.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class P extends o{constructor(e){super(e,{code:P.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(P,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class A extends o{constructor(e){super(e,{code:A.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(A,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class D extends o{constructor(e){super(e,{code:D.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(D,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class R extends o{constructor(e){super(e,{code:R.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(R,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class C extends o{constructor(e){super(e,{code:C.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(C,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760})},64996:function(e,t,r){"use strict";r.d(t,{Bj:function(){return a},Nc:function(){return n},Z8:function(){return s}});var i=r(440);class n extends i.G{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class s extends i.G{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function o(e){return e.reduce((e,{slot:t,value:r})=>`${e}        ${t}: ${r}
`,"")}function a(e){return e.reduce((e,{address:t,...r})=>{let i=`${e}    ${t}:
`;return r.nonce&&(i+=`      nonce: ${r.nonce}
`),r.balance&&(i+=`      balance: ${r.balance}
`),r.code&&(i+=`      code: ${r.code}
`),r.state&&(i+="      state:\n"+o(r.state)),r.stateDiff&&(i+="      stateDiff:\n"+o(r.stateDiff)),i},"  State Override:\n").slice(0,-1)}},84312:function(e,t,r){"use strict";r.d(t,{xY:function(){return s},xr:function(){return n}}),r(84562),r(70097);var i=r(440);function n(e){let t=Object.entries(e).map(([e,t])=>void 0===t||!1===t?null:[e,t]).filter(Boolean),r=t.reduce((e,[t])=>Math.max(e,t.length),0);return t.map(([e,t])=>`  ${`${e}:`.padEnd(r+1)}  ${t}`).join("\n")}class s extends i.G{constructor(){super("Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.\nUse `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others.",{name:"FeeConflictError"})}}},88885:function(e,t,r){"use strict";r.d(t,{C:function(){return i},G:function(){return n}});let i=e=>e,n=e=>e},3297:function(e,t,r){"use strict";r.d(t,{r:function(){return d}});var i=r(24530),n=r(92113),s=r(21217),o=r(38525),a=r(34046),c=r(40308),l=r(13320),u=r(722),h=r(46819),f=r(87405);function d(e,t){let r="string"==typeof t?(0,u.nr)(t):t,d=(0,s.q)(r);if(0===(0,o.d)(r)&&e.length>0)throw new i.wb;if((0,o.d)(t)&&32>(0,o.d)(t))throw new i.xB({data:"string"==typeof t?t:(0,h.ci)(t),params:e,size:(0,o.d)(t)});let g=0,y=[];for(let t=0;t<e.length;++t){let r=e[t];d.setPosition(g);let[s,o]=function e(t,r,{staticPosition:s}){let o=(0,f.S)(r.type);if(o){let[i,n]=o;return function(t,r,{length:i,staticPosition:n}){if(!i){let i=n+(0,l.tm)(t.readBytes(32)),s=i+32;t.setPosition(i);let o=(0,l.tm)(t.readBytes(32)),a=p(r),c=0,u=[];for(let i=0;i<o;++i){t.setPosition(s+(a?32*i:c));let[n,o]=e(t,r,{staticPosition:s});c+=o,u.push(n)}return t.setPosition(n+32),[u,32]}if(p(r)){let s=n+(0,l.tm)(t.readBytes(32)),o=[];for(let n=0;n<i;++n){t.setPosition(s+32*n);let[i]=e(t,r,{staticPosition:s});o.push(i)}return t.setPosition(n+32),[o,32]}let s=0,o=[];for(let a=0;a<i;++a){let[i,a]=e(t,r,{staticPosition:n+s});s+=a,o.push(i)}return[o,s]}(t,{...r,type:n},{length:i,staticPosition:s})}if("tuple"===r.type)return function(t,r,{staticPosition:i}){let n=0===r.components.length||r.components.some(({name:e})=>!e),s=n?[]:{},o=0;if(p(r)){let a=i+(0,l.tm)(t.readBytes(32));for(let i=0;i<r.components.length;++i){let c=r.components[i];t.setPosition(a+o);let[l,u]=e(t,c,{staticPosition:a});o+=u,s[n?i:c?.name]=l}return t.setPosition(i+32),[s,32]}for(let a=0;a<r.components.length;++a){let c=r.components[a],[l,u]=e(t,c,{staticPosition:i});s[n?a:c?.name]=l,o+=u}return[s,o]}(t,r,{staticPosition:s});if("address"===r.type)return function(e){let t=e.readBytes(32);return[(0,n.x)((0,h.ci)((0,a.T4)(t,-20))),32]}(t);if("bool"===r.type)return[(0,l.Lj)(t.readBytes(32),{size:32}),32];if(r.type.startsWith("bytes"))return function(e,t,{staticPosition:r}){let[i,n]=t.type.split("bytes");if(!n){let t=(0,l.tm)(e.readBytes(32));e.setPosition(r+t);let i=(0,l.tm)(e.readBytes(32));if(0===i)return e.setPosition(r+32),["0x",32];let n=e.readBytes(i);return e.setPosition(r+32),[(0,h.ci)(n),32]}return[(0,h.ci)(e.readBytes(Number.parseInt(n,10),32)),32]}(t,r,{staticPosition:s});if(r.type.startsWith("uint")||r.type.startsWith("int"))return function(e,t){let r=t.type.startsWith("int"),i=Number.parseInt(t.type.split("int")[1]||"256",10),n=e.readBytes(32);return[i>48?(0,l.v3)(n,{signed:r}):(0,l.tm)(n,{signed:r}),32]}(t,r);if("string"===r.type)return function(e,{staticPosition:t}){let r=(0,l.tm)(e.readBytes(32));e.setPosition(t+r);let i=(0,l.tm)(e.readBytes(32));if(0===i)return e.setPosition(t+32),["",32];let n=e.readBytes(i,32),s=(0,l.d3)((0,c.f)(n));return e.setPosition(t+32),[s,32]}(t,{staticPosition:s});throw new i.CI(r.type,{docsPath:"/docs/contract/decodeAbiParameters"})}(d,r,{staticPosition:0});g+=o,y.push(s)}return y}function p(e){let{type:t}=e;if("string"===t||"bytes"===t||t.endsWith("[]"))return!0;if("tuple"===t)return e.components?.some(p);let r=(0,f.S)(e.type);return!!(r&&p({...e,type:r[1]}))}},29415:function(e,t,r){"use strict";r.d(t,{p:function(){return l}});var i=r(4419),n=r(24530),s=r(34046),o=r(71936),a=r(3297),c=r(64445);function l(e){let{abi:t,data:r}=e,l=(0,s.tP)(r,0,4);if("0x"===l)throw new n.wb;let u=[...t||[],i.Up,i.hZ].find(e=>"error"===e.type&&l===(0,o.C)((0,c.t)(e)));if(!u)throw new n.yP(l,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:u,args:"inputs"in u&&u.inputs&&u.inputs.length>0?(0,a.r)(u.inputs,(0,s.tP)(r,4)):void 0,errorName:u.name}}},85341:function(e,t,r){"use strict";r.d(t,{p:function(){return c}});var i=r(24530),n=r(34046),s=r(71936),o=r(3297),a=r(64445);function c(e){let{abi:t,data:r}=e,c=(0,n.tP)(r,0,4),l=t.find(e=>"function"===e.type&&c===(0,s.C)((0,a.t)(e)));if(!l)throw new i.eF(c,{docsPath:"/docs/contract/decodeFunctionData"});return{functionName:l.name,args:"inputs"in l&&l.inputs&&l.inputs.length>0?(0,o.r)(l.inputs,(0,n.tP)(r,4)):void 0}}},39857:function(e,t,r){"use strict";r.d(t,{k:function(){return a}});var i=r(24530),n=r(3297),s=r(14931);let o="/docs/contract/decodeFunctionResult";function a(e){let{abi:t,args:r,functionName:a,data:c}=e,l=t[0];if(a){let e=(0,s.mE)({abi:t,args:r,name:a});if(!e)throw new i.xL(a,{docsPath:o});l=e}if("function"!==l.type)throw new i.xL(void 0,{docsPath:o});if(!l.outputs)throw new i.MX(l.name,{docsPath:o});let u=(0,n.r)(l.outputs,c);return u&&u.length>1?u:u&&1===u.length?u[0]:void 0}},87405:function(e,t,r){"use strict";r.d(t,{E:function(){return p},S:function(){return y}});var i=r(24530),n=r(49787),s=r(440),o=r(46693),a=r(84552),c=r(67516),l=r(7457),u=r(38525),h=r(34046),f=r(46819),d=r(27172);function p(e,t){if(e.length!==t.length)throw new i.fs({expectedLength:e.length,givenLength:t.length});let r=g(function({params:e,values:t}){let r=[];for(let p=0;p<e.length;p++)r.push(function e({param:t,value:r}){let p=y(t.type);if(p){let[n,s]=p;return function(t,{length:r,param:n}){let s=null===r;if(!Array.isArray(t))throw new i.hn(t);if(!s&&t.length!==r)throw new i.gr({expectedLength:r,givenLength:t.length,type:`${n.type}[${r}]`});let o=!1,a=[];for(let r=0;r<t.length;r++){let i=e({param:n,value:t[r]});i.dynamic&&(o=!0),a.push(i)}if(s||o){let e=g(a);if(s){let t=(0,f.eC)(a.length,{size:32});return{dynamic:!0,encoded:a.length>0?(0,c.zo)([t,e]):t}}if(o)return{dynamic:!0,encoded:e}}return{dynamic:!1,encoded:(0,c.zo)(a.map(({encoded:e})=>e))}}(r,{length:n,param:{...t,type:s}})}if("tuple"===t.type)return function(t,{param:r}){let i=!1,n=[];for(let s=0;s<r.components.length;s++){let o=r.components[s],a=Array.isArray(t)?s:o.name,c=e({param:o,value:t[a]});n.push(c),c.dynamic&&(i=!0)}return{dynamic:i,encoded:i?g(n):(0,c.zo)(n.map(({encoded:e})=>e))}}(r,{param:t});if("address"===t.type)return function(e){if(!(0,a.U)(e))throw new n.b({address:e});return{dynamic:!1,encoded:(0,l.gc)(e.toLowerCase())}}(r);if("bool"===t.type)return function(e){if("boolean"!=typeof e)throw new s.G(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:(0,l.gc)((0,f.C4)(e))}}(r);if(t.type.startsWith("uint")||t.type.startsWith("int")){let e=t.type.startsWith("int"),[,,i="256"]=d.lh.exec(t.type)??[];return function(e,{signed:t,size:r=256}){if("number"==typeof r){let i=2n**(BigInt(r)-(t?1n:0n))-1n,n=t?-i-1n:0n;if(e>i||e<n)throw new o.J5({max:i.toString(),min:n.toString(),signed:t,size:r/8,value:e.toString()})}return{dynamic:!1,encoded:(0,f.eC)(e,{size:32,signed:t})}}(r,{signed:e,size:Number(i)})}if(t.type.startsWith("bytes"))return function(e,{param:t}){let[,r]=t.type.split("bytes"),n=(0,u.d)(e);if(!r){let t=e;return n%32!=0&&(t=(0,l.gc)(t,{dir:"right",size:32*Math.ceil((e.length-2)/2/32)})),{dynamic:!0,encoded:(0,c.zo)([(0,l.gc)((0,f.eC)(n,{size:32})),t])}}if(n!==Number.parseInt(r,10))throw new i.M4({expectedSize:Number.parseInt(r,10),value:e});return{dynamic:!1,encoded:(0,l.gc)(e,{dir:"right"})}}(r,{param:t});if("string"===t.type)return function(e){let t=(0,f.$G)(e),r=Math.ceil((0,u.d)(t)/32),i=[];for(let e=0;e<r;e++)i.push((0,l.gc)((0,h.tP)(t,32*e,(e+1)*32),{dir:"right"}));return{dynamic:!0,encoded:(0,c.zo)([(0,l.gc)((0,f.eC)((0,u.d)(t),{size:32})),...i])}}(r);throw new i.dh(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}({param:e[p],value:t[p]}));return r}({params:e,values:t}));return 0===r.length?"0x":r}function g(e){let t=0;for(let r=0;r<e.length;r++){let{dynamic:i,encoded:n}=e[r];i?t+=32:t+=(0,u.d)(n)}let r=[],i=[],n=0;for(let s=0;s<e.length;s++){let{dynamic:o,encoded:a}=e[s];o?(r.push((0,f.eC)(t+n,{size:32})),i.push(a),n+=(0,u.d)(a)):r.push(a)}return(0,c.zo)([...r,...i])}function y(e){let t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}},12497:function(e,t,r){"use strict";r.d(t,{w:function(){return a}});var i=r(24530),n=r(67516),s=r(87405);let o="/docs/contract/encodeDeployData";function a(e){let{abi:t,args:r,bytecode:a}=e;if(!r||0===r.length)return a;let c=t.find(e=>"type"in e&&"constructor"===e.type);if(!c)throw new i.fM({docsPath:o});if(!("inputs"in c)||!c.inputs||0===c.inputs.length)throw new i.cO({docsPath:o});let l=(0,s.E)(c.inputs,r);return(0,n.SM)([a,l])}},95627:function(e,t,r){"use strict";r.d(t,{M:function(){return u}});var i=r(24530),n=r(67516),s=r(71936),o=r(87405),a=r(64445),c=r(14931);let l="/docs/contract/encodeErrorResult";function u(e){let{abi:t,errorName:r,args:u}=e,h=t[0];if(r){let e=(0,c.mE)({abi:t,args:u,name:r});if(!e)throw new i.MS(r,{docsPath:l});h=e}if("error"!==h.type)throw new i.MS(void 0,{docsPath:l});let f=(0,a.t)(h),d=(0,s.C)(f),p="0x";if(u&&u.length>0){if(!h.inputs)throw new i.Zh(h.name,{docsPath:l});p=(0,o.E)(h.inputs,u)}return(0,n.SM)([d,p])}},79251:function(e,t,r){"use strict";r.d(t,{R:function(){return o}});var i=r(67516),n=r(87405),s=r(79271);function o(e){let{args:t}=e,{abi:r,functionName:o}=1===e.abi.length&&e.functionName?.startsWith("0x")?e:(0,s.m)(e),a=r[0],c="inputs"in a&&a.inputs?(0,n.E)(a.inputs,t??[]):void 0;return(0,i.SM)([o,c??"0x"])}},88059:function(e,t,r){"use strict";r.d(t,{R:function(){return a}});var i=r(24530),n=r(87405),s=r(14931);let o="/docs/contract/encodeFunctionResult";function a(e){let{abi:t,functionName:r,result:a}=e,c=t[0];if(r){let e=(0,s.mE)({abi:t,name:r});if(!e)throw new i.xL(r,{docsPath:o});c=e}if("function"!==c.type)throw new i.xL(void 0,{docsPath:o});if(!c.outputs)throw new i.MX(c.name,{docsPath:o});let l=(()=>{if(0===c.outputs.length)return[];if(1===c.outputs.length)return[a];if(Array.isArray(a))return a;throw new i.hn(a)})();return(0,n.E)(c.outputs,l)}},64445:function(e,t,r){"use strict";r.d(t,{h:function(){return s},t:function(){return n}});var i=r(24530);function n(e,{includeName:t=!1}={}){if("function"!==e.type&&"event"!==e.type&&"error"!==e.type)throw new i.wM(e.type);return`${e.name}(${s(e.inputs,{includeName:t})})`}function s(e,{includeName:t=!1}={}){return e?e.map(e=>(function(e,{includeName:t}){return e.type.startsWith("tuple")?`(${s(e.components,{includeName:t})})${e.type.slice(5)}`:e.type+(t&&e.name?` ${e.name}`:"")})(e,{includeName:t})).join(t?", ":","):""}},50971:function(e,t,r){"use strict";r.d(t,{z:function(){return n}});var i=r(67991);function n({abiItem:e,args:t,includeFunctionName:r=!0,includeName:n=!1}){if("name"in e&&"inputs"in e&&e.inputs)return`${r?e.name:""}(${e.inputs.map((e,r)=>`${n&&e.name?`${e.name}: `:""}${"object"==typeof t[r]?(0,i.P)(t[r]):t[r]}`).join(", ")})`}},14931:function(e,t,r){"use strict";r.d(t,{mE:function(){return c}});var i=r(24530),n=r(53936),s=r(84552),o=r(65176),a=r(71936);function c(e){let t;let{abi:r,args:c=[],name:l}=e,u=(0,n.v)(l,{strict:!1}),h=r.filter(e=>u?"function"===e.type?(0,a.C)(e)===l:"event"===e.type&&(0,o.n)(e)===l:"name"in e&&e.name===l);if(0!==h.length){if(1===h.length)return h[0];for(let e of h)if("inputs"in e){if(!c||0===c.length){if(!e.inputs||0===e.inputs.length)return e;continue}if(e.inputs&&0!==e.inputs.length&&e.inputs.length===c.length&&c.every((t,r)=>{let i="inputs"in e&&e.inputs[r];return!!i&&function e(t,r){let i=typeof t,n=r.type;switch(n){case"address":return(0,s.U)(t,{strict:!1});case"bool":return"boolean"===i;case"function":case"string":return"string"===i;default:if("tuple"===n&&"components"in r)return Object.values(r.components).every((r,i)=>e(Object.values(t)[i],r));if(/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(n))return"number"===i||"bigint"===i;if(/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(n))return"string"===i||t instanceof Uint8Array;if(/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(n))return Array.isArray(t)&&t.every(t=>e(t,{...r,type:n.replace(/(\[[0-9]{0,}\])$/,"")}));return!1}}(t,i)})){if(t&&"inputs"in t&&t.inputs){let r=function e(t,r,i){for(let n in t){let o=t[n],a=r[n];if("tuple"===o.type&&"tuple"===a.type&&"components"in o&&"components"in a)return e(o.components,a.components,i[n]);let c=[o.type,a.type];if(c.includes("address")&&c.includes("bytes20")||(c.includes("address")&&c.includes("string")||c.includes("address")&&c.includes("bytes"))&&(0,s.U)(i[n],{strict:!1}))return c}}(e.inputs,t.inputs,c);if(r)throw new i.S4({abiItem:e,type:r[0]},{abiItem:t,type:r[1]})}t=e}}return t||h[0]}}},79271:function(e,t,r){"use strict";r.d(t,{m:function(){return c}});var i=r(24530),n=r(71936),s=r(64445),o=r(14931);let a="/docs/contract/encodeFunctionData";function c(e){let{abi:t,args:r,functionName:c}=e,l=t[0];if(c){let e=(0,o.mE)({abi:t,args:r,name:c});if(!e)throw new i.xL(c,{docsPath:a});l=e}if("function"!==l.type)throw new i.xL(void 0,{docsPath:a});return{abi:[l],functionName:(0,n.C)((0,s.t)(l))}}},92113:function(e,t,r){"use strict";r.d(t,{x:function(){return a}}),r(49787);var i=r(722),n=r(99807),s=r(56315);r(84552);let o=new s.k(8192);function a(e,t){if(o.has(`${e}.${t}`))return o.get(`${e}.${t}`);let r=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),s=(0,n.w)((0,i.qX)(r),"bytes"),a=(t?r.substring(`${t}0x`.length):r).split("");for(let e=0;e<40;e+=2)s[e>>1]>>4>=8&&a[e]&&(a[e]=a[e].toUpperCase()),(15&s[e>>1])>=8&&a[e+1]&&(a[e+1]=a[e+1].toUpperCase());let c=`0x${a.join("")}`;return o.set(`${e}.${t}`,c),c}},84552:function(e,t,r){"use strict";r.d(t,{U:function(){return a}});var i=r(56315),n=r(92113);let s=/^0x[a-fA-F0-9]{40}$/,o=new i.k(8192);function a(e,t){let{strict:r=!0}=t??{},i=`${e}.${r}`;if(o.has(i))return o.get(i);let a=!!s.test(e)&&(e.toLowerCase()===e||!r||(0,n.x)(e)===e);return o.set(i,a),a}},56391:function(e,t,r){"use strict";r.d(t,{E:function(){return s}});var i=r(49787),n=r(84552);function s(e,t){if(!(0,n.U)(e,{strict:!1}))throw new i.b({address:e});if(!(0,n.U)(t,{strict:!1}))throw new i.b({address:t});return e.toLowerCase()===t.toLowerCase()}},81149:function(e,t,r){"use strict";r.d(t,{offchainLookup:function(){return w},offchainLookupSignature:function(){return b}});var i=r(59550),n=r(67991),s=r(440),o=r(88885);class a extends s.G{constructor({callbackSelector:e,cause:t,data:r,extraData:i,sender:n,urls:s}){super(t.shortMessage||"An error occurred while fetching for an offchain result.",{cause:t,metaMessages:[...t.metaMessages||[],t.metaMessages?.length?"":[],"Offchain Gateway Call:",s&&["  Gateway URL(s):",...s.map(e=>`    ${(0,o.G)(e)}`)],`  Sender: ${n}`,`  Data: ${r}`,`  Callback selector: ${e}`,`  Extra data: ${i}`].flat(),name:"OffchainLookupError"})}}class c extends s.G{constructor({result:e,url:t}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${(0,o.G)(t)}`,`Response: ${(0,n.P)(e)}`],name:"OffchainLookupResponseMalformedError"})}}class l extends s.G{constructor({sender:e,to:t}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${t}`,`OffchainLookup sender address: ${e}`],name:"OffchainLookupSenderMismatchError"})}}var u=r(32252),h=r(29415),f=r(87405),d=r(56391),p=r(67516),g=r(53936),y=r(69604);let b="0x556f1830",m={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function w(e,{blockNumber:t,blockTag:r,data:n,to:s}){let{args:o}=(0,h.p)({data:n,abi:[m]}),[c,u,g,b,w]=o,{ccipRead:E}=e,x=E&&"function"==typeof E?.request?E.request:v;try{if(!(0,d.E)(s,c))throw new l({sender:c,to:s});let n=u.includes(y.M)?await (0,y.w)({data:g,ccipRequest:x}):await x({data:g,sender:c,urls:u}),{data:o}=await (0,i.R)(e,{blockNumber:t,blockTag:r,data:(0,p.zo)([b,(0,f.E)([{type:"bytes"},{type:"bytes"}],[n,w])]),to:s});return o}catch(e){throw new a({callbackSelector:b,cause:e,data:n,extraData:w,sender:c,urls:u})}}async function v({data:e,sender:t,urls:r}){let i=Error("An unknown error occurred.");for(let s=0;s<r.length;s++){let o=r[s],a=o.includes("{data}")?"GET":"POST",l="POST"===a?{data:e,sender:t}:void 0,h="POST"===a?{"Content-Type":"application/json"}:{};try{let r;let s=await fetch(o.replace("{sender}",t.toLowerCase()).replace("{data}",e),{body:JSON.stringify(l),headers:h,method:a});if(r=s.headers.get("Content-Type")?.startsWith("application/json")?(await s.json()).data:await s.text(),!s.ok){i=new u.Gg({body:l,details:r?.error?(0,n.P)(r.error):s.statusText,headers:s.headers,status:s.status,url:o});continue}if(!(0,g.v)(r)){i=new c({result:r,url:o});continue}return r}catch(e){i=new u.Gg({body:l,details:e.message,url:o})}}throw i}},74318:function(e,t,r){"use strict";r.d(t,{L:function(){return n}});var i=r(34981);function n({blockNumber:e,chain:t,contract:r}){let n=t?.contracts?.[r];if(!n)throw new i.mm({chain:t,contract:{name:r}});if(e&&n.blockCreated&&n.blockCreated>e)throw new i.mm({blockNumber:e,chain:t,contract:{name:r,blockCreated:n.blockCreated}});return n.address}},21217:function(e,t,r){"use strict";r.d(t,{q:function(){return s}});var i=r(20758);let n={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new i.KD({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(e){if(e<0||e>this.bytes.length-1)throw new i.lQ({length:this.bytes.length,position:e})},decrementPosition(e){if(e<0)throw new i.T_({offset:e});let t=this.position-e;this.assertPosition(t),this.position=t},getReadCount(e){return this.positionReadCount.get(e||this.position)||0},incrementPosition(e){if(e<0)throw new i.T_({offset:e});let t=this.position+e;this.assertPosition(t),this.position=t},inspectByte(e){let t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectBytes(e,t){let r=t??this.position;return this.assertPosition(r+e-1),this.bytes.subarray(r,r+e)},inspectUint8(e){let t=e??this.position;return this.assertPosition(t),this.bytes[t]},inspectUint16(e){let t=e??this.position;return this.assertPosition(t+1),this.dataView.getUint16(t)},inspectUint24(e){let t=e??this.position;return this.assertPosition(t+2),(this.dataView.getUint16(t)<<8)+this.dataView.getUint8(t+2)},inspectUint32(e){let t=e??this.position;return this.assertPosition(t+3),this.dataView.getUint32(t)},pushByte(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushBytes(e){this.assertPosition(this.position+e.length-1),this.bytes.set(e,this.position),this.position+=e.length},pushUint8(e){this.assertPosition(this.position),this.bytes[this.position]=e,this.position++},pushUint16(e){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,e),this.position+=2},pushUint24(e){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,e>>8),this.dataView.setUint8(this.position+2,255&e),this.position+=3},pushUint32(e){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,e),this.position+=4},readByte(){this.assertReadLimit(),this._touch();let e=this.inspectByte();return this.position++,e},readBytes(e,t){this.assertReadLimit(),this._touch();let r=this.inspectBytes(e);return this.position+=t??e,r},readUint8(){this.assertReadLimit(),this._touch();let e=this.inspectUint8();return this.position+=1,e},readUint16(){this.assertReadLimit(),this._touch();let e=this.inspectUint16();return this.position+=2,e},readUint24(){this.assertReadLimit(),this._touch();let e=this.inspectUint24();return this.position+=3,e},readUint32(){this.assertReadLimit(),this._touch();let e=this.inspectUint32();return this.position+=4,e},get remaining(){return this.bytes.length-this.position},setPosition(e){let t=this.position;return this.assertPosition(e),this.position=e,()=>this.position=t},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;let e=this.getReadCount();this.positionReadCount.set(this.position,e+1),e>0&&this.recursiveReadCount++}};function s(e,{recursiveReadLimit:t=8192}={}){let r=Object.create(n);return r.bytes=e,r.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength),r.positionReadCount=new Map,r.recursiveReadLimit=t,r}},67516:function(e,t,r){"use strict";function i(e){return"string"==typeof e[0]?n(e):function(e){let t=0;for(let r of e)t+=r.length;let r=new Uint8Array(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return r}(e)}function n(e){return`0x${e.reduce((e,t)=>e+t.replace("0x",""),"")}`}r.d(t,{SM:function(){return n},zo:function(){return i}})},53936:function(e,t,r){"use strict";function i(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}r.d(t,{v:function(){return i}})},7457:function(e,t,r){"use strict";r.d(t,{gc:function(){return s},vk:function(){return n}});var i=r(30656);function n(e,{dir:t,size:r=32}={}){return"string"==typeof e?s(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new i.$s({size:e.length,targetSize:r,type:"bytes"});let n=new Uint8Array(r);for(let i=0;i<r;i++){let s="right"===t;n[s?i:r-i-1]=e[s?i:e.length-i-1]}return n}(e,{dir:t,size:r})}function s(e,{dir:t,size:r=32}={}){if(null===r)return e;let n=e.replace("0x","");if(n.length>2*r)throw new i.$s({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n["right"===t?"padEnd":"padStart"](2*r,"0")}`}},38525:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});var i=r(53936);function n(e){return(0,i.v)(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}},34046:function(e,t,r){"use strict";r.d(t,{T4:function(){return l},tP:function(){return o}});var i=r(30656),n=r(53936),s=r(38525);function o(e,t,r,{strict:i}={}){return(0,n.v)(e,{strict:!1})?function(e,t,r,{strict:i}={}){a(e,t);let n=`0x${e.replace("0x","").slice((t??0)*2,(r??e.length)*2)}`;return i&&c(n,t,r),n}(e,t,r,{strict:i}):l(e,t,r,{strict:i})}function a(e,t){if("number"==typeof t&&t>0&&t>(0,s.d)(e)-1)throw new i.mV({offset:t,position:"start",size:(0,s.d)(e)})}function c(e,t,r){if("number"==typeof t&&"number"==typeof r&&(0,s.d)(e)!==r-t)throw new i.mV({offset:r,position:"end",size:(0,s.d)(e)})}function l(e,t,r,{strict:i}={}){a(e,t);let n=e.slice(t,r);return i&&c(n,t,r),n}},40308:function(e,t,r){"use strict";function i(e,{dir:t="left"}={}){let r="string"==typeof e?e.replace("0x",""):e,i=0;for(let e=0;e<r.length-1&&"0"===r["left"===t?e:r.length-e-1].toString();e++)i++;return(r="left"===t?r.slice(i):r.slice(0,r.length-i),"string"==typeof e)?(1===r.length&&"right"===t&&(r=`${r}0`),`0x${r.length%2==1?`0${r}`:r}`):r}r.d(t,{f:function(){return i}})},13320:function(e,t,r){"use strict";r.d(t,{Lj:function(){return c},d3:function(){return u},tm:function(){return l},v3:function(){return a}});var i=r(46693),n=r(40308),s=r(57583),o=r(46819);function a(e,t={}){void 0!==t.size&&(0,s.Yf)(e,{size:t.size});let r=(0,o.ci)(e,t);return(0,s.y_)(r,t)}function c(e,t={}){let r=e;if(void 0!==t.size&&((0,s.Yf)(r,{size:t.size}),r=(0,n.f)(r)),r.length>1||r[0]>1)throw new i.yr(r);return!!r[0]}function l(e,t={}){void 0!==t.size&&(0,s.Yf)(e,{size:t.size});let r=(0,o.ci)(e,t);return(0,s.ly)(r,t)}function u(e,t={}){let r=e;return void 0!==t.size&&((0,s.Yf)(r,{size:t.size}),r=(0,n.f)(r,{dir:"right"})),new TextDecoder().decode(r)}},57583:function(e,t,r){"use strict";r.d(t,{Yf:function(){return s},ly:function(){return a},y_:function(){return o}});var i=r(46693),n=r(38525);function s(e,{size:t}){if((0,n.d)(e)>t)throw new i.M6({givenSize:(0,n.d)(e),maxSize:t})}function o(e,t={}){let{signed:r}=t;t.size&&s(e,{size:t.size});let i=BigInt(e);if(!r)return i;let n=(e.length-2)/2;return i<=(1n<<8n*BigInt(n)-1n)-1n?i:i-BigInt(`0x${"f".padStart(2*n,"f")}`)-1n}function a(e,t={}){return Number(o(e,t))}r(40308),r(722)},722:function(e,t,r){"use strict";r.d(t,{O0:function(){return l},nr:function(){return f},qX:function(){return d}});var i=r(440),n=r(53936),s=r(7457),o=r(57583),a=r(46819);let c=new TextEncoder;function l(e,t={}){return"number"==typeof e||"bigint"==typeof e?f((0,a.eC)(e,t)):"boolean"==typeof e?function(e,t={}){let r=new Uint8Array(1);return(r[0]=Number(e),"number"==typeof t.size)?((0,o.Yf)(r,{size:t.size}),(0,s.vk)(r,{size:t.size})):r}(e,t):(0,n.v)(e)?f(e,t):d(e,t)}let u={zero:48,nine:57,A:65,F:70,a:97,f:102};function h(e){return e>=u.zero&&e<=u.nine?e-u.zero:e>=u.A&&e<=u.F?e-(u.A-10):e>=u.a&&e<=u.f?e-(u.a-10):void 0}function f(e,t={}){let r=e;t.size&&((0,o.Yf)(r,{size:t.size}),r=(0,s.vk)(r,{dir:"right",size:t.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);let a=n.length/2,c=new Uint8Array(a);for(let e=0,t=0;e<a;e++){let r=h(n.charCodeAt(t++)),s=h(n.charCodeAt(t++));if(void 0===r||void 0===s)throw new i.G(`Invalid byte sequence ("${n[t-2]}${n[t-1]}" in "${n}").`);c[e]=16*r+s}return c}function d(e,t={}){let r=c.encode(e);return"number"==typeof t.size?((0,o.Yf)(r,{size:t.size}),(0,s.vk)(r,{dir:"right",size:t.size})):r}},46819:function(e,t,r){"use strict";r.d(t,{$G:function(){return f},C4:function(){return c},NC:function(){return a},ci:function(){return l},eC:function(){return u}});var i=r(46693),n=r(7457),s=r(57583);let o=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function a(e,t={}){return"number"==typeof e||"bigint"==typeof e?u(e,t):"string"==typeof e?f(e,t):"boolean"==typeof e?c(e,t):l(e,t)}function c(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?((0,s.Yf)(r,{size:t.size}),(0,n.vk)(r,{size:t.size})):r}function l(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=o[e[t]];let i=`0x${r}`;return"number"==typeof t.size?((0,s.Yf)(i,{size:t.size}),(0,n.vk)(i,{dir:"right",size:t.size})):i}function u(e,t={}){let r;let{signed:s,size:o}=t,a=BigInt(e);o?r=s?(1n<<8n*BigInt(o)-1n)-1n:2n**(8n*BigInt(o))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let c="bigint"==typeof r&&s?-r-1n:0;if(r&&a>r||a<c){let t="bigint"==typeof e?"n":"";throw new i.J5({max:r?`${r}${t}`:void 0,min:`${c}${t}`,signed:s,size:o,value:`${e}${t}`})}let l=`0x${(s&&a<0?(1n<<BigInt(8*o))+BigInt(a):a).toString(16)}`;return o?(0,n.vk)(l,{size:o}):l}let h=new TextEncoder;function f(e,t={}){return l(h.encode(e),t)}},69604:function(e,t,r){"use strict";r.d(t,{M:function(){return c},w:function(){return l}});var i=r(22109),n=r(4419),s=r(85341),o=r(95627),a=r(88059);let c="x-batch-gateway:true";async function l(e){let{data:t,ccipRequest:r}=e,{args:[u]}=(0,s.p)({abi:i.Yi,data:t}),h=[],f=[];return await Promise.all(u.map(async(e,t)=>{try{f[t]=e.urls.includes(c)?await l({data:e.data,ccipRequest:r}):await r(e),h[t]=!1}catch(e){h[t]=!0,f[t]="HttpRequestError"===e.name&&e.status?(0,o.M)({abi:i.Yi,errorName:"HttpError",args:[e.status,e.shortMessage]}):(0,o.M)({abi:[n.Up],errorName:"Error",args:["shortMessage"in e?e.shortMessage:e.message]})}})),(0,a.R)({abi:i.Yi,functionName:"query",result:[h,f]})}},98878:function(e,t,r){"use strict";r.d(t,{P:function(){return o}});var i=r(54907),n=r(183),s=r(68576);function o(e,{docsPath:t,...r}){let o=(()=>{let t=(0,s.k)(e,r);return t instanceof n.cj?e:t})();return new i.cg(o,{docsPath:t,...r})}},68576:function(e,t,r){"use strict";r.d(t,{k:function(){return s}});var i=r(440),n=r(183);function s(e,t){let r=(e.details||"").toLowerCase(),s=e instanceof i.G?e.walk(e=>e?.code===n.M_.code):e;return s instanceof i.G?new n.M_({cause:e,message:s.details}):n.M_.nodeMessage.test(r)?new n.M_({cause:e,message:e.details}):n.Hh.nodeMessage.test(r)?new n.Hh({cause:e,maxFeePerGas:t?.maxFeePerGas}):n.G$.nodeMessage.test(r)?new n.G$({cause:e,maxFeePerGas:t?.maxFeePerGas}):n.ZI.nodeMessage.test(r)?new n.ZI({cause:e,nonce:t?.nonce}):n.vU.nodeMessage.test(r)?new n.vU({cause:e,nonce:t?.nonce}):n.se.nodeMessage.test(r)?new n.se({cause:e,nonce:t?.nonce}):n.C_.nodeMessage.test(r)?new n.C_({cause:e}):n.WF.nodeMessage.test(r)?new n.WF({cause:e,gas:t?.gas}):n.dR.nodeMessage.test(r)?new n.dR({cause:e,gas:t?.gas}):n.pZ.nodeMessage.test(r)?new n.pZ({cause:e}):n.cs.nodeMessage.test(r)?new n.cs({cause:e,maxFeePerGas:t?.maxFeePerGas,maxPriorityFeePerGas:t?.maxPriorityFeePerGas}):new n.cj({cause:e})}r(32252),r(65155)},51101:function(e,t,r){"use strict";function i(e,{format:t}){if(!t)return{};let r={};return!function t(i){for(let n of Object.keys(i))n in e&&(r[n]=e[n]),i[n]&&"object"==typeof i[n]&&!Array.isArray(i[n])&&t(i[n])}(t(e||{})),r}r.d(t,{K:function(){return i}})},55574:function(e,t,r){},89890:function(e,t,r){"use strict";r.d(t,{tG:function(){return s}});var i=r(46819);r(55574);let n={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function s(e){let t={};return void 0!==e.authorizationList&&(t.authorizationList=e.authorizationList.map(e=>({address:e.address,r:e.r?(0,i.eC)(BigInt(e.r)):e.r,s:e.s?(0,i.eC)(BigInt(e.s)):e.s,chainId:(0,i.eC)(e.chainId),nonce:(0,i.eC)(e.nonce),...void 0!==e.yParity?{yParity:(0,i.eC)(e.yParity)}:{},...void 0!==e.v&&void 0===e.yParity?{v:(0,i.eC)(e.v)}:{}}))),void 0!==e.accessList&&(t.accessList=e.accessList),void 0!==e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes),void 0!==e.blobs&&("string"!=typeof e.blobs[0]?t.blobs=e.blobs.map(e=>(0,i.ci)(e)):t.blobs=e.blobs),void 0!==e.data&&(t.data=e.data),void 0!==e.from&&(t.from=e.from),void 0!==e.gas&&(t.gas=(0,i.eC)(e.gas)),void 0!==e.gasPrice&&(t.gasPrice=(0,i.eC)(e.gasPrice)),void 0!==e.maxFeePerBlobGas&&(t.maxFeePerBlobGas=(0,i.eC)(e.maxFeePerBlobGas)),void 0!==e.maxFeePerGas&&(t.maxFeePerGas=(0,i.eC)(e.maxFeePerGas)),void 0!==e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=(0,i.eC)(e.maxPriorityFeePerGas)),void 0!==e.nonce&&(t.nonce=(0,i.eC)(e.nonce)),void 0!==e.to&&(t.to=e.to),void 0!==e.type&&(t.type=n[e.type]),void 0!==e.value&&(t.value=(0,i.eC)(e.value)),t}},99807:function(e,t,r){"use strict";r.d(t,{w:function(){return a}});var i=r(76087),n=r(53936),s=r(722),o=r(46819);function a(e,t){let r=(0,i.fr)((0,n.v)(e,{strict:!1})?(0,s.O0)(e):e);return"bytes"===(t||"hex")?r:(0,o.NC)(r)}},65176:function(e,t,r){"use strict";r.d(t,{n:function(){return i}});let i=r(27095).r},71936:function(e,t,r){"use strict";r.d(t,{C:function(){return s}});var i=r(34046),n=r(27095);let s=e=>(0,i.tP)((0,n.r)(e),0,4)},92972:function(e,t,r){"use strict";r.d(t,{W:function(){return s}});var i=r(67045),n=r(440);let s=e=>(function(e){let t=!0,r="",i=0,s="",o=!1;for(let n=0;n<e.length;n++){let a=e[n];if(["(",")",","].includes(a)&&(t=!0),"("===a&&i++,")"===a&&i--,t){if(0===i){if(" "===a&&["event","function",""].includes(s))s="";else if(s+=a,")"===a){o=!0;break}continue}if(" "===a){","!==e[n-1]&&","!==r&&",("!==r&&(r="",t=!1);continue}s+=a,r+=a}}if(!o)throw new n.G("Unable to normalize signature.");return s})("string"==typeof e?e:(0,i.tQ)(e))},27095:function(e,t,r){"use strict";r.d(t,{r:function(){return a}});var i=r(722),n=r(99807);let s=e=>(0,n.w)((0,i.O0)(e));var o=r(92972);function a(e){return s((0,o.W)(e))}},56315:function(e,t,r){"use strict";r.d(t,{k:function(){return i}});class i extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}},53521:function(e,t,r){"use strict";r.d(t,{S:function(){return s}});var i=r(45175);let n=new Map;function s({fn:e,id:t,shouldSplitBatch:r,wait:s=0,sort:o}){let a=async()=>{let t=u();c();let r=t.map(({args:e})=>e);0!==r.length&&e(r).then(e=>{o&&Array.isArray(e)&&e.sort(o);for(let r=0;r<t.length;r++){let{resolve:i}=t[r];i?.([e[r],e])}}).catch(e=>{for(let r=0;r<t.length;r++){let{reject:i}=t[r];i?.(e)}})},c=()=>n.delete(t),l=()=>u().map(({args:e})=>e),u=()=>n.get(t)||[],h=e=>n.set(t,[...u(),e]);return{flush:c,async schedule(e){let{promise:t,resolve:n,reject:o}=(0,i.n)();return(r?.([...l(),e])&&a(),u().length>0)?h({args:e,resolve:n,reject:o}):(h({args:e,resolve:n,reject:o}),setTimeout(a,s)),t}}}},45175:function(e,t,r){"use strict";function i(){let e=()=>void 0,t=()=>void 0;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}r.d(t,{n:function(){return i}})},27172:function(e,t,r){"use strict";r.d(t,{lh:function(){return i}});let i=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/},12037:function(e,t,r){"use strict";r.d(t,{mF:function(){return l}});var i=r(49787),n=r(30656),s=r(64996),o=r(84552),a=r(46819);function c(e){if(e&&0!==e.length)return e.reduce((e,{slot:t,value:r})=>{if(66!==t.length)throw new n.W_({size:t.length,targetSize:66,type:"hex"});if(66!==r.length)throw new n.W_({size:r.length,targetSize:66,type:"hex"});return e[t]=r,e},{})}function l(e){if(!e)return;let t={};for(let{address:r,...n}of e){if(!(0,o.U)(r,{strict:!1}))throw new i.b({address:r});if(t[r])throw new s.Nc({address:r});t[r]=function(e){let{balance:t,nonce:r,state:i,stateDiff:n,code:o}=e,l={};if(void 0!==o&&(l.code=o),void 0!==t&&(l.balance=(0,a.eC)(t)),void 0!==r&&(l.nonce=(0,a.eC)(r)),void 0!==i&&(l.state=c(i)),void 0!==n){if(l.state)throw new s.Z8;l.stateDiff=c(n)}return l}(n)}return t}},67991:function(e,t,r){"use strict";r.d(t,{P:function(){return i}});let i=(e,t,r)=>JSON.stringify(e,(e,r)=>{let i="bigint"==typeof r?r.toString():r;return"function"==typeof t?t(e,i):i},r)},12187:function(e,t,r){"use strict";r.d(t,{F:function(){return l}});var i=r(42560),n=r(33410),s=r(49787),o=r(183),a=r(84312),c=r(84552);function l(e){let{account:t,gasPrice:r,maxFeePerGas:l,maxPriorityFeePerGas:u,to:h}=e,f=t?(0,i.T)(t):void 0;if(f&&!(0,c.U)(f.address))throw new s.b({address:f.address});if(h&&!(0,c.U)(h))throw new s.b({address:h});if(void 0!==r&&(void 0!==l||void 0!==u))throw new a.xY;if(l&&l>n.zL)throw new o.Hh({maxFeePerGas:l});if(u&&l&&u>l)throw new o.cs({maxFeePerGas:l,maxPriorityFeePerGas:u})}},84562:function(e,t,r){"use strict";r.d(t,{d:function(){return s}});var i=r(95907),n=r(19362);function s(e,t="wei"){return(0,n.b)(e,i.ez[t])}},70097:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});var i=r(95907),n=r(19362);function s(e,t="wei"){return(0,n.b)(e,i.Zn[t])}},19362:function(e,t,r){"use strict";function i(e,t){let r=e.toString(),i=r.startsWith("-");i&&(r=r.slice(1));let[n,s]=[(r=r.padStart(t,"0")).slice(0,r.length-t),r.slice(r.length-t)];return s=s.replace(/(0+)$/,""),`${i?"-":""}${n||"0"}${s?`.${s}`:""}`}r.d(t,{b:function(){return i}})},85024:function(e,t,r){"use strict";r.d(t,{secp256k1:function(){return ex}});var i=r(95423),n=r(88835),s=r(35979);let o=BigInt(0),a=BigInt(1);function c(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function l(e,t,r=""){let i=(0,n._t)(e),s=e?.length,o=void 0!==t;if(!i||o&&s!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(o?` of length ${t}`:"")+", got "+(i?`length=${s}`:`type=${typeof e}`));return e}function u(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function h(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?o:BigInt("0x"+e)}function f(e){return h((0,n.ci)(e))}function d(e){return(0,n.gk)(e),h((0,n.ci)(Uint8Array.from(e).reverse()))}function p(e,t){return(0,n.nr)(e.toString(16).padStart(2*t,"0"))}function g(e,t){return p(e,t).reverse()}function y(e,t,r){let i;if("string"==typeof t)try{i=(0,n.nr)(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if((0,n._t)(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}let b=e=>"bigint"==typeof e&&o<=e;function m(e){let t;for(t=0;e>o;e>>=a,t+=1);return t}let w=e=>(a<<BigInt(e))-a;function v(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){let n=e[t];if(i&&void 0===n)return;let s=typeof n;if(s!==r||null===n)throw Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function E(e){let t=new WeakMap;return(r,...i)=>{let n=t.get(r);if(void 0!==n)return n;let s=e(r,...i);return t.set(r,s),s}}let x=BigInt(0),I=BigInt(1),S=BigInt(2),O=BigInt(3),_=BigInt(4),P=BigInt(5),A=BigInt(7),D=BigInt(8),R=BigInt(9),C=BigInt(16);function B(e,t){let r=e%t;return r>=x?r:t+r}function U(e,t,r){let i=e;for(;t-- >x;)i*=i,i%=r;return i}function T(e,t){if(e===x)throw Error("invert: expected non-zero number");if(t<=x)throw Error("invert: expected positive modulus, got "+t);let r=B(e,t),i=t,n=x,s=I,o=I,a=x;for(;r!==x;){let e=i/r,t=i%r,c=n-o*e,l=s-a*e;i=r,r=t,n=o,s=a,o=c,a=l}if(i!==I)throw Error("invert: does not exist");return B(n,t)}function N(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function k(e,t){let r=(e.ORDER+I)/_,i=e.pow(t,r);return N(e,i,t),i}function j(e,t){let r=(e.ORDER-P)/D,i=e.mul(t,S),n=e.pow(i,r),s=e.mul(t,n),o=e.mul(e.mul(s,S),n),a=e.mul(s,e.sub(o,e.ONE));return N(e,a,t),a}function L(e){if(e<O)throw Error("sqrt is not defined for small field");let t=e-I,r=0;for(;t%S===x;)t/=S,r++;let i=S,n=F(e);for(;1===z(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return k;let s=n.pow(i,t),o=(t+I)/S;return function(e,i){if(e.is0(i))return i;if(1!==z(e,i))throw Error("Cannot find square root");let n=r,a=e.mul(e.ONE,s),c=e.pow(i,t),l=e.pow(i,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===n)throw Error("Cannot find square root");let i=I<<BigInt(n-t-1),s=e.pow(a,i);n=t,a=e.sqr(s),c=e.mul(c,a),l=e.mul(l,s)}return l}}let $=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function M(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),n=t.reduce((t,r,n)=>e.is0(r)?t:(i[n]=t,e.mul(t,r)),e.ONE),s=e.inv(n);return t.reduceRight((t,r,n)=>e.is0(r)?t:(i[n]=e.mul(t,i[n]),e.mul(t,r)),s),i}function z(e,t){let r=(e.ORDER-I)/S,i=e.pow(t,r),n=e.eql(i,e.ONE),s=e.eql(i,e.ZERO),o=e.eql(i,e.neg(e.ONE));if(!n&&!s&&!o)throw Error("invalid Legendre symbol result");return n?1:s?0:-1}function q(e,t){void 0!==t&&(0,n.k8)(t);let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function F(e,t,r=!1,i={}){let n,s,o,a;if(e<=x)throw Error("invalid field: expected ORDER > 0, got "+e);let c=!1;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(s=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(c=t.modFromBytes),a=t.allowedLengths}else"number"==typeof t&&(s=t),i.sqrt&&(o=i.sqrt);let{nBitLength:l,nByteLength:u}=q(e,s);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let h=Object.freeze({ORDER:e,isLE:r,BITS:l,BYTES:u,MASK:w(l),ZERO:x,ONE:I,allowedLengths:a,create:t=>B(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return x<=t&&t<e},is0:e=>e===x,isValidNot0:e=>!h.is0(e)&&h.isValid(e),isOdd:e=>(e&I)===I,neg:t=>B(-t,e),eql:(e,t)=>e===t,sqr:t=>B(t*t,e),add:(t,r)=>B(t+r,e),sub:(t,r)=>B(t-r,e),mul:(t,r)=>B(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<x)throw Error("invalid exponent, negatives unsupported");if(r===x)return e.ONE;if(r===I)return t;let i=e.ONE,n=t;for(;r>x;)r&I&&(i=e.mul(i,n)),n=e.sqr(n),r>>=I;return i})(h,e,t),div:(t,r)=>B(t*T(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>T(t,e),sqrt:o||(t=>(!n&&(n=e%_===O?k:e%D===P?j:e%C===R?function(e){let t=F(e),r=L(e),i=r(t,t.neg(t.ONE)),n=r(t,i),s=r(t,t.neg(i)),o=(e+A)/C;return(e,t)=>{let r=e.pow(t,o),a=e.mul(r,i),c=e.mul(r,n),l=e.mul(r,s),u=e.eql(e.sqr(a),t),h=e.eql(e.sqr(c),t);r=e.cmov(r,a,u),a=e.cmov(l,c,h);let f=e.eql(e.sqr(a),t),d=e.cmov(r,a,f);return N(e,d,t),d}}(e):L(e)),n(h,t))),toBytes:e=>r?g(e,u):p(e,u),fromBytes:(t,i=!0)=>{if(a){if(!a.includes(t.length)||t.length>u)throw Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);let e=new Uint8Array(u);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+t.length);let n=r?d(t):f(t);if(c&&(n=B(n,e)),!i&&!h.isValid(n))throw Error("invalid field element: outside of range 0..ORDER");return n},invertBatch:e=>M(h,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(h)}function V(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function K(e){let t=V(e);return t+Math.ceil(t/2)}let H=BigInt(0),G=BigInt(1);function W(e,t){let r=t.negate();return e?r:t}function J(e,t){let r=M(e.Fp,t.map(e=>e.Z));return t.map((t,i)=>e.fromAffine(t.toAffine(r[i])))}function Z(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function Y(e,t){Z(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),n=2**e;return{windows:r,windowSize:i,mask:w(e),maxNumber:n,shiftBy:BigInt(e)}}function Q(e,t,r){let{windowSize:i,mask:n,maxNumber:s,shiftBy:o}=r,a=Number(e&n),c=e>>o;a>i&&(a-=s,c+=G);let l=t*i,u=l+Math.abs(a)-1;return{nextN:c,offset:u,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}let X=new WeakMap,ee=new WeakMap;function et(e){return ee.get(e)||1}function er(e){if(e!==H)throw Error("invalid wNAF")}class ei{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>H;)t&G&&(r=r.add(i)),i=i.double(),t>>=G;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=Y(t,this.bits),n=[],s=e,o=s;for(let e=0;e<r;e++){o=s,n.push(o);for(let e=1;e<i;e++)o=o.add(s),n.push(o);s=o.double()}return n}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,n=this.BASE,s=Y(e,this.bits);for(let e=0;e<s.windows;e++){let{nextN:o,offset:a,isZero:c,isNeg:l,isNegF:u,offsetF:h}=Q(r,e,s);r=o,c?n=n.add(W(u,t[h])):i=i.add(W(l,t[a]))}return er(r),{p:i,f:n}}wNAFUnsafe(e,t,r,i=this.ZERO){let n=Y(e,this.bits);for(let e=0;e<n.windows&&r!==H;e++){let{nextN:s,offset:o,isZero:a,isNeg:c}=Q(r,e,n);if(r=s,!a){let e=t[o];i=i.add(c?e.negate():e)}}return er(r),i}getPrecomputes(e,t,r){let i=X.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),X.set(t,i))),i}cached(e,t,r){let i=et(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let n=et(e);return 1===n?this._unsafeLadder(e,t,i):this.wNAFUnsafe(n,this.getPrecomputes(n,e,r),t,i)}createCache(e,t){Z(t,this.bits),ee.set(e,t),X.delete(e)}hasCache(e){return 1!==et(e)}}function en(e,t,r){if(!t)return F(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return v(t,$.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}let es=(e,t)=>(e+(e>=0?t:-t)/ef)/t;function eo(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function ea(e,t){let r={};for(let i of Object.keys(t))r[i]=void 0===e[i]?t[i]:e[i];return c(r.lowS,"lowS"),c(r.prehash,"prehash"),void 0!==r.format&&eo(r.format),r}class ec extends Error{constructor(e=""){super(e)}}let el={Err:ec,_tlv:{encode:(e,t)=>{let{Err:r}=el;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,n=u(i);if(n.length/2&128)throw new r("tlv.encode: long form length too big");let s=i>127?u(n.length/2|128):"";return u(e)+s+n+t},decode(e,t){let{Err:r}=el,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let n=t[i++],s=0;if(128&n){let e=127&n;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let o=t.subarray(i,i+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of o)s=s<<8|e;if(i+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=n;let o=t.subarray(i,i+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(i+s)}}},_int:{encode(e){let{Err:t}=el;if(e<eu)throw new t("integer: negative integers are not allowed");let r=u(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=el;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return f(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=el,n=y("signature",e),{v:s,l:o}=i.decode(48,n);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=i.decode(2,s),{v:l,l:u}=i.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=el,i=t.encode(2,r.encode(e.r)),n=t.encode(2,r.encode(e.s));return t.encode(48,i+n)}},eu=BigInt(0),eh=BigInt(1),ef=BigInt(2),ed=BigInt(3),ep=BigInt(4);function eg(e,t){let r;let{BYTES:i}=e;if("bigint"==typeof t)r=t;else{let n=y("private key",t);try{r=e.fromBytes(n)}catch(e){throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function ey(e){return Uint8Array.of(e?2:3)}function eb(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}(0,n.iY)("HashToScalar-");let em={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},ew={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},ev=BigInt(2),eE=F(em.p,{sqrt:function(e){let t=em.p,r=BigInt(3),i=BigInt(6),n=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,u=l*l*e%t,h=U(u,r,t)*u%t,f=U(h,r,t)*u%t,d=U(f,ev,t)*l%t,p=U(d,n,t)*d%t,g=U(p,s,t)*p%t,y=U(g,a,t)*g%t,b=U(y,c,t)*y%t,m=U(b,a,t)*g%t,w=U(m,r,t)*u%t,v=U(w,o,t)*p%t,E=U(v,i,t)*l%t,x=U(E,ev,t);if(!eE.eql(eE.sqr(x),e))throw Error("Cannot find square root");return x}}),ex=function(e,t){let r=t=>(function(e){let{CURVE:t,curveOpts:r,hash:i,ecdsaOpts:o}=function(e){let{CURVE:t,curveOpts:r}=function(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,i=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,n={Fp:r,Fn:F(t.n,{BITS:e.nBitLength,allowedLengths:i,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:n}}(e),i={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:i}}(e);return function(e,t){let r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,q(r.Fn.ORDER,r.Fn.BITS))})}(e,function(e,t,r={}){(0,n.z3)(t),v(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let i=r.randomBytes||n.O6,o=r.hmac||((e,...r)=>(0,s.b)(t,e,(0,n.eV)(...r))),{Fp:a,Fn:c}=e,{ORDER:u,BITS:h}=c,{keygen:m,getPublicKey:E,getSharedSecret:x,utils:S,lengths:O}=function(e,t={}){let{Fn:r}=e,i=t.randomBytes||n.O6,s=Object.assign(eb(e.Fp,r),{seed:K(r.ORDER)});function o(e){try{return!!eg(r,e)}catch(e){return!1}}function a(e=i(s.seed)){return function(e,t,r=!1){let i=e.length,n=V(t),s=K(t);if(i<16||i<s||i>1024)throw Error("expected "+s+"-1024 bytes of input, got "+i);let o=B(r?d(e):f(e),t-I)+I;return r?g(o,n):p(o,n)}(l(e,s.seed,"seed"),r.ORDER)}function c(t,i=!0){return e.BASE.multiply(eg(r,t)).toBytes(i)}function u(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:i,publicKey:n,publicKeyUncompressed:o}=s;if(r.allowedLengths||i===n)return;let a=y("key",t).length;return a===n||a===o}return Object.freeze({getPublicKey:c,getSharedSecret:function(t,i,n=!0){if(!0===u(t))throw Error("first arg must be private key");if(!1===u(i))throw Error("second arg must be public key");let s=eg(r,t);return e.fromHex(i).multiply(s).toBytes(n)},keygen:function(e){let t=a(e);return{secretKey:t,publicKey:c(t)}},Point:e,utils:{isValidSecretKey:o,isValidPublicKey:function(t,r){let{publicKey:i,publicKeyUncompressed:n}=s;try{let s=t.length;if(!0===r&&s!==i||!1===r&&s!==n)return!1;return!!e.fromBytes(t)}catch(e){return!1}},randomSecretKey:a,isValidPrivateKey:o,randomPrivateKey:a,normPrivateKeyToScalar:e=>eg(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:s})}(e,r),_={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},P="compact";function A(e,t){if(!c.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class D{constructor(e,t,r){this.r=A("r",e),this.s=A("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=P){let r;if(!function(e,t){eo(t);let r=O.signature;l(e,"compact"===t?r:"recovered"===t?r+1:void 0,`${t} signature`)}(e,t),"der"===t){let{r:t,s:r}=el.toSig(l(e));return new D(t,r)}"recovered"===t&&(r=e[0],t="compact",e=e.subarray(1));let i=c.BYTES,n=e.subarray(0,i),s=e.subarray(i,2*i);return new D(c.fromBytes(n),c.fromBytes(s),r)}static fromHex(e,t){return this.fromBytes((0,n.nr)(e),t)}addRecoveryBit(e){return new D(this.r,this.s,e)}recoverPublicKey(t){let r=a.ORDER,{r:i,s,recovery:o}=this;if(null==o||![0,1,2,3].includes(o))throw Error("recovery id invalid");if(u*ef<r&&o>1)throw Error("recovery id is ambiguous for h>1 curve");let l=2===o||3===o?i+u:i;if(!a.isValid(l))throw Error("recovery id 2 or 3 invalid");let h=a.toBytes(l),f=e.fromBytes((0,n.eV)(ey((1&o)==0),h)),d=c.inv(l),p=C(y("msgHash",t)),g=c.create(-p*d),b=c.create(s*d),m=e.BASE.multiplyUnsafe(g).add(f.multiplyUnsafe(b));if(m.is0())throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return this.s>u>>eh}toBytes(e=P){if(eo(e),"der"===e)return(0,n.nr)(el.hexFromSig(this));let t=c.toBytes(this.r),r=c.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return(0,n.eV)(Uint8Array.of(this.recovery),t,r)}return(0,n.eV)(t,r)}toHex(e){return(0,n.ci)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return D.fromBytes(y("sig",e),"compact")}static fromDER(e){return D.fromBytes(y("sig",e),"der")}normalizeS(){return this.hasHighS()?new D(this.r,c.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,n.ci)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,n.ci)(this.toBytes("compact"))}}let R=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=f(e),r=8*e.length-h;return r>0?t>>BigInt(r):t},C=r.bits2int_modN||function(e){return c.create(R(e))},U=w(h);function T(e){return!function(e,t,r,i){if(!(b(t)&&b(r)&&b(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}("num < 2^"+h,e,eu,U),c.toBytes(e)}function N(e,r){return l(e,void 0,"message"),r?l(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:m,getPublicKey:E,getSharedSecret:x,utils:S,lengths:O,Point:e,sign:function(r,s,a={}){let{seed:l,k2sig:h}=function(t,r,s){if(["recovered","canonical"].some(e=>e in s))throw Error("sign() legacy options not supported");let{lowS:o,prehash:a,extraEntropy:l}=ea(s,_),h=C(t=N(t,a)),f=eg(c,r),d=[T(f),T(h)];if(null!=l&&!1!==l){let e=!0===l?i(O.secretKey):l;d.push(y("extraEntropy",e))}return{seed:(0,n.eV)(...d),k2sig:function(t){let r=R(t);if(!c.isValidNot0(r))return;let i=c.inv(r),n=e.BASE.multiply(r).toAffine(),s=c.create(n.x);if(s===eu)return;let a=c.create(i*c.create(h+s*f));if(a===eu)return;let l=(n.x===s?0:2)|Number(n.y&eh),d=a;return o&&a>u>>eh&&(d=c.neg(a),l^=1),new D(s,d,l)}}}(r=y("message",r),s,a);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e),o=i(e),a=i(e),c=0,l=()=>{o.fill(1),a.fill(0),c=0},u=(...e)=>r(a,o,...e),h=(e=i(0))=>{a=u(s(0),e),o=u(),0!==e.length&&(a=u(s(1),e),o=u())},f=()=>{if(c++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(o=u()).slice();r.push(t),e+=o.length}return(0,n.eV)(...r)};return(e,t)=>{let r;for(l(),h(e);!(r=t(f()));)h();return l(),r}})(t.outputLen,c.BYTES,o)(l,h)},verify:function(t,r,i,s={}){let{lowS:o,prehash:a,format:l}=ea(s,_);if(i=y("publicKey",i),r=N(y("message",r),a),"strict"in s)throw Error("options.strict was renamed to lowS");let u=void 0===l?function(e){let t;let r="string"==typeof e||(0,n._t)(e),i=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!i)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(i)t=new D(e.r,e.s);else if(r){try{t=D.fromBytes(y("sig",e),"der")}catch(e){if(!(e instanceof el.Err))throw e}if(!t)try{t=D.fromBytes(y("sig",e),"compact")}catch(e){return!1}}return!!t&&t}(t):D.fromBytes(y("sig",t),l);if(!1===u)return!1;try{let t=e.fromBytes(i);if(o&&u.hasHighS())return!1;let{r:n,s}=u,a=C(r),l=c.inv(s),h=c.create(a*l),f=c.create(n*l),d=e.BASE.multiplyUnsafe(h).add(t.multiplyUnsafe(f));if(d.is0())return!1;return c.create(d.x)===n}catch(e){return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:i}=ea(r,_);return t=N(t,i),D.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:D,hash:t})}(function(e,t={}){let r=function(e,t,r={},i){if(void 0===i&&(i="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>H))throw Error(`CURVE.${e} must be positive bigint`)}let n=en(t.p,r.Fp,i),s=en(t.n,r.Fn,i);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!n.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:n,Fn:s}}("weierstrass",e,t),{Fp:i,Fn:s}=r,o=r.CURVE,{h:a,n:u}=o;v(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:h}=t;if(h&&(!i.is0(o.a)||"bigint"!=typeof h.beta||!Array.isArray(h.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let f=eb(i,s);function d(){if(!i.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let p=t.toBytes||function(e,t,r){let{x:s,y:o}=t.toAffine(),a=i.toBytes(s);if(c(r,"isCompressed"),!r)return(0,n.eV)(Uint8Array.of(4),a,i.toBytes(o));{d();let e=!i.isOdd(o);return(0,n.eV)(ey(e),a)}},g=t.fromBytes||function(e){l(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=f,n=e.length,s=e[0],o=e.subarray(1);if(n===t&&(2===s||3===s)){let e;let t=i.fromBytes(o);if(!i.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=b(t);try{e=i.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return d(),(1&s)==1!==i.isOdd(e)&&(e=i.neg(e)),{x:t,y:e}}if(n===r&&4===s){let e=i.BYTES,t=i.fromBytes(o.subarray(0,e)),r=i.fromBytes(o.subarray(e,2*e));if(!x(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${n}, expected compressed=${t} or uncompressed=${r}`)};function b(e){let t=i.sqr(e),r=i.mul(t,e);return i.add(i.add(r,i.mul(e,o.a)),o.b)}function x(e,t){let r=i.sqr(t),n=b(e);return i.eql(r,n)}if(!x(o.Gx,o.Gy))throw Error("bad curve params: generator point");let I=i.mul(i.pow(o.a,ed),ep),S=i.mul(i.sqr(o.b),BigInt(27));if(i.is0(i.add(I,S)))throw Error("bad curve params: a or b");function O(e,t,r=!1){if(!i.isValid(t)||r&&i.is0(t))throw Error(`bad point coordinate ${e}`);return t}function _(e){if(!(e instanceof C))throw Error("ProjectivePoint expected")}function P(e){if(!h||!h.basises)throw Error("no endo");return function(e,t,r){let[[i,n],[s,o]]=t,a=es(o*e,r),c=es(-n*e,r),l=e-a*i-c*s,u=-a*n-c*o,h=l<eu,f=u<eu;h&&(l=-l),f&&(u=-u);let d=w(Math.ceil(m(r)/2))+eh;if(l<eu||l>=d||u<eu||u>=d)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:h,k1:l,k2neg:f,k2:u}}(e,h.basises,s.ORDER)}let A=E((e,t)=>{let{X:r,Y:n,Z:s}=e;if(i.eql(s,i.ONE))return{x:r,y:n};let o=e.is0();null==t&&(t=o?i.ONE:i.inv(s));let a=i.mul(r,t),c=i.mul(n,t),l=i.mul(s,t);if(o)return{x:i.ZERO,y:i.ZERO};if(!i.eql(l,i.ONE))throw Error("invZ was invalid");return{x:a,y:c}}),D=E(e=>{if(e.is0()){if(t.allowInfinityPoint&&!i.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:n}=e.toAffine();if(!i.isValid(r)||!i.isValid(n))throw Error("bad point: x or y not field elements");if(!x(r,n))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function R(e,t,r,n,s){return r=new C(i.mul(r.X,e),r.Y,r.Z),t=W(n,t),r=W(s,r),t.add(r)}class C{constructor(e,t,r){this.X=O("x",e),this.Y=O("y",t,!0),this.Z=O("z",r),Object.freeze(this)}static CURVE(){return o}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof C)throw Error("projective point not allowed");return i.is0(t)&&i.is0(r)?C.ZERO:new C(t,r,i.ONE)}static fromBytes(e){let t=C.fromAffine(g(l(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return C.fromBytes(y("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return U.createCache(this,e),t||this.multiply(ed),this}assertValidity(){D(this)}hasEvenY(){let{y:e}=this.toAffine();if(!i.isOdd)throw Error("Field doesn't support isOdd");return!i.isOdd(e)}equals(e){_(e);let{X:t,Y:r,Z:n}=this,{X:s,Y:o,Z:a}=e,c=i.eql(i.mul(t,a),i.mul(s,n)),l=i.eql(i.mul(r,a),i.mul(o,n));return c&&l}negate(){return new C(this.X,i.neg(this.Y),this.Z)}double(){let{a:e,b:t}=o,r=i.mul(t,ed),{X:n,Y:s,Z:a}=this,c=i.ZERO,l=i.ZERO,u=i.ZERO,h=i.mul(n,n),f=i.mul(s,s),d=i.mul(a,a),p=i.mul(n,s);return p=i.add(p,p),u=i.mul(n,a),u=i.add(u,u),c=i.mul(e,u),l=i.mul(r,d),l=i.add(c,l),c=i.sub(f,l),l=i.add(f,l),l=i.mul(c,l),c=i.mul(p,c),u=i.mul(r,u),d=i.mul(e,d),p=i.sub(h,d),p=i.mul(e,p),p=i.add(p,u),u=i.add(h,h),h=i.add(u,h),h=i.add(h,d),h=i.mul(h,p),l=i.add(l,h),d=i.mul(s,a),d=i.add(d,d),h=i.mul(d,p),c=i.sub(c,h),u=i.mul(d,f),u=i.add(u,u),new C(c,l,u=i.add(u,u))}add(e){_(e);let{X:t,Y:r,Z:n}=this,{X:s,Y:a,Z:c}=e,l=i.ZERO,u=i.ZERO,h=i.ZERO,f=o.a,d=i.mul(o.b,ed),p=i.mul(t,s),g=i.mul(r,a),y=i.mul(n,c),b=i.add(t,r),m=i.add(s,a);b=i.mul(b,m),m=i.add(p,g),b=i.sub(b,m),m=i.add(t,n);let w=i.add(s,c);return m=i.mul(m,w),w=i.add(p,y),m=i.sub(m,w),w=i.add(r,n),l=i.add(a,c),w=i.mul(w,l),l=i.add(g,y),w=i.sub(w,l),h=i.mul(f,m),l=i.mul(d,y),h=i.add(l,h),l=i.sub(g,h),h=i.add(g,h),u=i.mul(l,h),g=i.add(p,p),g=i.add(g,p),y=i.mul(f,y),m=i.mul(d,m),g=i.add(g,y),y=i.sub(p,y),y=i.mul(f,y),m=i.add(m,y),p=i.mul(g,m),u=i.add(u,p),p=i.mul(w,m),l=i.mul(b,l),l=i.sub(l,p),p=i.mul(b,g),h=i.mul(w,h),new C(l,u,h=i.add(h,p))}subtract(e){return this.add(e.negate())}is0(){return this.equals(C.ZERO)}multiply(e){let r,i;let{endo:n}=t;if(!s.isValidNot0(e))throw Error("invalid scalar: out of range");let o=e=>U.cached(this,e,e=>J(C,e));if(n){let{k1neg:t,k1:s,k2neg:a,k2:c}=P(e),{p:l,f:u}=o(s),{p:h,f:f}=o(c);i=u.add(f),r=R(n.beta,l,h,t,a)}else{let{p:t,f:n}=o(e);r=t,i=n}return J(C,[r,i])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!s.isValid(e))throw Error("invalid scalar: out of range");if(e===eu||this.is0())return C.ZERO;if(e===eh)return this;if(U.hasCache(this))return this.multiply(e);if(!r)return U.unsafe(this,e);{let{k1neg:t,k1:i,k2neg:n,k2:s}=P(e),{p1:o,p2:a}=function(e,t,r,i){let n=t,s=e.ZERO,o=e.ZERO;for(;r>H||i>H;)r&G&&(s=s.add(n)),i&G&&(o=o.add(n)),n=n.double(),r>>=G,i>>=G;return{p1:s,p2:o}}(C,this,i,s);return R(r.beta,o,a,t,n)}}multiplyAndAddUnsafe(e,t,r){let i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return A(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return a===eh||(e?e(C,this):U.unsafe(this,u).is0())}clearCofactor(){let{clearCofactor:e}=t;return a===eh?this:e?e(C,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(e=!0){return c(e,"isCompressed"),this.assertValidity(),p(C,this,e)}toHex(e=!0){return(0,n.ci)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return J(C,e)}static msm(e,t){return function(e,t,r,i){!function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);let n=r.length,s=i.length;if(n!==s)throw Error("arrays of points and scalars must have equal length");let o=e.ZERO,a=m(BigInt(n)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=w(c),u=Array(Number(l)+1).fill(o),h=Math.floor((t.BITS-1)/c)*c,f=o;for(let e=h;e>=0;e-=c){u.fill(o);for(let t=0;t<s;t++){let n=Number(i[t]>>BigInt(e)&l);u[n]=u[n].add(r[t])}let t=o;for(let e=u.length-1,r=o;e>0;e--)r=r.add(u[e]),t=t.add(r);if(f=f.add(t),0!==e)for(let e=0;e<c;e++)f=f.double()}return f}(C,s,e,t)}static fromPrivateKey(e){return C.BASE.multiply(eg(s,e))}}C.BASE=new C(o.Gx,o.Gy,i.ONE),C.ZERO=new C(i.ZERO,i.ONE,i.ZERO),C.Fp=i,C.Fn=s;let B=s.BITS,U=new ei(C,t.endo?Math.ceil(B/2):B);return C.BASE.precompute(8),C}(t,r),i,o))})({...e,hash:t});return{...r(t),create:r}}({...em,Fp:eE,lowS:!0,endo:ew},i.JQ)},76454:function(e,t){"use strict";function r(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function i(e){let t=r(e);if(!t)throw Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=i,t.getDocumentOrThrow=function(){return i("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return i("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return i("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return i("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return i("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},3897:function(e,t,r){"use strict";t.D=void 0;let i=r(76454);t.D=function(){let e,t,r;try{e=i.getDocumentOrThrow(),t=i.getLocationOrThrow()}catch(e){return null}function n(...t){let r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){let i=r[e],n=["itemprop","property","name"].map(e=>i.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(n.length&&n){let e=i.getAttribute("content");if(e)return e}}return""}let s=((r=n("name","og:site_name","og:title","twitter:title"))||(r=e.title),r),o=n("description","og:description","twitter:description","keywords");return{description:o,url:t.origin,icons:function(){let r=e.getElementsByTagName("link"),i=[];for(let e=0;e<r.length;e++){let n=r[e],s=n.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){let e=n.getAttribute("href");if(e){if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{let i=t.pathname.split("/");i.pop(),r+=i.join("/")+"/"+e}i.push(r)}else if(0===e.indexOf("//")){let r=t.protocol+e;i.push(r)}else i.push(e)}}}return i}(),name:s}}},9440:function(e,t,r){let i=r(25003);function n(e,t,r){let i=e[t]+e[r],n=e[t+1]+e[r+1];i>=4294967296&&n++,e[t]=i,e[t+1]=n}function s(e,t,r,i){let n=e[t]+r;r<0&&(n+=4294967296);let s=e[t+1]+i;n>=4294967296&&s++,e[t]=n,e[t+1]=s}function o(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function a(e,t,r,i,o,a){let c=h[o],l=h[o+1],f=h[a],d=h[a+1];n(u,e,t),s(u,e,c,l);let p=u[i]^u[e],g=u[i+1]^u[e+1];u[i]=g,u[i+1]=p,n(u,r,i),p=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=p>>>24^g<<8,u[t+1]=g>>>24^p<<8,n(u,e,t),s(u,e,f,d),p=u[i]^u[e],g=u[i+1]^u[e+1],u[i]=p>>>16^g<<16,u[i+1]=g>>>16^p<<16,n(u,r,i),p=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=g>>>31^p<<1,u[t+1]=p>>>31^g<<1}let c=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),l=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),u=new Uint32Array(32),h=new Uint32Array(32);function f(e,t){let r=0;for(r=0;r<16;r++)u[r]=e.h[r],u[r+16]=c[r];for(u[24]=u[24]^e.t,u[25]=u[25]^e.t/4294967296,t&&(u[28]=~u[28],u[29]=~u[29]),r=0;r<32;r++)h[r]=o(e.b,4*r);for(r=0;r<12;r++)a(0,8,16,24,l[16*r+0],l[16*r+1]),a(2,10,18,26,l[16*r+2],l[16*r+3]),a(4,12,20,28,l[16*r+4],l[16*r+5]),a(6,14,22,30,l[16*r+6],l[16*r+7]),a(0,10,20,30,l[16*r+8],l[16*r+9]),a(2,12,22,24,l[16*r+10],l[16*r+11]),a(4,14,16,26,l[16*r+12],l[16*r+13]),a(6,8,18,28,l[16*r+14],l[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^u[r]^u[r+16]}let d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function p(e,t,r,i){if(0===e||e>64)throw Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw Error("Illegal salt, expected Uint8Array with length is 16");if(i&&16!==i.length)throw Error("Illegal personal, expected Uint8Array with length is 16");let n={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};d.fill(0),d[0]=e,t&&(d[1]=t.length),d[2]=1,d[3]=1,r&&d.set(r,32),i&&d.set(i,48);for(let e=0;e<16;e++)n.h[e]=c[e]^o(d,4*e);return t&&(g(n,t),n.c=128),n}function g(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,f(e,!1),e.c=0),e.b[e.c++]=t[r]}function y(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;f(e,!0);let t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function b(e,t,r,n,s){r=r||64,e=i.normalizeInput(e),n&&(n=i.normalizeInput(n)),s&&(s=i.normalizeInput(s));let o=p(r,t,n,s);return g(o,e),y(o)}e.exports={blake2b:b,blake2bHex:function(e,t,r,n,s){let o=b(e,t,r,n,s);return i.toHex(o)},blake2bInit:p,blake2bUpdate:g,blake2bFinal:y}},55437:function(e,t,r){let i=r(25003);function n(e,t,r,i,n,o){c[e]=c[e]+c[t]+n,c[i]=s(c[i]^c[e],16),c[r]=c[r]+c[i],c[t]=s(c[t]^c[r],12),c[e]=c[e]+c[t]+o,c[i]=s(c[i]^c[e],8),c[r]=c[r]+c[i],c[t]=s(c[t]^c[r],7)}function s(e,t){return e>>>t^e<<32-t}let o=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),a=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),c=new Uint32Array(16),l=new Uint32Array(16);function u(e,t){let r=0;for(r=0;r<8;r++)c[r]=e.h[r],c[r+8]=o[r];for(c[12]^=e.t,c[13]^=e.t/4294967296,t&&(c[14]=~c[14]),r=0;r<16;r++){var i,s;l[r]=(i=e.b)[s=4*r]^i[s+1]<<8^i[s+2]<<16^i[s+3]<<24}for(r=0;r<10;r++)n(0,4,8,12,l[a[16*r+0]],l[a[16*r+1]]),n(1,5,9,13,l[a[16*r+2]],l[a[16*r+3]]),n(2,6,10,14,l[a[16*r+4]],l[a[16*r+5]]),n(3,7,11,15,l[a[16*r+6]],l[a[16*r+7]]),n(0,5,10,15,l[a[16*r+8]],l[a[16*r+9]]),n(1,6,11,12,l[a[16*r+10]],l[a[16*r+11]]),n(2,7,8,13,l[a[16*r+12]],l[a[16*r+13]]),n(3,4,9,14,l[a[16*r+14]],l[a[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=c[r]^c[r+8]}function h(e,t){if(!(e>0&&e<=32))throw Error("Incorrect output length, should be in [1, 32]");let r=t?t.length:0;if(t&&!(r>0&&r<=32))throw Error("Incorrect key length, should be in [1, 32]");let i={h:new Uint32Array(o),b:new Uint8Array(64),c:0,t:0,outlen:e};return i.h[0]^=16842752^r<<8^e,r>0&&(f(i,t),i.c=64),i}function f(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,u(e,!1),e.c=0),e.b[e.c++]=t[r]}function d(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;u(e,!0);let t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function p(e,t,r){r=r||32,e=i.normalizeInput(e);let n=h(r,t);return f(n,e),d(n)}e.exports={blake2s:p,blake2sHex:function(e,t,r){let n=p(e,t,r);return i.toHex(n)},blake2sInit:h,blake2sUpdate:f,blake2sFinal:d}},84041:function(e,t,r){let i=r(9440),n=r(55437);e.exports={blake2b:i.blake2b,blake2bHex:i.blake2bHex,blake2bInit:i.blake2bInit,blake2bUpdate:i.blake2bUpdate,blake2bFinal:i.blake2bFinal,blake2s:n.blake2s,blake2sHex:n.blake2sHex,blake2sInit:n.blake2sInit,blake2sUpdate:n.blake2sUpdate,blake2sFinal:n.blake2sFinal}},25003:function(e){function t(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else if("string"==typeof e)t=new TextEncoder().encode(e);else throw Error("Input must be an string, Buffer or Uint8Array");return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,r,i){let n="\n"+e+" = ";for(let s=0;s<r.length;s+=2){if(32===i)n+=t(r[s]).toUpperCase()+" "+t(r[s+1]).toUpperCase();else if(64===i)n+=t(r[s+1]).toUpperCase()+t(r[s]).toUpperCase();else throw Error("Invalid size "+i);s%6==4?n+="\n"+Array(e.length+4).join(" "):s<r.length-2&&(n+=" ")}console.log(n)},testSpeed:function(e,t,r){let i=new Date().getTime(),n=new Uint8Array(t);for(let e=0;e<t;e++)n[e]=e%256;let s=new Date().getTime();console.log("Generated random input in "+(s-i)+"ms"),i=s;for(let s=0;s<r;s++){let r=e(n),s=new Date().getTime(),o=s-i;i=s,console.log("Hashed in "+o+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/1048576/(o/1e3)*100)/100+" MB PER SECOND")}}}},54414:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var i=function(e){if(e.length>=255)throw TypeError("Alphabet too long");let t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){let i=e.charAt(r),n=i.charCodeAt(0);if(255!==t[n])throw TypeError(i+" is ambiguous");t[n]=r}let r=e.length,i=e.charAt(0),n=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;let s=0,o=0,a=0;for(;e[s]===i;)o++,s++;let c=(e.length-s)*n+1>>>0,l=new Uint8Array(c);for(;s<e.length;){let i=e.charCodeAt(s);if(i>255)return;let n=t[i];if(255===n)return;let o=0;for(let e=c-1;(0!==n||o<a)&&-1!==e;e--,o++)n+=r*l[e]>>>0,l[e]=n%256>>>0,n=n/256>>>0;if(0!==n)throw Error("Non-zero carry");a=o,s++}let u=c-a;for(;u!==c&&0===l[u];)u++;let h=new Uint8Array(o+(c-u)),f=o;for(;u!==c;)h[f++]=l[u++];return h}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";let n=0,o=0,a=0,c=t.length;for(;a!==c&&0===t[a];)a++,n++;let l=(c-a)*s+1>>>0,u=new Uint8Array(l);for(;a!==c;){let e=t[a],i=0;for(let t=l-1;(0!==e||i<o)&&-1!==t;t--,i++)e+=256*u[t]>>>0,u[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw Error("Non-zero carry");o=i,a++}let h=l-o;for(;h!==l&&0===u[h];)h++;let f=i.repeat(n);for(;h<l;++h)f+=e.charAt(u[h]);return f},decodeUnsafe:o,decode:function(e){let t=o(e);if(t)return t;throw Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},80751:function(e,t,r){var i="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r.g&&r.g,n=function(){function e(){this.fetch=!1,this.DOMException=i.DOMException}return e.prototype=i,new e}();(function(e){var t=void 0!==n&&n||"undefined"!=typeof self&&self||void 0!==r.g&&r.g||{},i={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(i.arrayBuffer)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function h(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(TypeError("Already read"));e.bodyUsed=!0}}function f(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function d(e){var t=new FileReader,r=f(t);return t.readAsArrayBuffer(e),r}function p(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this.bodyUsed=this.bodyUsed,this._bodyInit=e,e){if("string"==typeof e)this._bodyText=e;else if(i.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else{var t;i.arrayBuffer&&i.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=p(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||o(e))?this._bodyArrayBuffer=p(e):this._bodyText=e=Object.prototype.toString.call(e)}}else this._noBody=!0,this._bodyText="";!this.headers.get("content-type")&&("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return Promise.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return h(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(i.blob)return this.blob().then(d);throw Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,i,n,s=h(this);if(s)return s;if(this._bodyBlob)return e=this._bodyBlob,r=f(t=new FileReader),n=(i=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?i[1]:"utf-8",t.readAsText(e,n),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=Array(t.length),i=0;i<t.length;i++)r[i]=String.fromCharCode(t[i]);return r.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return Promise.resolve(this._bodyText);throw Error("could not read FormData body as text")},i.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=a(e),t=c(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},u.prototype.delete=function(e){delete this.map[a(e)]},u.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},u.prototype.set=function(e,t){this.map[a(e)]=c(t)},u.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),l(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),l(e)},i.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var y=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function b(e,r){if(!(this instanceof b))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,n,s=(r=r||{}).body;if(e instanceof b){if(e.bodyUsed)throw TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new u(r.headers)),this.method=(n=(i=r.method||this.method||"GET").toUpperCase(),y.indexOf(n)>-1?n:i),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return new AbortController().signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),("GET"===this.method||"HEAD"===this.method)&&("no-store"===r.cache||"no-cache"===r.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),i=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(n))}}),t}function w(e,t){if(!(this instanceof w))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var v=[301,302,303,307,308];w.redirect=function(e,t){if(-1===v.indexOf(t))throw RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function E(r,n){return new Promise(function(s,o){var l=new b(r,n);if(l.signal&&l.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var h=new XMLHttpRequest;function f(){h.abort()}if(h.onload=function(){var e,t,r={statusText:h.statusText,headers:(e=h.getAllResponseHeaders()||"",t=new u,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),i=r.shift().trim();if(i){var n=r.join(":").trim();try{t.append(i,n)}catch(e){console.warn("Response "+e.message)}}}),t)};0===l.url.indexOf("file://")&&(h.status<200||h.status>599)?r.status=200:r.status=h.status,r.url="responseURL"in h?h.responseURL:r.headers.get("X-Request-URL");var i="response"in h?h.response:h.responseText;setTimeout(function(){s(new w(i,r))},0)},h.onerror=function(){setTimeout(function(){o(TypeError("Network request failed"))},0)},h.ontimeout=function(){setTimeout(function(){o(TypeError("Network request timed out"))},0)},h.onabort=function(){setTimeout(function(){o(new e.DOMException("Aborted","AbortError"))},0)},h.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(l.url),!0),"include"===l.credentials?h.withCredentials=!0:"omit"===l.credentials&&(h.withCredentials=!1),"responseType"in h&&(i.blob?h.responseType="blob":i.arrayBuffer&&(h.responseType="arraybuffer")),n&&"object"==typeof n.headers&&!(n.headers instanceof u||t.Headers&&n.headers instanceof t.Headers)){var d=[];Object.getOwnPropertyNames(n.headers).forEach(function(e){d.push(a(e)),h.setRequestHeader(e,c(n.headers[e]))}),l.headers.forEach(function(e,t){-1===d.indexOf(t)&&h.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){h.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",f),h.onreadystatechange=function(){4===h.readyState&&l.signal.removeEventListener("abort",f)}),h.send(void 0===l._bodyInit?null:l._bodyInit)})}E.polyfill=!0,t.fetch||(t.fetch=E,t.Headers=u,t.Request=b,t.Response=w),e.Headers=u,e.Request=b,e.Response=w,e.fetch=E,Object.defineProperty(e,"__esModule",{value:!0})})({}),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=i.fetch?i:n;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},65383:function(e,t,r){"use strict";r.d(t,{qY:function(){return d}});var i=r(25566),n=function(e,t,r){if(r||2==arguments.length)for(var i,n=0,s=t.length;n<s;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},s=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},o=function(e){this.version=e,this.type="node",this.name="node",this.os=i.platform},a=function(e,t,r,i){this.name=e,this.version=t,this.os=r,this.bot=i,this.type="bot-device"},c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},l=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},u=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,h=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],f=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function d(e){return e?p(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new l:"undefined"!=typeof navigator?p(navigator.userAgent):void 0!==i&&i.version?new o(i.version.slice(1)):null}function p(e){var t=""!==e&&h.reduce(function(t,r){var i=r[0],n=r[1];if(t)return t;var s=n.exec(e);return!!s&&[i,s]},!1);if(!t)return null;var r=t[0],i=t[1];if("searchbot"===r)return new c;var o=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);o?o.length<3&&(o=n(n([],o,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-o.length),!0)):o=[];var l=o.join("."),d=function(e){for(var t=0,r=f.length;t<r;t++){var i=f[t],n=i[0];if(i[1].exec(e))return n}return null}(e),p=u.exec(e);return p&&p[1]?new a(r,l,d,p[1]):new s(r,l,d)}},55445:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var n=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,i){var n;function s(r){e.removeListener(t,o),i(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&(n={once:!0},"function"==typeof e.on&&g(e,"error",s,n))})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,r,i){if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(n=c(e))>0&&o.length>n&&!o.warned){o.warned=!0;var n,s,o,l=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=u.bind(i);return n.listener=r,i.wrapFn=n,n}function f(e,t,r){var i=e._events;if(void 0===i)return[];var n=i[t];return void 0===n?[]:"function"==typeof n?r?[n.listener||n]:[n]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(n):p(n,n.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function g(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function n(s){i.once&&e.removeEventListener(t,n),r(s)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||n(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,a=Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else for(var l=c.length,u=p(c,l),r=0;r<l;++r)i(u[r],this,t);return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,i,n,s,o;if(a(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,n),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)"removeListener"!==(n=s[i])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},43741:function(e,t,r){"use strict";var i=r(25566),n="win32"===i.platform,s=r(85508);function o(e,t){for(var r=[],i=0;i<e.length;i++){var n=e[i];n&&"."!==n&&(".."===n?r.length&&".."!==r[r.length-1]?r.pop():t&&r.push(".."):r.push(n))}return r}function a(e){for(var t=e.length-1,r=0;r<=t&&!e[r];r++);for(var i=t;i>=0&&!e[i];i--);return 0===r&&i===t?e:r>i?[]:e.slice(r,i+1)}var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,l=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function h(e){var t=c.exec(e),r=(t[1]||"")+(t[2]||""),i=t[3]||"",n=l.exec(i);return[r,n[1],n[2],n[3]]}function f(e){var t=c.exec(e),r=t[1]||"",i=!!r&&":"!==r[1];return{device:r,isUnc:i,isAbsolute:i||!!t[2],tail:t[3]}}function d(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e="",t="",r=!1,n=arguments.length-1;n>=-1;n--){if(n>=0?a=arguments[n]:e?(a=i.env["="+e])&&a.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(a=e+"\\"):a=i.cwd(),s.isString(a)){if(!a)continue}else throw TypeError("Arguments to path.resolve must be strings");var a,c=f(a),l=c.device,u=c.isUnc,h=c.isAbsolute,p=c.tail;if((!l||!e||l.toLowerCase()===e.toLowerCase())&&(e||(e=l),r||(t=p+"\\"+t,r=h),e&&r))break}return u&&(e=d(e)),t=o(t.split(/[\\\/]+/),!r).join("\\"),e+(r?"\\":"")+t||"."},u.normalize=function(e){var t=f(e),r=t.device,i=t.isUnc,n=t.isAbsolute,s=t.tail,a=/[\\\/]$/.test(s);return(s=o(s.split(/[\\\/]+/),!n).join("\\"))||n||(s="."),s&&a&&(s+="\\"),i&&(r=d(r)),r+(n?"\\":"")+s},u.isAbsolute=function(e){return f(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(!s.isString(r))throw TypeError("Arguments to path.join must be strings");r&&e.push(r)}var i=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(i=i.replace(/^[\\\/]{2,}/,"\\")),u.normalize(i)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var r=e.toLowerCase(),i=t.toLowerCase(),n=a(t.split("\\")),s=a(r.split("\\")),o=a(i.split("\\")),c=Math.min(s.length,o.length),l=c,h=0;h<c;h++)if(s[h]!==o[h]){l=h;break}if(0==l)return t;for(var f=[],h=l;h<s.length;h++)f.push("..");return(f=f.concat(n.slice(l))).join("\\")},u._makeLong=function(e){if(!s.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=h(e),r=t[0],i=t[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."},u.basename=function(e,t){var r=h(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},u.extname=function(e){return h(e)[3]},u.format=function(e){if(!s.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!s.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var r=e.dir,i=e.base||"";return r?r[r.length-1]===u.sep?r+i:r+u.sep+i:i},u.parse=function(e){if(!s.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=h(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function y(e){return p.exec(e).slice(1)}g.resolve=function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:i.cwd();if(s.isString(n)){if(!n)continue}else throw TypeError("Arguments to path.resolve must be strings");e=n+"/"+e,t="/"===n[0]}return e=o(e.split("/"),!t).join("/"),(t?"/":"")+e||"."},g.normalize=function(e){var t=g.isAbsolute(e),r=e&&"/"===e[e.length-1];return(e=o(e.split("/"),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},g.isAbsolute=function(e){return"/"===e.charAt(0)},g.join=function(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];if(!s.isString(r))throw TypeError("Arguments to path.join must be strings");r&&(e?e+="/"+r:e+=r)}return g.normalize(e)},g.relative=function(e,t){e=g.resolve(e).substr(1),t=g.resolve(t).substr(1);for(var r=a(e.split("/")),i=a(t.split("/")),n=Math.min(r.length,i.length),s=n,o=0;o<n;o++)if(r[o]!==i[o]){s=o;break}for(var c=[],o=s;o<r.length;o++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},g._makeLong=function(e){return e},g.dirname=function(e){var t=y(e),r=t[0],i=t[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."},g.basename=function(e,t){var r=y(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},g.extname=function(e){return y(e)[3]},g.format=function(e){if(!s.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!s.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+g.sep:"")+(e.base||"")},g.parse=function(e){if(!s.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=y(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},g.sep="/",g.delimiter=":",n?e.exports=u:e.exports=g,e.exports.posix=g,e.exports.win32=u},94299:function(e,t,r){"use strict";let i=r(95172);e.exports=s;let n=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function s(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let u=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let h=e.serializers||{},g=Array.isArray(t=e.browser.serialize)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(h),y=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(y=!1),"function"==typeof u&&(u.error=u.fatal=u.warn=u.info=u.debug=u.trace=u),!1===e.enabled&&(e.level="silent");let b=e.level||"info",m=Object.create(u);m.log||(m.log=f),Object.defineProperty(m,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(m,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,o(w,m,"error","log"),o(w,m,"fatal","error"),o(w,m,"warn","error"),o(w,m,"info","log"),o(w,m,"debug","log"),o(w,m,"trace","log")}});let w={transmit:i,serialize:g,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?d:p};return m.levels=s.levels,m.level=b,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=f,m.serializers=h,m._serialize=g,m._stdErrSerialize=y,m.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},g&&t.serializers&&(r.serializers=t.serializers);let n=r.serializers;if(g&&n){var s=Object.assign({},h,n),o=!0===e.browser.serialize?Object.keys(s):g;delete t.serializers,a([t],o,s,this._stdErrSerialize)}function u(e){this._childLevel=(0|e._childLevel)+1,this.error=c(e,t,"error"),this.fatal=c(e,t,"fatal"),this.warn=c(e,t,"warn"),this.info=c(e,t,"info"),this.debug=c(e,t,"debug"),this.trace=c(e,t,"trace"),s&&(this.serializers=s,this._serialize=o),i&&(this._logEvent=l([].concat(e._logEvent.bindings,t)))}return u.prototype=this,new u(this)},i&&(m._logEvent=l()),m}function o(e,t,r,o){let c=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?f:c[r]?c[r]:n[r]||n[o]||f,function(e,t,r){if(e.transmit||t[r]!==f){var o;t[r]=(o=t[r],function(){let c=e.timestamp(),u=Array(arguments.length),h=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var f=0;f<u.length;f++)u[f]=arguments[f];if(e.serialize&&!e.asObject&&a(u,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?o.call(h,function(e,t,r,n){e._serialize&&a(r,e._serialize,e.serializers,e._stdErrSerialize);let o=r.slice(),c=o[0],l={};n&&(l.time=n),l.level=s.levels.values[t];let u=(0|e._childLevel)+1;if(u<1&&(u=1),null!==c&&"object"==typeof c){for(;u--&&"object"==typeof o[0];)Object.assign(l,o.shift());c=o.length?i(o.shift(),o):void 0}else"string"==typeof c&&(c=i(o.shift(),o));return void 0!==c&&(l.msg=c),l}(this,r,u,c)):o.apply(h,u),e.transmit){let i=e.transmit.level||t.level,n=s.levels.values[i],o=s.levels.values[r];if(o<n)return;(function(e,t,r){let i=t.send,n=t.ts,s=t.methodLevel,o=t.methodValue,c=t.val,u=e._logEvent.bindings;a(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=n,e._logEvent.messages=r.filter(function(e){return -1===u.indexOf(e)}),e._logEvent.level.label=s,e._logEvent.level.value=o,i(s,e._logEvent,c),e._logEvent=l(u)})(this,{ts:c,methodLevel:r,methodValue:o,transmitLevel:i,transmitValue:s.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},u)}})}}(e,t,r)}function a(e,t,r,i){for(let n in e)if(i&&e[n]instanceof Error)e[n]=s.stdSerializers.err(e[n]);else if("object"==typeof e[n]&&!Array.isArray(e[n]))for(let i in e[n])t&&t.indexOf(i)>-1&&i in r&&(e[n][i]=r[i](e[n][i]))}function c(e,t,r){return function(){let i=Array(1+arguments.length);i[0]=t;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return e[r].apply(this,i)}}function l(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function u(){return{}}function h(e){return e}function f(){}function d(){return!1}function p(){return Date.now()}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers={mapHttpRequest:u,mapHttpResponse:u,wrapRequestSerializer:h,wrapResponseSerializer:h,wrapErrorSerializer:h,req:u,res:u,err:function(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}},s.stdTimeFunctions=Object.assign({},{nullTime:d,epochTime:p,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},95172:function(e){"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,i){var n=i&&i.stringify||t;if("object"==typeof e&&null!==e){var s=r.length+1;if(1===s)return e;var o=Array(s);o[0]=n(e);for(var a=1;a<s;a++)o[a]=n(r[a]);return o.join(" ")}if("string"!=typeof e)return e;var c=r.length;if(0===c)return e;for(var l="",u=0,h=-1,f=e&&e.length||0,d=0;d<f;){if(37===e.charCodeAt(d)&&d+1<f){switch(h=h>-1?h:0,e.charCodeAt(d+1)){case 100:case 102:if(u>=c||null==r[u])break;h<d&&(l+=e.slice(h,d)),l+=Number(r[u]),h=d+2,d++;break;case 105:if(u>=c||null==r[u])break;h<d&&(l+=e.slice(h,d)),l+=Math.floor(Number(r[u])),h=d+2,d++;break;case 79:case 111:case 106:if(u>=c||void 0===r[u])break;h<d&&(l+=e.slice(h,d));var p=typeof r[u];if("string"===p){l+="'"+r[u]+"'",h=d+2,d++;break}if("function"===p){l+=r[u].name||"<anonymous>",h=d+2,d++;break}l+=n(r[u]),h=d+2,d++;break;case 115:if(u>=c)break;h<d&&(l+=e.slice(h,d)),l+=String(r[u]),h=d+2,d++;break;case 37:h<d&&(l+=e.slice(h,d)),l+="%",h=d+2,d++,u--}++u}++d}return -1===h?e:(h<f&&(l+=e.slice(h)),l)}},47159:function(e,t,r){"use strict";r.d(t,{zo:function(){return w},mL:function(){return eZ},BB:function(){return eY}});var i={};r.r(i),r.d(i,{identity:function(){return N}});var n={};r.r(n),r.d(n,{base2:function(){return k}});var s={};r.r(s),r.d(s,{base8:function(){return j}});var o={};r.r(o),r.d(o,{base10:function(){return L}});var a={};r.r(a),r.d(a,{base16:function(){return $},base16upper:function(){return M}});var c={};r.r(c),r.d(c,{base32:function(){return z},base32hex:function(){return K},base32hexpad:function(){return G},base32hexpadupper:function(){return W},base32hexupper:function(){return H},base32pad:function(){return F},base32padupper:function(){return V},base32upper:function(){return q},base32z:function(){return J}});var l={};r.r(l),r.d(l,{base36:function(){return Z},base36upper:function(){return Y}});var u={};r.r(u),r.d(u,{base58btc:function(){return Q},base58flickr:function(){return X}});var h={};r.r(h),r.d(h,{base64:function(){return ee},base64pad:function(){return et},base64url:function(){return er},base64urlpad:function(){return ei}});var f={};r.r(f),r.d(f,{base256emoji:function(){return ea}});var d={};r.r(d),r.d(d,{sha256:function(){return ev},sha512:function(){return eE}});var p={};r.r(p),r.d(p,{identity:function(){return ex}});var g={};r.r(g),r.d(g,{code:function(){return eS},decode:function(){return e_},encode:function(){return eO},name:function(){return eI}});var y={};function b(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function m(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?b(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function w(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=m(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return b(r)}r.r(y),r.d(y,{code:function(){return eR},decode:function(){return eB},encode:function(){return eC},name:function(){return eD}});var v=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var s=e.charAt(n),o=s.charCodeAt(0);if(255!==r[o])throw TypeError(s+" is ambiguous");r[o]=n}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,n=0;e[t]===c;)i++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,f=s-1;(0!==u||h<n)&&-1!==f;f--,h++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");n=h,t++}if(" "!==e[t]){for(var d=s-n;d!==s&&0===o[d];)d++;for(var p=new Uint8Array(i+(s-d)),g=i;d!==s;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,n=0,s=t.length;n!==s&&0===t[n];)n++,r++;for(var o=(s-n)*u+1>>>0,l=new Uint8Array(o);n!==s;){for(var h=t[n],f=0,d=o-1;(0!==h||f<i)&&-1!==d;d--,f++)h+=256*l[d]>>>0,l[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw Error("Non-zero carry");i=f,n++}for(var p=o-i;p!==o&&0===l[p];)p++;for(var g=c.repeat(r);p<o;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw Error(`Non-${t} character`)}}};new Uint8Array(0);let E=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},x=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},I=e=>new TextEncoder().encode(e),S=e=>new TextDecoder().decode(e);class O{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class _{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return A(this,e)}}class P{constructor(e){this.decoders=e}or(e){return A(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let A=(e,t)=>new P({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class D{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new O(e,t,r),this.decoder=new _(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let R=({name:e,prefix:t,encode:r,decode:i})=>new D(e,t,r,i),C=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:n}=v(r,t);return R({prefix:e,name:t,encode:i,decode:e=>x(n(e))})},B=(e,t,r,i)=>{let n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,l=0;for(let t=0;t<s;++t){let s=n[e[t]];if(void 0===s)throw SyntaxError(`Non-${i} character`);c=c<<r|s,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},U=(e,t,r)=>{let i="="===t[t.length-1],n=(1<<r)-1,s="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,s+=t[n&a>>o];if(o&&(s+=t[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},T=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>R({prefix:t,name:e,encode:e=>U(e,i,r),decode:t=>B(t,i,r,e)}),N=R({prefix:"\0",name:"identity",encode:e=>S(e),decode:e=>I(e)}),k=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),j=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),L=C({prefix:"9",name:"base10",alphabet:"0123456789"}),$=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),M=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),z=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),q=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),F=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),V=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),K=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),G=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),W=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Z=C({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Y=C({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Q=C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),X=C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ee=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),et=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),er=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ei=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),en=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),es=en.reduce((e,t,r)=>(e[r]=t,e),[]),eo=en.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),ea=R({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=es[t],"")},decode:function(e){let t=[];for(let r of e){let e=eo[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var ec=function e(t,r,i){r=r||[];for(var n=i=i||0;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-n+1,r},el=function e(t,r){var i,n=0,r=r||0,s=0,o=r,a=t.length;do{if(o>=a)throw e.bytes=0,RangeError("Could not decode varint");i=t[o++],n+=s<28?(127&i)<<s:(127&i)*Math.pow(2,s),s+=7}while(i>=128);return e.bytes=o-r,n};let eu=(e,t=0)=>[el(e,t),el.bytes],eh=(e,t,r=0)=>(ec(e,t,r),t),ef=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,ed=(e,t)=>{let r=t.byteLength,i=ef(e),n=i+ef(r),s=new Uint8Array(n+r);return eh(e,s,0),eh(r,s,i),s.set(t,n),new ey(e,r,t,s)},ep=e=>{let t=x(e),[r,i]=eu(t),[n,s]=eu(t.subarray(i)),o=t.subarray(i+s);if(o.byteLength!==n)throw Error("Incorrect length");return new ey(r,n,o,t)},eg=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&E(e.bytes,t.bytes);class ey{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let eb=({name:e,code:t,encode:r})=>new em(e,t,r);class em{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?ed(this.code,t):t.then(e=>ed(this.code,e))}throw Error("Unknown type, must be binary type")}}let ew=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ev=eb({name:"sha2-256",code:18,encode:ew("SHA-256")}),eE=eb({name:"sha2-512",code:19,encode:ew("SHA-512")}),ex={code:0,name:"identity",encode:x,digest:e=>ed(0,x(e))},eI="raw",eS=85,eO=e=>x(e),e_=e=>x(e),eP=new TextEncoder,eA=new TextDecoder,eD="json",eR=512,eC=e=>eP.encode(JSON.stringify(e)),eB=e=>JSON.parse(eA.decode(e));class eU{constructor(e,t,r,i){this.code=t,this.version=e,this.multihash=r,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:eq,byteLength:eq,code:ez,version:ez,multihash:ez,bytes:ez,_baseCache:eq,asCID:eq})}toV0(){if(0===this.version)return this;{let{code:e,multihash:t}=this;if(e!==ej)throw Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==eL)throw Error("Cannot convert non sha2-256 multihash CID to CIDv0");return eU.createV0(t)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=ed(e,t);return eU.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&eg(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:i}=this;return 0===r?eN(t,i,e||Q.encoder):ek(t,i,e||z.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return eF(/^0\.0/,eV),!!(e&&(e[eM]||e.asCID===e))}get toBaseEncodedString(){throw Error("Deprecated, use .toString()")}get codec(){throw Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw Error('"multibaseName" property is deprecated')}get prefix(){throw Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof eU)return e;if(null!=e&&e.asCID===e){let{version:t,code:r,multihash:i,bytes:n}=e;return new eU(t,r,i,n||e$(t,r,i.bytes))}if(null==e||!0!==e[eM])return null;{let{version:t,multihash:r,code:i}=e,n=ep(r);return eU.create(t,i,n)}}static create(e,t,r){if("number"!=typeof t)throw Error("String codecs are no longer supported");switch(e){case 0:if(t===ej)return new eU(e,t,r,r.bytes);throw Error(`Version 0 CID must use dag-pb (code: ${ej}) block encoding`);case 1:{let i=e$(e,t,r.bytes);return new eU(e,t,r,i)}default:throw Error("Invalid version")}}static createV0(e){return eU.create(0,ej,e)}static createV1(e,t){return eU.create(1,e,t)}static decode(e){let[t,r]=eU.decodeFirst(e);if(r.length)throw Error("Incorrect length");return t}static decodeFirst(e){let t=eU.inspectBytes(e),r=t.size-t.multihashSize,i=x(e.subarray(r,r+t.multihashSize));if(i.byteLength!==t.multihashSize)throw Error("Incorrect length");let n=i.subarray(t.multihashSize-t.digestSize),s=new ey(t.multihashCode,t.digestSize,n,i);return[0===t.version?eU.createV0(s):eU.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[r,i]=eu(e.subarray(t));return t+=i,r},i=r(),n=ej;if(18===i?(i=0,t=0):1===i&&(n=r()),0!==i&&1!==i)throw RangeError(`Invalid CID version ${i}`);let s=t,o=r(),a=r(),c=t+a;return{version:i,codec:n,multihashCode:o,digestSize:a,multihashSize:c-s,size:c}}static parse(e,t){let[r,i]=eT(e,t),n=eU.decode(i);return n._baseCache.set(r,e),n}}let eT=(e,t)=>{switch(e[0]){case"Q":return[Q.prefix,(t||Q).decode(`${Q.prefix}${e}`)];case Q.prefix:return[Q.prefix,(t||Q).decode(e)];case z.prefix:return[z.prefix,(t||z).decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},eN=(e,t,r)=>{let{prefix:i}=r;if(i!==Q.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let n=t.get(i);if(null!=n)return n;{let n=r.encode(e).slice(1);return t.set(i,n),n}},ek=(e,t,r)=>{let{prefix:i}=r,n=t.get(i);if(null!=n)return n;{let n=r.encode(e);return t.set(i,n),n}},ej=112,eL=18,e$=(e,t,r)=>{let i=ef(e),n=i+ef(t),s=new Uint8Array(n+r.byteLength);return eh(e,s,0),eh(t,s,i),s.set(r,n),s},eM=Symbol.for("@ipld/js-cid/CID"),ez={writable:!1,configurable:!1,enumerable:!0},eq={writable:!1,enumerable:!1,configurable:!1},eF=(e,t)=>{if(e.test("0.0.0-dev"))console.warn(t);else throw Error(t)},eV=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,eK={...i,...n,...s,...o,...a,...c,...l,...u,...h,...f};function eH(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...d,...p});let eG=eH("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),eW=eH("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=m((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),eJ={utf8:eG,"utf-8":eG,hex:eK.base16,latin1:eW,ascii:eW,binary:eW,...eK};function eZ(e,t="utf8"){let r=eJ[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?b(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function eY(e,t="utf8"){let r=eJ[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}},61904:function(e){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},18749:function(e){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},85508:function(e,t,r){var i,n=r(25566),s=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(a(arguments[r]));return t.join(" ")}for(var r=1,i=arguments,n=i.length,o=String(e).replace(s,function(e){if("%%"===e)return"%";if(r>=n)return e;switch(e){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(e){return"[Circular]"}default:return e}}),c=i[r];r<n;c=i[++r])g(c)||!v(c)?o+=" "+c:o+=" "+a(c);return o},t.deprecate=function(e,i){if(m(r.g.process))return function(){return t.deprecate(e,i).apply(this,arguments)};if(!0===n.noDeprecation)return e;var s=!1;return function(){if(!s){if(n.throwDeprecation)throw Error(i);n.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}};var o={};function a(e,r){var i={seen:[],stylize:l};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),p(r)?i.showHidden=r:r&&t._extend(i,r),m(i.showHidden)&&(i.showHidden=!1),m(i.depth)&&(i.depth=2),m(i.colors)&&(i.colors=!1),m(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),u(i,e,i.depth)}function c(e,t){var r=a.styles[t];return r?"\x1b["+a.colors[r][0]+"m"+e+"\x1b["+a.colors[r][1]+"m":e}function l(e,t){return e}function u(e,r,i){if(e.customInspect&&r&&I(r.inspect)&&r.inspect!==t.inspect&&!(r.constructor&&r.constructor.prototype===r)){var n,s,o,a,c,l=r.inspect(i,e);return b(l)||(l=u(e,l,i)),l}var v=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return y(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,r);if(v)return v;var S=Object.keys(r),O=(a={},S.forEach(function(e,t){a[e]=!0}),a);if(e.showHidden&&(S=Object.getOwnPropertyNames(r)),x(r)&&(S.indexOf("message")>=0||S.indexOf("description")>=0))return h(r);if(0===S.length){if(I(r)){var _=r.name?": "+r.name:"";return e.stylize("[Function"+_+"]","special")}if(w(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(E(r))return e.stylize(Date.prototype.toString.call(r),"date");if(x(r))return h(r)}var A="",D=!1,R=["{","}"];return(d(r)&&(D=!0,R=["[","]"]),I(r)&&(A=" [Function"+(r.name?": "+r.name:"")+"]"),w(r)&&(A=" "+RegExp.prototype.toString.call(r)),E(r)&&(A=" "+Date.prototype.toUTCString.call(r)),x(r)&&(A=" "+h(r)),0!==S.length||D&&0!=r.length)?i<0?w(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=D?function(e,t,r,i,n){for(var s=[],o=0,a=t.length;o<a;++o)P(t,String(o))?s.push(f(e,t,r,i,String(o),!0)):s.push("");return n.forEach(function(n){n.match(/^\d+$/)||s.push(f(e,t,r,i,n,!0))}),s}(e,r,i,O,S):S.map(function(t){return f(e,r,i,O,t,D)}),e.seen.pop(),n=A,s=R,o=0,c.reduce(function(e,t){return o++,t.indexOf("\n")>=0&&o++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?s[0]+(""===n?"":n+"\n ")+" "+c.join(",\n  ")+" "+s[1]:s[0]+n+" "+c.join(", ")+" "+s[1]):R[0]+A+R[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,i,n,s){var o,a,c;if((c=Object.getOwnPropertyDescriptor(t,n)||{value:t[n]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),P(i,n)||(o="["+n+"]"),!a&&(0>e.seen.indexOf(c.value)?(a=g(r)?u(e,c.value,null):u(e,c.value,r-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),m(o)){if(s&&n.match(/^\d+$/))return a;(o=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+a}function d(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function g(e){return null===e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function m(e){return void 0===e}function w(e){return v(e)&&"[object RegExp]"===S(e)}function v(e){return"object"==typeof e&&null!==e}function E(e){return v(e)&&"[object Date]"===S(e)}function x(e){return v(e)&&("[object Error]"===S(e)||e instanceof Error)}function I(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(m(i)&&(i=n.env.NODE_DEBUG||""),!o[e=e.toUpperCase()]){if(RegExp("\\b"+e+"\\b","i").test(i)){var r=n.pid;o[e]=function(){var i=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,i)}}else o[e]=function(){}}return o[e]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=m,t.isRegExp=w,t.isObject=v,t.isDate=E,t.isError=x,t.isFunction=I,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(18749);var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,r;console.log("%s - %s",(r=[O((e=new Date).getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":"),[e.getDate(),_[e.getMonth()],r].join(" ")),t.format.apply(t,arguments))},t.inherits=r(61904),t._extend=function(e,t){if(!t||!v(t))return e;for(var r=Object.keys(t),i=r.length;i--;)e[r[i]]=t[r[i]];return e}},3794:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,i=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,n=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function s(e,t){if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`);return}return t}function o(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);let o=e.trim();if(o.length<=9)switch(o.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!n.test(e)){if(t.strict)throw SyntaxError("[destr] Invalid JSON");return e}try{if(r.test(e)||i.test(e)){if(t.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(e,s)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}t.default=o,t.destr=o,t.safeDestr=function(e,t={}){return o(e,{...t,strict:!0})}},45825:function(e,t,r){let{destr:i,safeDestr:n}=r(3794);i.destr=i,i.safeDestr=n,e.exports=i},30324:function(e,t,r){"use strict";let i=r(45825),n=r(77502),s=i&&"object"==typeof i&&"default"in i?i.default:i,o=()=>{let e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};async function a(e,t){t=n.normalizeBaseKey(t);let r=await e.getKeys(t),i={};return await Promise.all(r.map(async r=>{i[r.slice(t.length)]=await e.getItem(r)})),i}async function c(e,t,r=""){r=n.normalizeBaseKey(r),await Promise.all(Object.entries(t).map(t=>e.setItem(r+t[0],t[1])))}function l(e,t,r){return e.watch?e.watch((e,i)=>t(e,r+i)):()=>{}}async function u(e){"function"==typeof e.dispose&&await n.asyncCall(e.dispose)}t.filterKeyByBase=n.filterKeyByBase,t.filterKeyByDepth=n.filterKeyByDepth,t.joinKeys=n.joinKeys,t.normalizeBaseKey=n.normalizeBaseKey,t.normalizeKey=n.normalizeKey,t.prefixStorage=n.prefixStorage,t.builtinDrivers={"azure-app-configuration":"unstorage/drivers/azure-app-configuration",azureAppConfiguration:"unstorage/drivers/azure-app-configuration","azure-cosmos":"unstorage/drivers/azure-cosmos",azureCosmos:"unstorage/drivers/azure-cosmos","azure-key-vault":"unstorage/drivers/azure-key-vault",azureKeyVault:"unstorage/drivers/azure-key-vault","azure-storage-blob":"unstorage/drivers/azure-storage-blob",azureStorageBlob:"unstorage/drivers/azure-storage-blob","azure-storage-table":"unstorage/drivers/azure-storage-table",azureStorageTable:"unstorage/drivers/azure-storage-table","capacitor-preferences":"unstorage/drivers/capacitor-preferences",capacitorPreferences:"unstorage/drivers/capacitor-preferences","cloudflare-kv-binding":"unstorage/drivers/cloudflare-kv-binding",cloudflareKVBinding:"unstorage/drivers/cloudflare-kv-binding","cloudflare-kv-http":"unstorage/drivers/cloudflare-kv-http",cloudflareKVHttp:"unstorage/drivers/cloudflare-kv-http","cloudflare-r2-binding":"unstorage/drivers/cloudflare-r2-binding",cloudflareR2Binding:"unstorage/drivers/cloudflare-r2-binding",db0:"unstorage/drivers/db0","deno-kv-node":"unstorage/drivers/deno-kv-node",denoKVNode:"unstorage/drivers/deno-kv-node","deno-kv":"unstorage/drivers/deno-kv",denoKV:"unstorage/drivers/deno-kv","fs-lite":"unstorage/drivers/fs-lite",fsLite:"unstorage/drivers/fs-lite",fs:"unstorage/drivers/fs",github:"unstorage/drivers/github",http:"unstorage/drivers/http",indexedb:"unstorage/drivers/indexedb",localstorage:"unstorage/drivers/localstorage","lru-cache":"unstorage/drivers/lru-cache",lruCache:"unstorage/drivers/lru-cache",memory:"unstorage/drivers/memory",mongodb:"unstorage/drivers/mongodb","netlify-blobs":"unstorage/drivers/netlify-blobs",netlifyBlobs:"unstorage/drivers/netlify-blobs",null:"unstorage/drivers/null",overlay:"unstorage/drivers/overlay",planetscale:"unstorage/drivers/planetscale",redis:"unstorage/drivers/redis",s3:"unstorage/drivers/s3","session-storage":"unstorage/drivers/session-storage",sessionStorage:"unstorage/drivers/session-storage",uploadthing:"unstorage/drivers/uploadthing",upstash:"unstorage/drivers/upstash","vercel-blob":"unstorage/drivers/vercel-blob",vercelBlob:"unstorage/drivers/vercel-blob","vercel-kv":"unstorage/drivers/vercel-kv",vercelKV:"unstorage/drivers/vercel-kv","vercel-runtime-cache":"unstorage/drivers/vercel-runtime-cache",vercelRuntimeCache:"unstorage/drivers/vercel-runtime-cache"},t.createStorage=function(e={}){let t={mounts:{"":e.driver||o()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(let r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),a=(e,r)=>{if(t.watching)for(let i of(r=n.normalizeKey(r),t.watchListeners))i(e,r)},c=async()=>{if(!t.watching)for(let e in t.watching=!0,t.mounts)t.unwatch[e]=await l(t.mounts[e],a,e)},h=async()=>{if(t.watching){for(let e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},f=(e,t,i)=>{let s=new Map,o=e=>{let t=s.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},s.set(e.base,t)),t};for(let i of e){let e="string"==typeof i,s=n.normalizeKey(e?i:i.key),a=e?void 0:i.value,c=e||!i.options?t:{...t,...i.options},l=r(s);o(l).items.push({key:s,value:a,relativeKey:l.relativeKey,options:c})}return Promise.all([...s.values()].map(e=>i(e))).then(e=>e.flat())},d={hasItem(e,t={}){let{relativeKey:i,driver:s}=r(e=n.normalizeKey(e));return n.asyncCall(s.hasItem,i,t)},getItem(e,t={}){let{relativeKey:i,driver:o}=r(e=n.normalizeKey(e));return n.asyncCall(o.getItem,i,t).then(e=>s(e))},getItems:(e,t={})=>f(e,t,e=>e.driver.getItems?n.asyncCall(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:n.joinKeys(e.base,t.key),value:s(t.value)}))):Promise.all(e.items.map(t=>n.asyncCall(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:s(e)}))))),getItemRaw(e,t={}){let{relativeKey:i,driver:s}=r(e=n.normalizeKey(e));return s.getItemRaw?n.asyncCall(s.getItemRaw,i,t):n.asyncCall(s.getItem,i,t).then(e=>n.deserializeRaw(e))},async setItem(e,t,i={}){if(void 0===t)return d.removeItem(e);let{relativeKey:s,driver:o}=r(e=n.normalizeKey(e));o.setItem&&(await n.asyncCall(o.setItem,s,n.stringify(t),i),o.watch||a("update",e))},async setItems(e,t){await f(e,t,async e=>{if(e.driver.setItems)return n.asyncCall(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:n.stringify(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>n.asyncCall(e.driver.setItem,t.relativeKey,n.stringify(t.value),t.options)))})},async setItemRaw(e,t,i={}){if(void 0===t)return d.removeItem(e,i);let{relativeKey:s,driver:o}=r(e=n.normalizeKey(e));if(o.setItemRaw)await n.asyncCall(o.setItemRaw,s,t,i);else{if(!o.setItem)return;await n.asyncCall(o.setItem,s,n.serializeRaw(t),i)}o.watch||a("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t});let{relativeKey:i,driver:s}=r(e=n.normalizeKey(e));s.removeItem&&(await n.asyncCall(s.removeItem,i,t),(t.removeMeta||t.removeMata)&&await n.asyncCall(s.removeItem,i+"$",t),s.watch||a("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t});let{relativeKey:i,driver:o}=r(e=n.normalizeKey(e)),a=Object.create(null);if(o.getMeta&&Object.assign(a,await n.asyncCall(o.getMeta,i,t)),!t.nativeOnly){let e=await n.asyncCall(o.getItem,i+"$",t).then(e=>s(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(a,e))}return a},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){let r=i(e=n.normalizeBaseKey(e),!0),s=[],o=[],a=!0;for(let e of r){for(let r of(e.driver.flags?.maxDepth||(a=!1),await n.asyncCall(e.driver.getKeys,e.relativeBase,t))){let t=e.mountpoint+n.normalizeKey(r);s.some(e=>t.startsWith(e))||o.push(t)}s=[e.mountpoint,...s.filter(t=>!t.startsWith(e.mountpoint))]}let c=void 0!==t.maxDepth&&!a;return o.filter(r=>(!c||n.filterKeyByDepth(r,t.maxDepth))&&n.filterKeyByBase(r,e))},async clear(e,t={}){e=n.normalizeBaseKey(e),await Promise.all(i(e,!1).map(async e=>e.driver.clear?n.asyncCall(e.driver.clear,e.relativeBase,t):e.driver.removeItem?Promise.all((await e.driver.getKeys(e.relativeBase||"",t)).map(r=>e.driver.removeItem(r,t))):void 0))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>u(e)))},watch:async e=>(await c(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await h()}),async unwatch(){t.watchListeners=[],await h()},mount(e,r){if((e=n.normalizeBaseKey(e))&&t.mounts[e])throw Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(l(r,a,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),d},async unmount(e,r=!0){(e=n.normalizeBaseKey(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await u(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){let t=r(e=n.normalizeKey(e)+":");return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>i(e=n.normalizeKey(e),t.parents).map(e=>({driver:e.driver,base:e.mountpoint})),keys:(e,t={})=>d.getKeys(e,t),get:(e,t={})=>d.getItem(e,t),set:(e,t,r={})=>d.setItem(e,t,r),has:(e,t={})=>d.hasItem(e,t),del:(e,t={})=>d.removeItem(e,t),remove:(e,t={})=>d.removeItem(e,t)};return d},t.defineDriver=function(e){return e},t.restoreSnapshot=c,t.snapshot=a},77502:function(e,t,r){"use strict";var i=r(82957).Buffer;let n="base64:",s=["has","hasItem","get","getItem","getItemRaw","set","setItem","setItemRaw","del","remove","removeItem","getMeta","setMeta","removeMeta","getKeys","clear","mount","unmount"];function o(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function a(e){return(e=o(e))?e+":":""}t.asyncCall=function(e,...t){try{var r;return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}},t.deserializeRaw=function(e){var t;return"string"==typeof e&&e.startsWith(n)?(t=e.slice(n.length),globalThis.Buffer?i.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))):e},t.filterKeyByBase=function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]},t.filterKeyByDepth=function(e,t){if(void 0===t)return!0;let r=0,i=e.indexOf(":");for(;i>-1;)r++,i=e.indexOf(":",i+1);return r<=t},t.joinKeys=function(...e){return o(e.join(":"))},t.normalizeBaseKey=a,t.normalizeKey=o,t.prefixStorage=function(e,t){if(!(t=a(t)))return e;let r={...e};for(let i of s)r[i]=(r="",...n)=>e[i](t+r,...n);return r.getKeys=(r="",...i)=>e.getKeys(t+r,...i).then(e=>e.map(e=>e.slice(t.length))),r.keys=r.getKeys,r.getItems=async(r,i)=>{let n=r.map(e=>"string"==typeof e?t+e:{...e,key:t+e.key});return(await e.getItems(n,i)).map(e=>({key:e.key.slice(t.length),value:e.value}))},r.setItems=async(r,i)=>{let n=r.map(e=>({key:t+e.key,value:e.value,options:e.options}));return e.setItems(n,i)},r},t.serializeRaw=function(e){return"string"==typeof e?e:n+(globalThis.Buffer?i.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e)))},t.stringify=function e(t){if(function(e){let t=typeof e;return null===e||"object"!==t&&"function"!==t}(t))return String(t);if(function(e){let t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(t)||Array.isArray(t))return JSON.stringify(t);if("function"==typeof t.toJSON)return e(t.toJSON());throw Error("[unstorage] Cannot stringify value!")}},97846:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(85357),n=r(43741),s=r(83911),o=r(29056);let a=/\.\.:|\.\.$/,c="fs-lite";e.exports=(0,s.defineDriver)((e={})=>{if(!e.base)throw(0,s.createRequiredError)(c,"base");e.base=(0,n.resolve)(e.base);let t=t=>{if(a.test(t))throw(0,s.createError)(c,`Invalid key: ${JSON.stringify(t)}. It should not contain .. segments`);return(0,n.join)(e.base,t.replace(/:/g,"/"))};return{name:c,options:e,flags:{maxDepth:!0},hasItem:e=>(0,i.existsSync)(t(e)),getItem:e=>(0,o.readFile)(t(e),"utf8"),getItemRaw:e=>(0,o.readFile)(t(e)),async getMeta(e){let{atime:r,mtime:n,size:s,birthtime:o,ctime:a}=await i.promises.stat(t(e)).catch(()=>({}));return{atime:r,mtime:n,size:s,birthtime:o,ctime:a}},setItem(r,i){if(!e.readOnly)return(0,o.writeFile)(t(r),i,"utf8")},setItemRaw(r,i){if(!e.readOnly)return(0,o.writeFile)(t(r),i)},removeItem(r){if(!e.readOnly)return(0,o.unlink)(t(r))},getKeys:(r,i)=>(0,o.readdirRecursive)(t("."),e.ignore,i?.maxDepth),async clear(){e.readOnly||e.noClear||await (0,o.rmRecursive)(t("."))}}})},83911:function(e,t){"use strict";function r(e,t=":"){return e?e.replace(/[:/\\]/g,t).replace(/^[:/\\]|[:/\\]$/g,""):""}function i(e,t,r){let n=Error(`[unstorage] [${e}] ${t}`,r);return Error.captureStackTrace&&Error.captureStackTrace(n,i),n}Object.defineProperty(t,"__esModule",{value:!0}),t.createError=i,t.createRequiredError=function(e,t){return Array.isArray(t)?i(e,`Missing some of the required options ${t.map(e=>"`"+e+"`").join(", ")}`):i(e,`Missing required option \`${t}\`.`)},t.defineDriver=function(e){return e},t.joinKeys=function(...e){return e.map(e=>r(e)).filter(Boolean).join(":")},t.normalizeKey=r},29056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredir=l,t.readFile=function(e,t){return i.promises.readFile(e,t).catch(s)},t.readdir=c,t.readdirRecursive=u,t.rmRecursive=h,t.stat=function(e){return i.promises.stat(e).catch(s)},t.unlink=function(e){return i.promises.unlink(e).catch(s)},t.writeFile=a;var i=r(36027),n=r(43741);function s(e){return"ENOENT"===e.code||"EISDIR"===e.code?null:e}function o(e){return"EEXIST"===e.code?null:e}async function a(e,t,r){return await l((0,n.dirname)(e)),i.promises.writeFile(e,t,r)}function c(e){return i.promises.readdir(e,{withFileTypes:!0}).catch(s).then(e=>e||[])}async function l(e){(0,i.existsSync)(e)||(await l((0,n.dirname)(e)).catch(o),await i.promises.mkdir(e).catch(o))}async function u(e,t,r){if(t&&t(e))return[];let i=await c(e),s=[];return await Promise.all(i.map(async i=>{let o=(0,n.resolve)(e,i.name);if(i.isDirectory()){if(void 0===r||r>0){let e=await u(o,t,void 0===r?void 0:r-1);s.push(...e.map(e=>i.name+"/"+e))}}else t&&t(i.name)||s.push(i.name)})),s}async function h(e){let t=await c(e);await Promise.all(t.map(t=>{let r=(0,n.resolve)(e,t.name);return t.isDirectory()?h(r).then(()=>i.promises.rmdir(r)):i.promises.unlink(r)}))}}}]);